var pe=Object.freeze,ct=Object.defineProperty;var I=(t,e)=>pe(ct(t,"raw",{value:pe(e||t.slice())}));function R(t){if(typeof t!="string"||!t)throw new Error("expected a non-empty string, got: "+t)}function q(t){if(typeof t!="number")throw new Error("expected a number, got: "+t)}const dt=1,ut=1,L="emoji",B="keyvalue",se="favorites",lt="tokens",Ae="tokens",ft="unicode",Le="count",mt="group",pt="order",Oe="group-order",he="eTag",ne="url",ge="skinTone",D="readonly",ae="readwrite",De="skinUnicodes",ht="skinUnicodes",gt="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",bt="en";function yt(t,e){const o=new Set,r=[];for(const s of t){const n=e(s);o.has(n)||(o.add(n),r.push(s))}return r}function be(t){return yt(t,e=>e.unicode)}function kt(t){function e(o,r,s){const n=r?t.createObjectStore(o,{keyPath:r}):t.createObjectStore(o);if(s)for(const[a,[m,f]]of Object.entries(s))n.createIndex(a,m,{multiEntry:f});return n}e(B),e(L,ft,{[Ae]:[lt,!0],[Oe]:[[mt,pt]],[De]:[ht,!0]}),e(se,void 0,{[Le]:[""]})}const oe={},U={},K={};function $e(t,e,o){o.onerror=()=>e(o.error),o.onblocked=()=>e(new Error("IDB blocked")),o.onsuccess=()=>t(o.result)}async function Et(t){const e=await new Promise((o,r)=>{const s=indexedDB.open(t,dt);oe[t]=s,s.onupgradeneeded=n=>{n.oldVersion<ut&&kt(s.result)},$e(o,r,s)});return e.onclose=()=>ce(t),e}function vt(t){return U[t]||(U[t]=Et(t)),U[t]}function C(t,e,o,r){return new Promise((s,n)=>{const a=t.transaction(e,o,{durability:"relaxed"}),m=typeof e=="string"?a.objectStore(e):e.map(c=>a.objectStore(c));let f;r(m,a,c=>{f=c}),a.oncomplete=()=>s(f),a.onerror=()=>n(a.error)})}function ce(t){const e=oe[t],o=e&&e.result;if(o){o.close();const r=K[t];if(r)for(const s of r)s()}delete oe[t],delete U[t],delete K[t]}function jt(t){return new Promise((e,o)=>{ce(t);const r=indexedDB.deleteDatabase(t);$e(e,o,r)})}function wt(t,e){let o=K[t];o||(o=K[t]=[]),o.push(e)}const Tt=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function O(t){return t.split(/[\s_]+/).map(e=>!e.match(/\w/)||Tt.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const St=2;function Me(t){return t.filter(Boolean).map(e=>e.toLowerCase()).filter(e=>e.length>=St)}function xt(t){return t.map(({annotation:o,emoticon:r,group:s,order:n,shortcodes:a,skins:m,tags:f,emoji:c,version:u})=>{const p=[...new Set(Me([...(a||[]).map(O).flat(),...(f||[]).map(O).flat(),...O(o),r]))].sort(),l={annotation:o,group:s,order:n,tags:f,tokens:p,unicode:c,version:u};if(r&&(l.emoticon=r),a&&(l.shortcodes=a),m){l.skinTones=[],l.skinUnicodes=[],l.skinVersions=[];for(const{tone:b,emoji:_,version:w}of m)l.skinTones.push(b),l.skinUnicodes.push(_),l.skinVersions.push(w)}return l})}function Be(t,e,o,r){t[e](o).onsuccess=s=>r&&r(s.target.result)}function A(t,e,o){Be(t,"get",e,o)}function Fe(t,e,o){Be(t,"getAll",e,o)}function de(t){t.commit&&t.commit()}function _t(t,e){let o=t[0];for(let r=1;r<t.length;r++){const s=t[r];e(o)>e(s)&&(o=s)}return o}function Ne(t,e){const o=_t(t,s=>s.length),r=[];for(const s of o)t.some(n=>n.findIndex(a=>e(a)===e(s))===-1)||r.push(s);return r}async function Ct(t){return!await Pe(t,B,ne)}async function It(t,e){return C(t,L,D,(r,s,n)=>{let a;const m=()=>{r.getAll(a&&IDBKeyRange.lowerBound(a,!0),50).onsuccess=f=>{const c=f.target.result;for(const u of c)if(a=u.unicode,e(u))return n(u);if(c.length<50)return n();m()}};m()})}async function At(t,e,o,r){try{const s=xt(e);await C(t,[L,B],ae,([n,a],m)=>{let f,c,u=0;function p(){++u===2&&l()}function l(){if(!(f===r&&c===o)){n.clear();for(const b of s)n.put(b);a.put(r,he),a.put(o,ne),de(m)}}A(a,he,b=>{f=b,p()}),A(a,ne,b=>{c=b,p()})})}finally{}}async function Lt(t,e){return C(t,L,D,(o,r,s)=>{const n=IDBKeyRange.bound([e,0],[e+1,0],!1,!0);Fe(o.index(Oe),n,s)})}async function Re(t,e){const o=Me(O(e));return o.length?C(t,L,D,(r,s,n)=>{const a=[],m=()=>{a.length===o.length&&f()},f=()=>{const c=Ne(a,u=>u.unicode);n(c.sort((u,p)=>u.order<p.order?-1:1))};for(let c=0;c<o.length;c++){const u=o[c],p=c===o.length-1?IDBKeyRange.bound(u,u+"￿",!1,!0):IDBKeyRange.only(u);Fe(r.index(Ae),p,l=>{a.push(l),m()})}}):[]}async function Ot(t,e){const o=await Re(t,e);return o.length?o.filter(r=>(r.shortcodes||[]).map(n=>n.toLowerCase()).includes(e.toLowerCase()))[0]||null:await It(t,s=>(s.shortcodes||[]).includes(e.toLowerCase()))||null}async function Dt(t,e){return C(t,L,D,(o,r,s)=>A(o,e,n=>{if(n)return s(n);A(o.index(De),e,a=>s(a||null))}))}function Pe(t,e,o){return C(t,e,D,(r,s,n)=>A(r,o,n))}function $t(t,e,o,r){return C(t,e,ae,(s,n)=>{s.put(r,o),de(n)})}function Mt(t,e){return C(t,se,ae,(o,r)=>A(o,e,s=>{o.put((s||0)+1,e),de(r)}))}function Bt(t,e,o){return o===0?[]:C(t,[se,L],D,([r,s],n,a)=>{const m=[];r.index(Le).openCursor(void 0,"prev").onsuccess=f=>{const c=f.target.result;if(!c)return a(m);function u(b){if(m.push(b),m.length===o)return a(m);c.continue()}const p=c.primaryKey,l=e.byName(p);if(l)return u(l);A(s,p,b=>{if(b)return u(b);c.continue()})}})}const P="";function Ft(t,e){const o=new Map;for(const s of t){const n=e(s);for(const a of n){let m=o;for(let c=0;c<a.length;c++){const u=a.charAt(c);let p=m.get(u);p||(p=new Map,m.set(u,p)),m=p}let f=m.get(P);f||(f=[],m.set(P,f)),f.push(s)}}return(s,n)=>{let a=o;for(let c=0;c<s.length;c++){const u=s.charAt(c),p=a.get(u);if(p)a=p;else return[]}if(n)return a.get(P)||[];const m=[],f=[a];for(;f.length;){const u=[...f.shift().entries()].sort((p,l)=>p[0]<l[0]?-1:1);for(const[p,l]of u)p===P?m.push(...l):f.push(l)}return m}}const Nt=["name","url"];function Rt(t){const e=t&&Array.isArray(t),o=e&&t.length&&(!t[0]||Nt.some(r=>!(r in t[0])));if(!e||o)throw new Error("Custom emojis are in the wrong format")}function ye(t){Rt(t);const e=(l,b)=>l.name.toLowerCase()<b.name.toLowerCase()?-1:1,o=t.sort(e),s=Ft(t,l=>[...new Set((l.shortcodes||[]).map(b=>O(b)).flat())]),n=l=>s(l,!0),a=l=>s(l,!1),m=l=>{const b=O(l),_=b.map((w,k)=>(k<b.length-1?n:a)(w));return Ne(_,w=>w.name).sort(e)},f=new Map,c=new Map;for(const l of t){c.set(l.name.toLowerCase(),l);for(const b of l.shortcodes||[])f.set(b.toLowerCase(),l)}return{all:o,search:m,byShortcode:l=>f.get(l.toLowerCase()),byName:l=>c.get(l.toLowerCase())}}const Pt=typeof wrappedJSObject<"u";function $(t){if(!t)return t;if(Pt&&(t=structuredClone(t)),delete t.tokens,t.skinTones){const e=t.skinTones.length;t.skins=Array(e);for(let o=0;o<e;o++)t.skins[o]={tone:t.skinTones[o],unicode:t.skinUnicodes[o],version:t.skinVersions[o]};delete t.skinTones,delete t.skinUnicodes,delete t.skinVersions}return t}function zt(t){t||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Ut=["annotation","emoji","group","order","version"];function Gt(t){if(!t||!Array.isArray(t)||!t[0]||typeof t[0]!="object"||Ut.some(e=>!(e in t[0])))throw new Error("Emoji data is in the wrong format")}function Kt(t,e){if(Math.floor(t.status/100)!==2)throw new Error("Failed to fetch: "+e+":  "+t.status)}async function Wt(t){const e=await fetch(t);Kt(e,t);const o=e.headers.get("etag");zt(o);const r=await e.json();return Gt(r),[o,r]}function Vt(t){for(var e="",o=new Uint8Array(t),r=o.byteLength,s=-1;++s<r;)e+=String.fromCharCode(o[s]);return e}function Ht(t){for(var e=t.length,o=new ArrayBuffer(e),r=new Uint8Array(o),s=-1;++s<e;)r[s]=t.charCodeAt(s);return o}async function qt(t){const e=JSON.stringify(t);let o=Ht(e);const r=await crypto.subtle.digest("SHA-1",o),s=Vt(r);return btoa(s)}async function Xt(t,e){let[o,r]=await Wt(e);o||(o=await qt(r)),await At(t,r,e,o)}class Yt{constructor({dataSource:e=gt,locale:o=bt,customEmoji:r=[]}={}){this.dataSource=e,this.locale=o,this._dbName="emoji-picker-element-".concat(this.locale),this._db=void 0,this._lazyUpdate=void 0,this._custom=ye(r),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await vt(this._dbName);wt(this._dbName,this._clear);const o=this.dataSource;await Ct(e)&&await Xt(e,o)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return q(e),await this.ready(),be(await Lt(this._db,e)).map($)}async getEmojiBySearchQuery(e){R(e),await this.ready();const o=this._custom.search(e),r=be(await Re(this._db,e)).map($);return[...o,...r]}async getEmojiByShortcode(e){R(e),await this.ready();const o=this._custom.byShortcode(e);return o||$(await Ot(this._db,e))}async getEmojiByUnicodeOrName(e){R(e),await this.ready();const o=this._custom.byName(e);return o||$(await Dt(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Pe(this._db,B,ge)||0}async setPreferredSkinTone(e){return q(e),await this.ready(),$t(this._db,B,ge,e)}async incrementFavoriteEmojiCount(e){return R(e),await this.ready(),Mt(this._db,e)}async getTopFavoriteEmoji(e){return q(e),await this.ready(),(await Bt(this._db,this._custom,e)).map($)}set customEmoji(e){this._custom=ye(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await ce(this._dbName)}async delete(){await this._shutdown(),await jt(this._dbName)}}const re=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map(([t,e,o])=>({id:t,emoji:e,name:o})),X=re.slice(1),Zt=2,ke=6,ze=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function Ee(t){return t.unicode.includes("‍")}const Jt={"🫨":15.1,"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},Qt=1e3,en="🖐️",tn=8,nn=["😊","😒","❤️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],Ue='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',on=(t,e)=>t<e?-1:t>e?1:0,ve=(t,e)=>{const o=document.createElement("canvas");o.width=o.height=1;const r=o.getContext("2d");return r.textBaseline="top",r.font="100px ".concat(Ue),r.fillStyle=e,r.scale(.01,.01),r.fillText(t,0,0),r.getImageData(0,0,1,1).data},rn=(t,e)=>{const o=[...t].join(","),r=[...e].join(",");return o===r&&!o.startsWith("0,0,0,")};function sn(t){const e=ve(t,"#000"),o=ve(t,"#fff");return e&&o&&rn(e,o)}function an(){const t=Object.entries(Jt);try{for(const[e,o]of t)if(sn(e))return o}catch(e){}finally{}return t[0][1]}let Y;const Z=()=>(Y||(Y=new Promise(t=>ze(()=>t(an())))),Y),ie=new Map,cn="️",dn="\uD83C",un="‍",ln=127995,fn=57339;function mn(t,e){if(e===0)return t;const o=t.indexOf(un);return o!==-1?t.substring(0,o)+String.fromCodePoint(ln+e-1)+t.substring(o):(t.endsWith(cn)&&(t=t.substring(0,t.length-1)),t+dn+String.fromCodePoint(fn+e-1))}function x(t){t.preventDefault(),t.stopPropagation()}function J(t,e,o){return e+=t?-1:1,e<0?e=o.length-1:e>=o.length&&(e=0),e}function Ge(t,e){const o=new Set,r=[];for(const s of t){const n=e(s);o.has(n)||(o.add(n),r.push(s))}return r}function pn(t,e){const o=r=>{const s={};for(const n of r)typeof n.tone=="number"&&n.version<=e&&(s[n.tone]=n.unicode);return s};return t.map(({unicode:r,skins:s,shortcodes:n,url:a,name:m,category:f,annotation:c})=>({unicode:r,name:m,shortcodes:n,url:a,category:f,annotation:c,id:r||m,skins:s&&o(s)}))}const G=requestAnimationFrame;let hn=typeof ResizeObserver=="function";function gn(t,e,o){let r;hn?(r=new ResizeObserver(o),r.observe(t)):G(o),e.addEventListener("abort",()=>{r&&r.disconnect()})}function je(t){{const e=document.createRange();return e.selectNode(t.firstChild),e.getBoundingClientRect().width}}let Q;function bn(t,e,o){for(const r of t){const s=o(r),n=je(s);typeof Q>"u"&&(Q=je(e));const a=n/1.8<Q;ie.set(r.unicode,a)}}function yn(t){return Ge(t,e=>e)}function kn(t){t&&(t.scrollTop=0)}function M(t,e,o){let r=t.get(e);return r||(r=o(),t.set(e,r)),r}function we(t){return""+t}function En(t){const e=document.createElement("template");return e.innerHTML=t,e}const vn=new WeakMap,jn=new WeakMap,wn=Symbol("un-keyed"),Tn="replaceChildren"in Element.prototype;function Sn(t,e){Tn?t.replaceChildren(...e):(t.innerHTML="",t.append(...e))}function xn(t,e){let o=t.firstChild,r=0;for(;o;){if(e[r]!==o)return!0;o=o.nextSibling,r++}return r!==e.length}function _n(t,e){const{targetNode:o}=e;let{targetParentNode:r}=e,s=!1;r?s=xn(r,t):(s=!0,e.targetNode=void 0,e.targetParentNode=r=o.parentNode),s&&Sn(r,t)}function Cn(t,e){for(const o of e){const{targetNode:r,currentExpression:s,binding:{expressionIndex:n,attributeName:a,attributeValuePre:m,attributeValuePost:f}}=o,c=t[n];if(s!==c)if(o.currentExpression=c,a)r.setAttribute(a,m+we(c)+f);else{let u;Array.isArray(c)?_n(c,o):c instanceof Element?(u=c,r.replaceWith(u)):r.nodeValue=we(c),u&&(o.targetNode=u)}}}function In(t){let e="",o=!1,r=!1,s=-1;const n=new Map,a=[];for(let f=0,c=t.length;f<c;f++){const u=t[f];if(e+=u,f===c-1)break;for(let y=0;y<u.length;y++)switch(u.charAt(y)){case"<":{u.charAt(y+1)==="/"?a.pop():(o=!0,a.push(++s));break}case">":{o=!1,r=!1;break}case"=":{r=!0;break}}const p=a[a.length-1],l=M(n,p,()=>[]);let b,_,w;if(r){const y=/(\S+)="?([^"=]*)$/.exec(u);b=y[1],_=y[2],w=/^[^">]*/.exec(t[f+1])[0]}const k={attributeName:b,attributeValuePre:_,attributeValuePost:w,expressionIndex:f};l.push(k),!o&&!r&&(e+=" ")}return{template:En(e),elementsToBindings:n}}function An(t,e){const o=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT);let s=t,n=-1;do{const a=e.get(++n);if(a)for(let m=0;m<a.length;m++){const f=a[m],c=f.attributeName?s:s.firstChild,u={binding:f,targetNode:c,targetParentNode:void 0,currentExpression:void 0};o.push(u)}}while(s=r.nextNode());return o}function Ln(t){const{template:e,elementsToBindings:o}=M(vn,t,()=>In(t)),r=e.cloneNode(!0).content.firstElementChild,s=An(r,o);return function(a){return Cn(a,s),r}}function On(t){const e=M(jn,t,()=>new Map);let o=wn;function r(n,...a){const m=M(e,n,()=>new Map);return M(m,o,()=>Ln(n))(a)}function s(n,a,m){return n.map((f,c)=>{const u=o;o=m(f);try{return a(f,c)}finally{o=u}})}return{map:s,html:r}}var Te,Se,xe,_e,Ce,Ie;function Dn(t,e,o,r,s,n,a,m){const{labelWithSkin:f,titleForEmoji:c,unicodeWithSkin:u}=o,{html:p,map:l}=On(e);function b(k,y,T){return l(k,(v,F)=>p(Se||(Se=I(['<button role="','" aria-selected="','" aria-label="','" title="','" class="emoji ','" id="','">',"</button>"])),y?"option":"menuitem",e.searchMode?F===e.activeSearchItem:"",f(v,e.currentSkinTone),c(v),y&&F===e.activeSearchItem?"active":"","".concat(T,"-").concat(v.id),v.unicode?u(v,e.currentSkinTone):p(Te||(Te=I(['<img class="custom-emoji" src="','" alt="" loading="lazy">'])),v.url)),v=>"".concat(T,"-").concat(v.id))}const w=(()=>p(Ie||(Ie=I(['<section data-ref="rootElement" class="picker" aria-label="','" style="','"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="','" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="','" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="','" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown"><label class="sr-only" for="search">','</label> <span id="search-description" class="sr-only">','</span></div><div class="skintone-button-wrapper ','"><button id="skintone-button" class="emoji ','" aria-label="','" title="','" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="','" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">','</button></div><span id="skintone-description" class="sr-only">','</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ','" style="transform:translateY(',')" role="listbox" aria-label="','" aria-activedescendant="skintone-','" aria-hidden="','" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">','</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(',',1fr)" aria-label="','" data-on-keydown="onNavKeydown" data-on-click="onNavClick">','</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(','%)"></div></div><div class="message ','" role="alert" aria-live="polite">','</div><div data-ref="tabpanelElement" class="tabpanel ','" role="','" aria-label="','" id="','" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">','</div></div><div class="favorites emoji-menu ','" role="menu" aria-label="','" data-on-click="onEmojiClick">','</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">😀</button></section>'])),e.i18n.regionLabel,e.pickerStyle,e.i18n.searchLabel,!!(e.searchMode&&e.currentEmojis.length),e.activeSearchItemId?"emo-".concat(e.activeSearchItemId):"",e.i18n.searchLabel,e.i18n.searchDescription,e.skinTonePickerExpandedAfterAnimation?"expanded":"",e.skinTonePickerExpanded?"hide-focus":"",e.skinToneButtonLabel,e.skinToneButtonLabel,e.skinTonePickerExpanded,e.skinToneButtonText,e.i18n.skinToneDescription,e.skinTonePickerExpanded?"":"hidden no-animate",e.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))",e.i18n.skinTonesLabel,e.activeSkinTone,!e.skinTonePickerExpanded,l(e.skinTones,(k,y)=>p(xe||(xe=I(['<div id="skintone-','" class="emoji ','" aria-selected="','" role="option" title="','" aria-label="','">',"</div>"])),y,y===e.activeSkinTone?"active":"",y===e.activeSkinTone,e.i18n.skinTones[y],e.i18n.skinTones[y],k),k=>k),e.groups.length,e.i18n.categoriesLabel,l(e.groups,k=>p(_e||(_e=I(['<button role="tab" class="nav-button" aria-controls="tab-','" aria-label="','" aria-selected="','" title="','" data-group-id="','"><div class="nav-emoji emoji">',"</div></button>"])),k.id,e.i18n.categories[k.name],!e.searchMode&&e.currentGroup.id===k.id,e.i18n.categories[k.name],k.id,k.emoji),k=>k.id),(e.isRtl?-1:1)*e.currentGroupIndex*100,e.message?"":"gone",e.message,!e.databaseLoaded||e.message?"gone":"",e.searchMode?"region":"tabpanel",e.searchMode?e.i18n.searchResultsLabel:e.i18n.categories[e.currentGroup.name],e.searchMode?"":"tab-".concat(e.currentGroup.id),l(e.currentEmojisWithCategories,(k,y)=>p(Ce||(Ce=I(['<div><div id="menu-label-','" class="category ','" aria-hidden="true">','</div><div class="emoji-menu" role="','" aria-labelledby="menu-label-','" id="','">',"</div></div>"])),y,e.currentEmojisWithCategories.length===1&&e.currentEmojisWithCategories[0].category===""?"gone":"",e.searchMode?e.i18n.searchResultsLabel:k.category?k.category:e.currentEmojisWithCategories.length>1?e.i18n.categories.custom:e.i18n.categories[e.currentGroup.name],e.searchMode?"listbox":"menu",y,e.searchMode?"search-results":"",b(k.emojis,e.searchMode,"emo")),k=>k.category),e.message?"gone":"",e.i18n.favoritesLabel,b(e.currentFavorites,!1,"fav")))();if(m){t.appendChild(w);const k=(y,T)=>{for(const v of t.querySelectorAll("[".concat(y,"]")))T(v,v.getAttribute(y))};for(const y of["click","focusout","input","keydown","keyup"])k("data-on-".concat(y),(T,v)=>{T.addEventListener(y,r[v])});k("data-ref",(y,T)=>{n[T]=y}),k("data-action",(y,T)=>{s[T](y)}),a.addEventListener("abort",()=>{t.removeChild(w)})}}const W=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t);function $n(t){let e=!1,o;const r=new Map,s=new Set;let n;const a=()=>{if(e)return;const c=[...s];s.clear();try{for(const u of c)u()}finally{n=!1,s.size&&(n=!0,W(a))}},m=new Proxy({},{get(c,u){if(o){let p=r.get(u);p||(p=new Set,r.set(u,p)),p.add(o)}return c[u]},set(c,u,p){c[u]=p;const l=r.get(u);if(l){for(const b of l)s.add(b);n||(n=!0,W(a))}return!0}}),f=c=>{const u=()=>{const p=o;o=u;try{return c()}finally{o=p}};return u()};return t.addEventListener("abort",()=>{e=!0}),{state:m,createEffect:f}}function ee(t,e,o){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!o(t[r],e[r]))return!1;return!0}const te=[],{assign:z}=Object;function Mn(t,e){const o={},r=new AbortController,s=r.signal,{state:n,createEffect:a}=$n(s);z(n,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),z(n,e),z(n,{initialLoad:!0,currentEmojis:[],currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:tn,isRtl:!1,currentGroupIndex:0,groups:X,databaseLoaded:!1,activeSearchItemId:void 0}),a(()=>{n.currentGroup!==n.groups[n.currentGroupIndex]&&(n.currentGroup=n.groups[n.currentGroupIndex])});const m=i=>{t.getElementById(i).focus()},f=i=>t.getElementById("emo-".concat(i.id)),c=(i,d)=>{o.rootElement.dispatchEvent(new CustomEvent(i,{detail:d,bubbles:!0,composed:!0}))},u=(i,d)=>i.id===d.id,p=(i,d)=>{const{category:h,emojis:g}=i,{category:E,emojis:j}=d;return h!==E?!1:ee(g,j,u)},l=i=>{ee(n.currentEmojis,i,u)||(n.currentEmojis=i)},b=i=>{n.searchMode!==i&&(n.searchMode=i)},_=i=>{ee(n.currentEmojisWithCategories,i,p)||(n.currentEmojisWithCategories=i)},w=(i,d)=>d&&i.skins&&i.skins[d]||i.unicode,T={labelWithSkin:(i,d)=>yn([i.name||w(i,d),i.annotation,...i.shortcodes||te].filter(Boolean)).join(", "),titleForEmoji:i=>i.annotation||(i.shortcodes||te).join(", "),unicodeWithSkin:w},v={onClickSkinToneButton:ot,onEmojiClick:tt,onNavClick:Qe,onNavKeydown:et,onSearchKeydown:Je,onSkinToneOptionsClick:nt,onSkinToneOptionsFocusOut:st,onSkinToneOptionsKeydown:rt,onSkinToneOptionsKeyup:it,onSearchInput:at},F={calculateEmojiGridStyle:He};let ue=!0;a(()=>{Dn(t,n,T,v,F,o,s,ue),ue=!1}),n.emojiVersion||Z().then(i=>{i||(n.message=n.i18n.emojiUnsupportedMessage)}),a(()=>{async function i(){let d=!1;const h=setTimeout(()=>{d=!0,n.message=n.i18n.loadingMessage},Qt);try{await n.database.ready(),n.databaseLoaded=!0}catch(g){console.error(g),n.message=n.i18n.networkErrorMessage}finally{clearTimeout(h),d&&(d=!1,n.message="")}}n.database&&i()}),a(()=>{n.pickerStyle="\n      --num-groups: ".concat(n.groups.length,"; \n      --indicator-opacity: ").concat(n.searchMode?0:1,"; \n      --num-skintones: ").concat(ke,";")}),a(()=>{n.customEmoji&&n.database&&le()}),a(()=>{n.customEmoji&&n.customEmoji.length?n.groups!==re&&(n.groups=re):n.groups!==X&&(n.currentGroupIndex&&n.currentGroupIndex--,n.groups=X)}),a(()=>{async function i(){n.databaseLoaded&&(n.currentSkinTone=await n.database.getPreferredSkinTone())}i()}),a(()=>{n.skinTones=Array(ke).fill().map((i,d)=>mn(n.skinToneEmoji,d))}),a(()=>{n.skinToneButtonText=n.skinTones[n.currentSkinTone]}),a(()=>{n.skinToneButtonLabel=n.i18n.skinToneLabel.replace("{skinTone}",n.i18n.skinTones[n.currentSkinTone])}),a(()=>{async function i(){const{database:d}=n,h=(await Promise.all(nn.map(g=>d.getEmojiByUnicodeOrName(g)))).filter(Boolean);n.defaultFavoriteEmojis=h}n.databaseLoaded&&i()});function le(){n.database.customEmoji=n.customEmoji||te}a(()=>{async function i(){le();const{database:d,defaultFavoriteEmojis:h,numColumns:g}=n,E=await d.getTopFavoriteEmoji(g),j=await V(Ge([...E,...h],S=>S.unicode||S.name).slice(0,g));n.currentFavorites=j}n.databaseLoaded&&n.defaultFavoriteEmojis&&i()});function He(i){gn(i,s,()=>{{const d=getComputedStyle(o.rootElement),h=parseInt(d.getPropertyValue("--num-columns"),10),g=d.getPropertyValue("direction")==="rtl";n.numColumns=h,n.isRtl=g}})}a(()=>{async function i(){const{searchText:d,currentGroup:h,databaseLoaded:g,customEmoji:E}=n;if(!g)n.currentEmojis=[],n.searchMode=!1;else if(d.length>=Zt){const j=await Ze(d);n.searchText===d&&(l(j),b(!0))}else{const{id:j}=h;if(j!==-1||E&&E.length){const S=await Ye(j);n.currentGroup.id===j&&(l(S),b(!1))}}}i()}),a(()=>{const{currentEmojis:i,emojiVersion:d}=n,h=i.filter(g=>g.unicode).filter(g=>Ee(g)&&!ie.has(g.unicode));if(!d&&h.length)l(i),G(()=>qe(h));else{const g=d?i:i.filter(Xe);l(g),G(()=>kn(o.tabpanelElement))}});function qe(i){bn(i,o.baselineEmoji,f),n.currentEmojis=n.currentEmojis}function Xe(i){return!i.unicode||!Ee(i)||ie.get(i.unicode)}async function fe(i){const d=n.emojiVersion||await Z();return i.filter(({version:h})=>!h||h<=d)}async function V(i){return pn(i,n.emojiVersion||await Z())}async function Ye(i){const d=i===-1?n.customEmoji:await n.database.getEmojiByGroup(i);return V(await fe(d))}async function Ze(i){return V(await fe(await n.database.getEmojiBySearchQuery(i)))}a(()=>{}),a(()=>{function i(){const{searchMode:h,currentEmojis:g}=n;if(h)return[{category:"",emojis:g}];const E=new Map;for(const j of g){const S=j.category||"";let N=E.get(S);N||(N=[],E.set(S,N)),N.push(j)}return[...E.entries()].map(([j,S])=>({category:j,emojis:S})).sort((j,S)=>n.customCategorySorting(j.category,S.category))}const d=i();_(d)}),a(()=>{n.activeSearchItemId=n.activeSearchItem!==-1&&n.currentEmojis[n.activeSearchItem].id}),a(()=>{const{rawSearchText:i}=n;ze(()=>{n.searchText=(i||"").trim(),n.activeSearchItem=-1})});function Je(i){if(!n.searchMode||!n.currentEmojis.length)return;const d=h=>{x(i),n.activeSearchItem=J(h,n.activeSearchItem,n.currentEmojis)};switch(i.key){case"ArrowDown":return d(!1);case"ArrowUp":return d(!0);case"Enter":if(n.activeSearchItem===-1)n.activeSearchItem=0;else return x(i),me(n.currentEmojis[n.activeSearchItem].id)}}function Qe(i){const{target:d}=i,h=d.closest(".nav-button");if(!h)return;const g=parseInt(h.dataset.groupId,10);o.searchElement.value="",n.rawSearchText="",n.searchText="",n.activeSearchItem=-1,n.currentGroupIndex=n.groups.findIndex(E=>E.id===g)}function et(i){const{target:d,key:h}=i,g=E=>{E&&(x(i),E.focus())};switch(h){case"ArrowLeft":return g(d.previousElementSibling);case"ArrowRight":return g(d.nextElementSibling);case"Home":return g(d.parentElement.firstElementChild);case"End":return g(d.parentElement.lastElementChild)}}async function me(i){const d=await n.database.getEmojiByUnicodeOrName(i),h=[...n.currentEmojis,...n.currentFavorites].find(E=>E.id===i),g=h.unicode&&w(h,n.currentSkinTone);await n.database.incrementFavoriteEmojiCount(i),c("emoji-click",{emoji:d,skinTone:n.currentSkinTone,...g&&{unicode:g},...h.name&&{name:h.name}})}async function tt(i){const{target:d}=i;if(!d.classList.contains("emoji"))return;x(i);const h=d.id.substring(4);me(h)}function H(i){n.currentSkinTone=i,n.skinTonePickerExpanded=!1,m("skintone-button"),c("skin-tone-change",{skinTone:i}),n.database.setPreferredSkinTone(i)}function nt(i){const{target:{id:d}}=i,h=d&&d.match(/^skintone-(\d)/);if(!h)return;x(i);const g=parseInt(h[1],10);H(g)}function ot(i){n.skinTonePickerExpanded=!n.skinTonePickerExpanded,n.activeSkinTone=n.currentSkinTone,n.skinTonePickerExpanded&&(x(i),G(()=>m("skintone-list")))}a(()=>{n.skinTonePickerExpanded?o.skinToneDropdown.addEventListener("transitionend",()=>{n.skinTonePickerExpandedAfterAnimation=!0},{once:!0}):n.skinTonePickerExpandedAfterAnimation=!1});function rt(i){if(!n.skinTonePickerExpanded)return;const d=async h=>{x(i),n.activeSkinTone=h};switch(i.key){case"ArrowUp":return d(J(!0,n.activeSkinTone,n.skinTones));case"ArrowDown":return d(J(!1,n.activeSkinTone,n.skinTones));case"Home":return d(0);case"End":return d(n.skinTones.length-1);case"Enter":return x(i),H(n.activeSkinTone);case"Escape":return x(i),n.skinTonePickerExpanded=!1,m("skintone-button")}}function it(i){if(n.skinTonePickerExpanded)switch(i.key){case" ":return x(i),H(n.activeSkinTone)}}async function st(i){const{relatedTarget:d}=i;(!d||d.id!=="skintone-list")&&(n.skinTonePickerExpanded=!1)}function at(i){n.rawSearchText=i.target.value}return{$set(i){z(n,i)},$destroy(){r.abort()}}}const Bn="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Fn="en";var Nn={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}},Rn=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}";const Ke=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"],Pn=":host{--emoji-font-family:".concat(Ue,"}");class We extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=Rn+Pn,this.shadowRoot.appendChild(o),this._ctx={locale:Fn,dataSource:Bn,skinToneEmoji:en,customCategorySorting:on,customEmoji:null,i18n:Nn,emojiVersion:null,...e};for(const r of Ke)r!=="database"&&Object.prototype.hasOwnProperty.call(this,r)&&(this._ctx[r]=this[r],delete this[r]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=Mn(this.shadowRoot,this._ctx))}disconnectedCallback(){W(()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e.close().catch(o=>console.error(o))}})}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(e,o,r){this._set(e.replace(/-([a-z])/g,(s,n)=>n.toUpperCase()),e==="emoji-version"?parseFloat(r):r)}_set(e,o){this._ctx[e]=o,this._cmp&&this._cmp.$set({[e]:o}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:o,database:r}=this._ctx;(!r||r.locale!==e||r.dataSource!==o)&&this._set("database",new Yt({locale:e,dataSource:o}))}_dbFlush(){W(()=>this._dbCreate())}}const Ve={};for(const t of Ke)Ve[t]={get(){return t==="database"&&this._dbCreate(),this._ctx[t]},set(e){if(t==="database")throw new Error("database is read-only");this._set(t,e)}};Object.defineProperties(We.prototype,Ve);customElements.get("emoji-picker")||customElements.define("emoji-picker",We);export{We as P};
