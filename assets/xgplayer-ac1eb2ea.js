import{g as at}from"./@babel-260269db.js";function Me(o,s){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);s&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),n.push.apply(n,t)}return n}function $(o){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Me(Object(n),!0).forEach(function(t){C(o,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}function G(o){"@babel/helpers - typeof";return G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},G(o)}function O(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}function He(o,s){for(var n=0;n<s.length;n++){var t=s[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,lt(t.key),t)}}function x(o,s,n){return s&&He(o.prototype,s),n&&He(o,n),Object.defineProperty(o,"prototype",{writable:!1}),o}function C(o,s,n){return s=lt(s),s in o?Object.defineProperty(o,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[s]=n,o}function F(o,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(s&&s.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),s&&we(o,s)}function S(o){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},S(o)}function we(o,s){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},we(o,s)}function Pt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(o){return!1}}function _(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function ut(o,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _(o)}function M(o){var s=Pt();return function(){var t=S(o),e;if(s){var i=S(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return ut(this,e)}}function wt(o,s){for(;!Object.prototype.hasOwnProperty.call(o,s)&&(o=S(o),o!==null););return o}function w(){return typeof Reflect<"u"&&Reflect.get?w=Reflect.get.bind():w=function(s,n,t){var e=wt(s,n);if(e){var i=Object.getOwnPropertyDescriptor(e,n);return i.get?i.get.call(arguments.length<3?s:t):i.value}},w.apply(this,arguments)}function J(o){return It(o)||Ot(o)||xt(o)||Rt()}function It(o){if(Array.isArray(o))return Ie(o)}function Ot(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function xt(o,s){if(o){if(typeof o=="string")return Ie(o,s);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ie(o,s)}}function Ie(o,s){(s==null||s>o.length)&&(s=o.length);for(var n=0,t=new Array(s);n<s;n++)t[n]=o[n];return t}function Rt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lt(o,s){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var t=n.call(o,s||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(o)}function lt(o){var s=Lt(o,"string");return typeof s=="symbol"?s:String(s)}var ct={exports:{}};(function(o){var s=Object.prototype.hasOwnProperty,n="~";function t(){}Object.create&&(t.prototype=Object.create(null),new t().__proto__||(n=!1));function e(u,l,f){this.fn=u,this.context=l,this.once=f||!1}function i(u,l,f,h,d){if(typeof f!="function")throw new TypeError("The listener must be a function");var g=new e(f,h||u,d),v=n?n+l:l;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],g]:u._events[v].push(g):(u._events[v]=g,u._eventsCount++),u}function r(u,l){--u._eventsCount===0?u._events=new t:delete u._events[l]}function a(){this._events=new t,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],f,h;if(this._eventsCount===0)return l;for(h in f=this._events)s.call(f,h)&&l.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},a.prototype.listeners=function(l){var f=n?n+l:l,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,g=h.length,v=new Array(g);d<g;d++)v[d]=h[d].fn;return v},a.prototype.listenerCount=function(l){var f=n?n+l:l,h=this._events[f];return h?h.fn?1:h.length:0},a.prototype.emit=function(l,f,h,d,g,v){var y=n?n+l:l;if(!this._events[y])return!1;var m=this._events[y],T=arguments.length,k,E;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),T){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,f),!0;case 3:return m.fn.call(m.context,f,h),!0;case 4:return m.fn.call(m.context,f,h,d),!0;case 5:return m.fn.call(m.context,f,h,d,g),!0;case 6:return m.fn.call(m.context,f,h,d,g,v),!0}for(E=1,k=new Array(T-1);E<T;E++)k[E-1]=arguments[E];m.fn.apply(m.context,k)}else{var L=m.length,R;for(E=0;E<L;E++)switch(m[E].once&&this.removeListener(l,m[E].fn,void 0,!0),T){case 1:m[E].fn.call(m[E].context);break;case 2:m[E].fn.call(m[E].context,f);break;case 3:m[E].fn.call(m[E].context,f,h);break;case 4:m[E].fn.call(m[E].context,f,h,d);break;default:if(!k)for(R=1,k=new Array(T-1);R<T;R++)k[R-1]=arguments[R];m[E].fn.apply(m[E].context,k)}}return!0},a.prototype.on=function(l,f,h){return i(this,l,f,h,!1)},a.prototype.once=function(l,f,h){return i(this,l,f,h,!0)},a.prototype.removeListener=function(l,f,h,d){var g=n?n+l:l;if(!this._events[g])return this;if(!f)return r(this,g),this;var v=this._events[g];if(v.fn)v.fn===f&&(!d||v.once)&&(!h||v.context===h)&&r(this,g);else{for(var y=0,m=[],T=v.length;y<T;y++)(v[y].fn!==f||d&&!v[y].once||h&&v[y].context!==h)&&m.push(v[y]);m.length?this._events[g]=m.length===1?m[0]:m:r(this,g)}return this},a.prototype.removeAllListeners=function(l){var f;return l?(f=n?n+l:l,this._events[f]&&r(this,f)):(this._events=new t,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,o.exports=a})(ct);var ft=ct.exports;const Dt=at(ft);var Nt=typeof window<"u"&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,_e={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},Ee="%c[xgplayer]",P={config:{debug:Nt?3:0},logInfo:function(s){for(var n,t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];this.config.debug>=3&&(n=console).log.apply(n,[Ee,_e.info,s].concat(e))},logWarn:function(s){for(var n,t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];this.config.debug>=1&&(n=console).warn.apply(n,[Ee,_e.warn,s].concat(e))},logError:function(s){var n;if(!(this.config.debug<1)){for(var t=this.config.debug>=2?"trace":"error",e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];(n=console)[t].apply(n,[Ee,_e.error,s].concat(i))}}};function Ft(o){o.logInfo=P.logInfo.bind(o),o.logWarn=P.logWarn.bind(o),o.logError=P.logError.bind(o)}var Mt=function(){function o(s){O(this,o),this.bufferedList=s}return x(o,[{key:"start",value:function(n){return this.bufferedList[n].start}},{key:"end",value:function(n){return this.bufferedList[n].end}},{key:"length",get:function(){return this.bufferedList.length}}]),o}(),c={};c.createDom=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",e=document.createElement(o);return e.className=t,e.innerHTML=s,Object.keys(n).forEach(function(i){var r=i,a=n[i];o==="video"||o==="audio"||o==="live-video"?a&&e.setAttribute(r,a):e.setAttribute(r,a)}),e};c.createDomFromHtml=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";try{var t=document.createElement("div");t.innerHTML=o;var e=t.children;return t=null,e.length>0?(e=e[0],n&&c.addClass(e,n),s&&Object.keys(s).forEach(function(i){e.setAttribute(i,s[i])}),e):null}catch(i){return P.logError("util.createDomFromHtml",i),null}};c.hasClass=function(o,s){if(!o||!s)return!1;try{return Array.prototype.some.call(o.classList,function(t){return t===s})}catch(t){var n=o.className&&G(o.className)==="object"?o.getAttribute("class"):o.className;return n&&!!n.match(new RegExp("(\\s|^)"+s+"(\\s|$)"))}};c.addClass=function(o,s){if(!(!o||!s))try{s.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(n){n&&o.classList.add(n)})}catch(n){c.hasClass(o,s)||(o.className&&G(o.className)==="object"?o.setAttribute("class",o.getAttribute("class")+" "+s):o.className+=" "+s)}};c.removeClass=function(o,s){if(!(!o||!s))try{s.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(n){n&&o.classList.remove(n)})}catch(n){c.hasClass(o,s)&&s.split(/\s+/g).forEach(function(t){var e=new RegExp("(\\s|^)"+t+"(\\s|$)");o.className&&G(o.className)==="object"?o.setAttribute("class",o.getAttribute("class").replace(e," ")):o.className=o.className.replace(e," ")})}};c.toggleClass=function(o,s){o&&s.split(/\s+/g).forEach(function(n){c.hasClass(o,n)?c.removeClass(o,n):c.addClass(o,n)})};c.classNames=function(){for(var o=arguments,s=[],n=function(i){c.typeOf(o[i])==="String"?s.push(o[i]):c.typeOf(o[i])==="Object"&&Object.keys(o[i]).map(function(r){o[i][r]&&s.push(r)})},t=0;t<arguments.length;t++)n(t);return s.join(" ")};c.findDom=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,s=arguments.length>1?arguments[1]:void 0,n;try{n=o.querySelector(s)}catch(t){P.logError("util.findDom",t),s.indexOf("#")===0&&(n=o.getElementById(s.slice(1)))}return n};c.getCss=function(o,s){return o.currentStyle?o.currentStyle[s]:document.defaultView.getComputedStyle(o,!1)[s]};c.padStart=function(o,s,n){for(var t=String(n),e=s>>0,i=Math.ceil(e/t.length),r=[],a=String(o);i--;)r.push(t);return r.join("").substring(0,e-a.length)+a};c.format=function(o){if(window.isNaN(o))return"";o=Math.round(o);var s=c.padStart(Math.floor(o/3600),2,0),n=c.padStart(Math.floor((o-s*3600)/60),2,0),t=c.padStart(Math.floor(o-s*3600-n*60),2,0);return(s==="00"?[n,t]:[s,n,t]).join(":")};c.event=function(o){if(o.touches){var s=o.touches[0]||o.changedTouches[0];o.clientX=s.clientX||0,o.clientY=s.clientY||0,o.offsetX=s.pageX-s.target.offsetLeft,o.offsetY=s.pageY-s.target.offsetTop}o._target=o.target||o.srcElement};c.typeOf=function(o){return Object.prototype.toString.call(o).match(/([^\s.*]+)(?=]$)/g)[0]};c.deepCopy=function(o,s){if(c.typeOf(s)==="Object"&&c.typeOf(o)==="Object")return Object.keys(s).forEach(function(n){c.typeOf(s[n])==="Object"&&!(s[n]instanceof Node)?o[n]===void 0||o[n]===void 0?o[n]=s[n]:c.deepCopy(o[n],s[n]):c.typeOf(s[n])==="Array"?o[n]=c.typeOf(o[n])==="Array"?o[n].concat(s[n]):s[n]:o[n]=s[n]}),o};c.deepMerge=function(o,s){return Object.keys(s).map(function(n){if(c.typeOf(s[n])==="Array"&&c.typeOf(o[n])==="Array"){if(c.typeOf(o[n])==="Array"){var t;(t=o[n]).push.apply(t,J(s[n]))}}else c.typeOf(o[n])===c.typeOf(s[n])&&o[n]!==null&&c.typeOf(o[n])==="Object"&&!(s[n]instanceof window.Node)?c.deepMerge(o[n],s[n]):s[n]!==null&&(o[n]=s[n])}),o};c.getBgImage=function(o){var s=(o.currentStyle||window.getComputedStyle(o,null)).backgroundImage;if(!s||s==="none")return"";var n=document.createElement("a");return n.href=s.replace(/url\("|"\)/g,""),n.href};c.copyDom=function(o){if(o&&o.nodeType===1){var s=document.createElement(o.tagName);return Array.prototype.forEach.call(o.attributes,function(n){s.setAttribute(n.name,n.value)}),o.innerHTML&&(s.innerHTML=o.innerHTML),s}else return""};c.setInterval=function(o,s,n,t){o._interval[s]||(o._interval[s]=window.setInterval(n.bind(o),t))};c.clearInterval=function(o,s){clearInterval(o._interval[s]),o._interval[s]=null};c.setTimeout=function(o,s,n){o._timers||(o._timers=[]);var t=setTimeout(function(){s(),c.clearTimeout(o,t)},n);return o._timers.push(t),t};c.clearTimeout=function(o,s){var n=o._timers;if(c.typeOf(n)==="Array"){for(var t=0;t<n.length;t++)if(n[t]===s){n.splice(t,1),clearTimeout(s);break}}else clearTimeout(s)};c.clearAllTimers=function(o){var s=o._timers;c.typeOf(s)==="Array"&&(s.map(function(n){clearTimeout(n)}),o._timerIds=[])};c.createImgBtn=function(o,s,n,t){var e=c.createDom("xg-".concat(o),"",{},"xgplayer-".concat(o,"-img"));if(e.style.backgroundImage='url("'.concat(s,'")'),n&&t){var i,r,a;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(u){return n.indexOf(u)>-1&&t.indexOf(u)>-1?(i=parseFloat(n.slice(0,n.indexOf(u)).trim()),r=parseFloat(t.slice(0,t.indexOf(u)).trim()),a=u,!1):!0}),e.style.width="".concat(i).concat(a),e.style.height="".concat(r).concat(a),e.style.backgroundSize="".concat(i).concat(a," ").concat(r).concat(a),o==="start"?e.style.margin="-".concat(r/2).concat(a," auto auto -").concat(i/2).concat(a):e.style.margin="auto 5px auto 5px"}return e};c.Hex2RGBA=function(o,s){var n=[];if(/^\#[0-9A-F]{3}$/i.test(o)){var t="#";o.replace(/[0-9A-F]/ig,function(e){t+=e+e}),o=t}return/^#[0-9A-F]{6}$/i.test(o)?(o.replace(/[0-9A-F]{2}/ig,function(e){n.push(parseInt(e,16))}),"rgba(".concat(n.join(","),", ").concat(s,")")):"rgba(255, 255, 255, 0.1)"};c.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};c.checkIsFunction=function(o){return o&&typeof o=="function"};c.checkIsObject=function(o){return o!==null&&G(o)==="object"};c.hide=function(o){o.style.display="none"};c.show=function(o,s){o.style.display=s||"block"};c.isUndefined=function(o){if(typeof o>"u"||o===null)return!0};c.isNotNull=function(o){return o!=null};c.setStyleFromCsstext=function(o,s){if(s)if(c.typeOf(s)==="String"){var n=s.replace(/\s+/g,"").split(";");n.map(function(t){if(t){var e=t.split(":");e.length>1&&(o.style[e[0]]=e[1])}})}else Object.keys(s).map(function(t){o.style[t]=s[t]})};function Ht(o,s){for(var n=0,t=s.length;n<t;n++)if(o.indexOf(s[n])>-1)return!0;return!1}c.filterStyleFromText=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],n=o.style.cssText;if(!n)return{};var t=n.replace(/\s+/g,"").split(";"),e={},i={};return t.map(function(r){if(r){var a=r.split(":");a.length>1&&(Ht(a[0],s)?e[a[0]]=a[1]:i[a[0]]=a[1])}}),o.setAttribute("style",""),Object.keys(i).map(function(r){o.style[r]=i[r]}),e};c.getStyleFromCsstext=function(o){var s=o.style.cssText;if(!s)return{};var n=s.replace(/\s+/g,"").split(";"),t={};return n.map(function(e){if(e){var i=e.split(":");i.length>1&&(t[i[0]]=i[1])}}),t};c.preloadImg=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(o){var t=new window.Image;t.onload=function(e){t=null,s&&s(e)},t.onerror=function(e){t=null,n&&n(e)},t.src=o}};c.stopPropagation=function(o){o&&o.stopPropagation()};c.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0};c.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0};c.checkTouchSupport=function(){return"ontouchstart"in window};c.getBuffered2=function(o){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,n=[],t=0;t<o.length;t++)n.push({start:o.start(t)<.5?0:o.start(t),end:o.end(t)});n.sort(function(u,l){var f=u.start-l.start;return f||l.end-u.end});var e=[];if(s)for(var i=0;i<n.length;i++){var r=e.length;if(r){var a=e[r-1].end;n[i].start-a<s?n[i].end>a&&(e[r-1].end=n[i].end):e.push(n[i])}else e.push(n[i])}else e=n;return new Mt(e)};c.getEventPos=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return o.touches&&o.touches.length>0&&(o=o.touches[0]),{x:o.x/s,y:o.y/s,clientX:o.clientX/s,clientY:o.clientY/s,offsetX:o.offsetX/s,offsetY:o.offsetY/s,pageX:o.pageX/s,pageY:o.pageY/s}};c.requestAnimationFrame=function(o){var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(s)return s(o)};c.getHostFromUrl=function(o){if(c.typeOf(o)!=="String")return"";var s=o.split("/"),n="";return s.length>3&&s[2]&&(n=s[2]),n};c.cancelAnimationFrame=function(o){var s=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;s&&s(o)};c.isMSE=function(o){return o.media&&(o=o.media),!o||!(o instanceof HTMLMediaElement)?!1:/^blob/.test(o.currentSrc)||/^blob/.test(o.src)};c.isBlob=function(o){return typeof o=="string"&&/^blob/.test(o)};c.generateSessionId=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=new Date().getTime();try{o=parseInt(o)}catch(t){o=0}s+=o,window.performance&&typeof window.performance.now=="function"&&(s+=parseInt(window.performance.now()));var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(t==="x"?e:e&3|8).toString(16)});return n};c.createEvent=function(o){var s;return typeof window.Event=="function"?s=new Event(o):(s=document.createEvent("Event"),s.initEvent(o,!0,!0)),s};c.adjustTimeByDuration=function(o,s,n){return!s||!o?o:o>s||n&&o<s?s:o};c.createPositionBar=function(o,s){var n=c.createDom("xg-bar","",{"data-index":-1},o);return s.appendChild(n),n};c.getTransformStyle=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{x:0,y:0,scale:1,rotate:0},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n={scale:"".concat(o.scale||1),translate:"".concat(o.x||0,"%, ").concat(o.y||0,"%"),rotate:"".concat(o.rotate||0,"deg")},t=Object.keys(n);return t.forEach(function(e){var i=new RegExp("".concat(e,"\\([^\\(]+\\)"),"g"),r="".concat(e,"(").concat(n[e],")");i.test(s)?(i.lastIndex=-1,s=s.replace(i,r)):s+="".concat(r," ")}),s};c.convertDeg=function(o){return Math.abs(o)<=1?o*360:o%360};c.getIndexByTime=function(o,s){var n=s.length,t=-1;if(n<1)return t;if(o<=s[0].end||n<2)t=0;else if(o>s[n-1].end)t=n-1;else for(var e=1;e<n;e++)if(o>s[e-1].end&&o<=s[e].end){t=e;break}return t};c.getOffsetCurrentTime=function(o,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,t=-1;if(n>=0&&n<s.length?t=n:t=c.getIndexByTime(o,s),t<0)return-1;var e=s.length,i=s[t],r=i.start,a=i.end,u=i.cTime,l=i.offset;return o<r?u:o>=r&&o<=a?o-l:o>a&&t>=e-1?a:-1};c.getCurrentTimeByOffset=function(o,s){var n=-1;if(!s||s.length<0)return o;for(var t=0;t<s.length;t++)if(o<=s[t].duration){n=t;break}if(n!==-1){var e=s[n].start;return n-1<0?e+o:e+(o-s[n-1].duration)}return o};function ht(o){var s=G(o);return o!==null&&(s==="object"||s==="function")}function Bt(o,s,n){var t,e,i,r,a,u,l=0,f=!1,h=!1,d=!0,g=!s&&s!==0&&typeof window.requestAnimationFrame=="function";if(typeof o!="function")throw new TypeError("Expected a function");s=+s||0,ht(n)&&(f=!!n.leading,h="maxWait"in n,i=h?Math.max(+n.maxWait||0,s):i,d="trailing"in n?!!n.trailing:d);function v(A){var V=t,Y=e;return t=e=void 0,l=A,r=o.apply(Y,V),r}function y(A,V){return g?(window.cancelAnimationFrame(a),window.requestAnimationFrame(A)):setTimeout(A,V)}function m(A){if(g)return window.cancelAnimationFrame(A);clearTimeout(A)}function T(A){return l=A,a=y(L,s),f?v(A):r}function k(A){var V=A-u,Y=A-l,ne=s-V;return h?Math.min(ne,i-Y):ne}function E(A){var V=A-u,Y=A-l;return u===void 0||V>=s||V<0||h&&Y>=i}function L(){var A=Date.now();if(E(A))return R(A);a=y(L,k(A))}function R(A){return a=void 0,d&&t?v(A):(t=e=void 0,r)}function j(){a!==void 0&&m(a),l=0,t=u=e=a=void 0}function N(){return a===void 0?r:R(Date.now())}function At(){return a!==void 0}function ae(){for(var A=Date.now(),V=E(A),Y=arguments.length,ne=new Array(Y),ue=0;ue<Y;ue++)ne[ue]=arguments[ue];if(t=ne,e=this,u=A,V){if(a===void 0)return T(u);if(h)return a=y(L,s),v(u)}return a===void 0&&(a=y(L,s)),r}return ae.cancel=j,ae.flush=N,ae.pending=At,ae}function Ut(o,s,n){var t=!0,e=!0;if(typeof o!="function")throw new TypeError("Expected a function");return ht(n)&&(t="leading"in n?!!n.leading:t,e="trailing"in n?!!n.trailing:e),Bt(o,s,{leading:t,trailing:e,maxWait:s})}function Gt(){var o=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase();return o==="zh-cn"&&(o="zh"),o}function jt(o,s,n){if(o){var t=o.getAttribute(n);return!!(t&&t===s&&(o.tagName==="VIDEO"||o.tagName==="AUDIO"))}}var Be={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},Vt=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],I={get device(){var o=I.os;return o.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var o=navigator.userAgent.toLowerCase(),s={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(s).filter(function(n){return s[n].test(o)}))[0]},get os(){if(typeof navigator>"u")return{};var o=navigator.userAgent,s=/(?:Windows Phone)/.test(o),n=/(?:SymbianOS)/.test(o)||s,t=/(?:Android)/.test(o),e=/(?:Firefox)/.test(o),i=/(?:iPad|PlayBook)/.test(o)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,r=i||t&&!/(?:Mobile)/.test(o)||e&&/(?:Tablet)/.test(o),a=/(?:iPhone)/.test(o)&&!r,u=!a&&!t&&!n&&!r;return{isTablet:r,isPhone:a,isIpad:i,isIos:a||i,isAndroid:t,isPc:u,isSymbian:n,isWindowsPhone:s,isFireFox:e}},get osVersion(){if(typeof navigator>"u")return 0;var o=navigator.userAgent,s="";/(?:iPhone)|(?:iPad|PlayBook)/.test(o)?s=Be.ios:s=Be.android;var n=s?s.exec(o):[];if(n&&n.length>=3){var t=n[2].split(".");return t.length>0?parseInt(t[0]):0}return 0},get isWeixin(){if(typeof navigator>"u")return!1;var o=/(micromessenger)\/([\d.]+)/,s=o.exec(navigator.userAgent.toLocaleLowerCase());return!!s},isSupportMP4:function(){var s={isSupport:!1,mime:""};if(typeof document>"u")return s;if(this.supportResult)return this.supportResult;var n=document.createElement("video");return typeof n.canPlayType=="function"&&Vt.map(function(t){n.canPlayType('video/mp4; codecs="'.concat(t,'"'))==="probably"&&(s.isSupport=!0,s.mime+="||".concat(t))}),this.supportResult=s,n=null,s},isMSESupport:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(typeof MediaSource>"u"||!MediaSource)return!1;try{return MediaSource.isTypeSupported(s)}catch(n){return this._logger.error(s,n),!1}},isHevcSupported:function(){return typeof MediaSource>"u"||!MediaSource.isTypeSupported?!1:MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"')},probeConfigSupported:function(s){var n={supported:!1,smooth:!1,powerEfficient:!1};if(!s||typeof navigator>"u")return Promise.resolve(n);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(s);var t=s.video||{},e=s.audio||{};try{var i=MediaSource.isTypeSupported(t.contentType),r=MediaSource.isTypeSupported(e.contentType);return Promise.resolve({supported:i&&r,smooth:!1,powerEfficient:!1})}catch(a){return Promise.resolve(n)}}},Oe="3.0.19",Ue={1:"media",2:"media",3:"media",4:"media",5:"media",6:"media"},Ge={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},xe=x(function o(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};O(this,o);var t=s&&s.i18n?s.i18n.ERROR_TYPES:null;if(s.media){var e=n.mediaError?n.mediaError:s.media.error||{},i=s.duration,r=s.currentTime,a=s.ended,u=s.src,l=s.currentSrc,f=s.media,h=f.readyState,d=f.networkState,g=n.errorCode||e.code;Ge[g]&&(g=Ge[g]);var v={playerVersion:Oe,currentTime:r,duration:i,ended:a,readyState:h,networkState:d,src:u||l,errorType:n.errorType,errorCode:g,message:n.errorMessage||e.message,mediaError:e,originError:n.originError?n.originError.stack:"",host:c.getHostFromUrl(u||l)};return n.ext&&Object.keys(n.ext).map(function(k){v[k]=n.ext[k]}),v}else if(arguments.length>1){for(var y={playerVersion:Oe,domain:document.domain},m=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],T=0;T<arguments.length;T++)y[m[T]]=arguments[T];return y.ex=t?(t[arguments[0]]||{}).msg:"",y}}),de="play",Re="ended",dt="pause",Le="error",ee="seeked",gt="timeupdate",zt="waiting",re="canplay",ye="durationchange",je="loadeddata",Wt="progress",De="emptied",Yt="focus",Xt="blur",vt="ready",Kt="urlNull",he="autoplay_started",pt="autoplay_was_prevented",$t="complete",qt="replay",Zt="destroy",Qt="urlchange",Jt="leaveplayer",ei="enterplayer",ti="loading",Z="fullscreen_change",Ve="cssFullscreen_change",ii="mini_state_change",ni="definition_change",ze="after_definition_change",mt="video_resize",ri="playnext",We="user_action",yt="reset",si="source_error",oi="source_success",ai=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","loadedmetadata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode"];function Ce(o,s){!this||!this.emit||(o==="error"?this.errorHandler(o,s.error):this.emit(o,s))}function ui(o,s){return function(n,t){var e={player:s,eventName:o,originalEvent:n,detail:n.detail||{},timeStamp:n.timeStamp,currentTime:s.currentTime,duration:s.duration,paused:s.paused,ended:s.ended,isInternalOp:!!s._internalOp[n.type],muted:s.muted,volume:s.volume,host:c.getHostFromUrl(s.currentSrc),vtype:s.vtype};if(s.removeInnerOP(n.type),o==="timeupdate"&&(s._currentTime=s.media&&s.media.currentTime),o==="ratechange"){var i=s.media?s.media.playbackRate:0;if(i&&s._rate===i)return;s._rate=s.media&&s.media.playbackRate}if(o==="durationchange"&&(s._duration=s.media.duration),o==="volumechange"&&(e.isMutedChange=s._lastMuted!==s.muted,s._lastMuted=s.muted),o==="error"&&(e.error=t||s.video.error),s.mediaEventMiddleware[o]){var r=Ce.bind(s,o,e);try{s.mediaEventMiddleware[o].call(s,e,r)}catch(a){throw Ce.call(s,o,e),a}}else Ce.call(s,o,e)}}var li=function(o){F(n,o);var s=M(n);function n(t){var e;O(this,n),e=s.call(this,t),e._hasStart=!1,e._currentTime=0,e._duration=0,e._internalOp={},e._lastMuted=!1,e.vtype="MP4",e._rate=-1,e.mediaConfig=Object.assign({},{controls:!1,autoplay:t.autoplay,playsinline:t.playsinline,"x5-playsinline":t.playsinline,"webkit-playsinline":t.playsinline,"x5-video-player-fullscreen":t["x5-video-player-fullscreen"]||t.x5VideoPlayerFullscreen,"x5-video-orientation":t["x5-video-orientation"]||t.x5VideoOrientation,airplay:t.airplay,"webkit-airplay":t.airplay,tabindex:t.tabindex|0,mediaType:t.mediaType||"video","data-index":-1},t.videoConfig,t.videoAttributes);var i=t["x5-video-player-type"]||t.x5VideoPlayerType;return I.isWeixin&&I.os.isAndroid&&i&&(e.mediaConfig["x5-video-player-type"]=i,delete e.mediaConfig.playsinline,delete e.mediaConfig["webkit-playsinline"],delete e.mediaConfig["x5-playsinline"]),t.loop&&(e.mediaConfig.loop="loop"),t.autoplayMuted&&!Object.prototype.hasOwnProperty.call(e.mediaConfig,"muted")&&(e.mediaConfig.muted=!0),e.media=c.createDom(e.mediaConfig.mediaType,"",e.mediaConfig,""),t.defaultPlaybackRate&&(e.media.defaultPlaybackRate=e.media.playbackRate=t.defaultPlaybackRate),c.typeOf(t.volume)==="Number"&&(e.volume=t.volume),t.autoplayMuted&&(e.media.muted=!0,e._lastMuted=!0),t.autoplay&&(e.media.autoplay=!0),e._interval={},e.mediaEventMiddleware={},e.attachVideoEvents(),e}return x(n,[{key:"setEventsMiddleware",value:function(e){var i=this;Object.keys(e).map(function(r){i.mediaEventMiddleware[r]=e[r]})}},{key:"removeEventsMiddleware",value:function(e){var i=this;Object.keys(e).map(function(r){delete i.mediaEventMiddleware[r]})}},{key:"attachVideoEvents",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=ai.map(function(r){var a="on".concat(r.charAt(0).toUpperCase()).concat(r.slice(1));return typeof e[a]=="function"&&e.on(r,e[a]),C({},r,ui(r,e))})),this._evHandlers.forEach(function(r){var a=Object.keys(r)[0];i.addEventListener(a,r[a],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(r){var a=Object.keys(r)[0];i.removeEventListener(a,r[a],!1)}),this._evHandlers.forEach(function(r){var a=Object.keys(r)[0],u="on".concat(a.charAt(0).toUpperCase()).concat(a.slice(1));typeof e[u]=="function"&&e.off(a,e[u])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,i){var r=this;e.removeAttribute("src"),e.load(),i.forEach(function(h,d){r.media.appendChild(c.createDom("source","",{src:"".concat(h.src),type:"".concat(h.type||""),"data-index":d+1}))});var a=e.children;if(a){this._videoSourceCount=a.length,this._videoSourceIndex=a.length,this._vLoadeddata=function(h){r.emit(oi,{src:h.target.currentSrc,host:c.getHostFromUrl(h.target.currentSrc)})};for(var u=null,l=0;l<this._evHandlers.length;l++)if(Object.keys(this._evHandlers[l])[0]==="error"){u=this._evHandlers[l];break}!this._sourceError&&(this._sourceError=function(h){var d=parseInt(h.target.getAttribute("data-index"),10);if(r._videoSourceIndex--,r._videoSourceIndex===0||d>=r._videoSourceCount){var g={code:4,message:"sources_load_error"};u?u.error(h,g):r.errorHandler("error",g)}var v=Ue[4];r.emit(si,new xe(r,{errorType:v,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:h.target.src}))});for(var f=0;f<a.length;f++)a[f].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var i=e.children;if(!(!i||i.length===0||!this._sourceError)){for(var r=0;r<i.length;r++)i[r].removeEventListener("error",this._sourceError);for(;i.length>0;)e.removeChild(i[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||i)){var r=this.media.error||i,a=r.code?Ue[r.code]:"other",u=r.message;this.media.currentSrc||(u="empty_src",r={code:6,message:u}),this.emit(e,new xe(this,{errorType:a,errorCode:r.code,errorMessage:r.message||"",mediaError:r}))}}},{key:"destroy",value:function(){this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null;for(var e in this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){var e=this.media?this.media.play():null;return e}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return this.media?this.media.canPlayType(e):!1}},{key:"getBufferedRange",value:function(e){var i=[0,0];if(!this.media)return i;e||(e=this.media.buffered);var r=this.media.currentTime;if(e)for(var a=0,u=e.length;a<u&&(i[0]=e.start(a),i[1]=e.end(a),!(i[0]<=r&&r<=i[1]));a++);return i[0]-r<=0&&r-i[1]<=0?i:[0,0]}},{key:"autoplay",get:function(){return this.media?this.media.autoplay:!1},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?c.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var i=this.media.buffered;if(!i||i.length===0)return e;for(var r=0;r<i.length;r++)if((i.start(r)<=this.currentTime||i.start(r)<.1)&&i.end(r)>=this.currentTime)return{start:i.start(r),end:i.end(r)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return this.media?this.media.defaultMuted:!1},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return this.media?this.media.ended:!1}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){var e=this.media.error;if(!e)return"";var i=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];return i[this.media.error.code-1]}},{key:"loop",get:function(){return this.media?this.media.loop:!1},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return this.media?this.media.muted:!1},set:function(e){!this.media||this.media.muted===e||(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return this.media?this.media.paused:!0}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){!this.media||e===1/0||(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return this.media?this.media.preload:!1},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return this.media?this.media.seekable:!1}},{key:"seeking",get:function(){return this.media?this.media.seeking:!1}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){if(this.media){if(this.emit(Qt,e),this.emit(zt),this._currentTime=0,this._duration=0,c.isMSE(this.media)){this.onWaiting();return}this._detachSourceEvents(this.media),c.typeOf(e)==="Array"?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()}}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e===1/0||!this.media||(this.media.volume=e)}},{key:"aspectRatio",get:function(){return this.media?this.media.videoWidth/this.media.videoHeight:0}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,i){for(var r,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(r=w(S(n.prototype),"emit",this)).call.apply(r,[this,e,i].concat(u))}},{key:"on",value:function(e,i){for(var r,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(r=w(S(n.prototype),"on",this)).call.apply(r,[this,e,i].concat(u))}},{key:"once",value:function(e,i){for(var r,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(r=w(S(n.prototype),"once",this)).call.apply(r,[this,e,i].concat(u))}},{key:"off",value:function(e,i){for(var r,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(r=w(S(n.prototype),"off",this)).call.apply(r,[this,e,i].concat(u))}},{key:"offAll",value:function(){w(S(n.prototype),"removeAllListeners",this).call(this)}}]),n}(Dt),ci=function(){function o(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};O(this,o),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=s}return x(o,[{key:"openDB",value:function(n){var t=this,e=this,i=this.myDB.version||1,r=e.indexedDB.open(e.myDB.name,i);r.onerror=function(a){},r.onsuccess=function(a){t.myDB.db=a.target.result,n.call(e)},r.onupgradeneeded=function(a){var u=a.target.result;a.target.transaction,u.objectStoreNames.contains(e.myDB.ojstore.name)||u.createObjectStore(e.myDB.ojstore.name,{keyPath:e.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){var n=this;n.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(n,t){for(var e=this.myDB.db.transaction(n,"readwrite").objectStore(n),i,r=0;r<t.length;r++)i=e.add(t[r]),i.onerror=function(){},i.onsuccess=function(){}}},{key:"putData",value:function(n,t){for(var e=this.myDB.db.transaction(n,"readwrite").objectStore(n),i,r=0;r<t.length;r++)i=e.put(t[r]),i.onerror=function(){},i.onsuccess=function(){}}},{key:"getDataByKey",value:function(n,t,e){var i=this,r=this.myDB.db.transaction(n,"readwrite").objectStore(n),a=r.get(t);a.onerror=function(){e.call(i,null)},a.onsuccess=function(u){var l=u.target.result;e.call(i,l)}}},{key:"deleteData",value:function(n,t){var e=this.myDB.db.transaction(n,"readwrite").objectStore(n);e.delete(t)}},{key:"clearData",value:function(n){var t=this.myDB.db.transaction(n,"readwrite").objectStore(n);t.clear()}}]),o}(),Ye=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],Xe=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],Ke=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],Q="data-xgplayerid";function le(o,s,n){for(var t=arguments.length,e=new Array(t>3?t-3:0),i=3;i<t;i++)e[i-3]=arguments[i];var r=s.call.apply(s,[o].concat(e));!n||typeof n!="function"||(r&&r.then?r.then(function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];n.call.apply(n,[o].concat(u))}):n.call.apply(n,[o].concat(e)))}function ge(o,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[o]&&(this.__hooks[o]=null),(function(){var t=arguments,e=this;if(n.pre)try{var i;(i=n.pre).call.apply(i,[this].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(o,":pre error] >> ").concat(u.message),u}if(this.__hooks&&this.__hooks[o])try{var r,a=(r=this.__hooks[o]).call.apply(r,[this,this].concat(Array.prototype.slice.call(arguments)));a?a.then?a.then(function(u){u!==!1&&le.apply(void 0,[e,s,n.next].concat(J(t)))}).catch(function(u){throw u}):le.apply(void 0,[this,s,n.next].concat(Array.prototype.slice.call(arguments))):a===void 0&&le.apply(void 0,[this,s,n.next].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(o,"] >> ").concat(u.message),u}else le.apply(void 0,[this,s,n.next].concat(Array.prototype.slice.call(arguments)))}).bind(this)}function ve(o,s){var n=this.__hooks;if(n)return n.hasOwnProperty(o)?(n&&(n[o]=s),!0):(console.warn("has no supported hook which name [".concat(o,"]")),!1)}function pe(o,s){var n=this.__hooks;n&&delete n[o]}function $e(o){if(!(!this.plugins||!this.plugins[o.toLowerCase()])){for(var s=this.plugins[o.toLowerCase()],n=arguments.length,t=new Array(n>1?n-1:0),e=1;e<n;e++)t[e-1]=arguments[e];return s.useHooks&&s.useHooks.apply(s,t)}}function qe(o){if(!(!this.plugins||!this.plugins[o.toLowerCase()])){var s=this.plugins[o.toLowerCase()];if(s){for(var n=arguments.length,t=new Array(n>1?n-1:0),e=1;e<n;e++)t[e-1]=arguments[e];return s.removeHooks&&s.removeHooks.apply(s,t)}}}function _t(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];o.__hooks={},s&&s.map(function(n){o.__hooks[n]=null}),Object.defineProperty(o,"hooks",{get:function(){return o.__hooks&&Object.keys(o.__hooks).map(function(t){if(o.__hooks[t])return t})}})}function Et(o){o.__hooks=null}function W(o,s,n){for(var t=arguments.length,e=new Array(t>3?t-3:0),i=3;i<t;i++)e[i-3]=arguments[i];if(o.__hooks&&o.__hooks[s]){var r,a=(r=o.__hooks[s]).call.apply(r,[o,o].concat(e));if(a&&a.then)a.then(function(u){return u===!1?null:n.call.apply(n,[o,o].concat(e))}).catch(function(u){console.warn("[runHooks]".concat(s," reject"),u.message)});else if(a!==!1)return n.call.apply(n,[o,o].concat(e))}else return n.call.apply(n,[o,o].concat(e))}function Te(o,s){P.logError("[".concat(o,"] event or callback cant be undefined or null when call ").concat(s))}var me=function(){function o(s){O(this,o),c.checkIsFunction(this.beforeCreate)&&this.beforeCreate(s),_t(this),this.__args=s,this.__events={},this.__onceEvents={},this.config=s.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(s)}return x(o,[{key:"beforeCreate",value:function(n){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(n){this.player=n.player,this.playerConfig=n.player&&n.player.config,this.pluginName=n.pluginName?n.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=n.player&&n.player.logger}},{key:"updateLang",value:function(n){n||(n=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var n=c.checkTouchSupport()?"touch":"mouse";return this.playerConfig&&(this.playerConfig.domEventType==="touch"||this.playerConfig.domEventType==="mouse")&&(n=this.playerConfig.domEventType),n}},{key:"on",value:function(n,t){var e=this;if(!n||!t||!this.player){Te(this.pluginName,"plugin.on(event, callback)");return}typeof n=="string"?(this.__events[n]=t,this.player.on(n,t)):Array.isArray(n)&&n.forEach(function(i){e.__events[i]=t,e.player.on(i,t)})}},{key:"once",value:function(n,t){var e=this;if(!n||!t||!this.player){Te(this.pluginName,"plugin.once(event, callback)");return}typeof n=="string"?(this.__onceEvents[n]=t,this.player.once(n,t)):Array.isArray(n)&&n.forEach(function(i){e.__onceEvents[i]=t,e.player.once(n,t)})}},{key:"off",value:function(n,t){var e=this;if(!n||!t||!this.player){Te(this.pluginName,"plugin.off(event, callback)");return}typeof n=="string"?(delete this.__events[n],this.player.off(n,t)):Array.isArray(n)&&n.forEach(function(i){delete e.__events[n],e.player.off(i,t)})}},{key:"offAll",value:function(){var n=this;["__events","__onceEvents"].forEach(function(t){Object.keys(n[t]).forEach(function(e){n[t][e]&&n.off(e,n[t][e]),e&&delete n[t][e]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(n){var t;if(this.player){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];(t=this.player).emit.apply(t,[n].concat(i))}}},{key:"emitUserAction",value:function(n,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.player){var i=$($({},e),{},{pluginName:this.pluginName});this.player.emitUserAction(n,t,i)}}},{key:"hook",value:function(n,t){return ge.call.apply(ge,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(n,t){for(var e=arguments.length,i=new Array(e>2?e-2:0),r=2;r<e;r++)i[r-2]=arguments[r];return ve.call.apply(ve,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(n,t){for(var e=arguments.length,i=new Array(e>2?e-2:0),r=2;r<e;r++)i[r-2]=arguments[r];return pe.call.apply(pe,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(this.player)return e&&(t.pluginName=e),this.player.registerPlugin({plugin:n,options:t})}},{key:"getPlugin",value:function(n){return this.player?this.player.getPlugin(n):null}},{key:"__destroy",value:function(){var n=this,t=this.player,e=this.pluginName;this.offAll(),c.clearAllTimers(this),c.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(i){n[i]=null}),t.unRegisterPlugin(e),Et(this)}}],[{key:"defineGetterOrSetter",value:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&Object.defineProperty(n,e,t[e])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}]),o}(),fi=9;if(typeof Element<"u"&&!Element.prototype.matches){var te=Element.prototype;te.matches=te.matchesSelector||te.mozMatchesSelector||te.msMatchesSelector||te.oMatchesSelector||te.webkitMatchesSelector}function hi(o,s){for(;o&&o.nodeType!==fi;){if(typeof o.matches=="function"&&o.matches(s))return o;o=o.parentNode}}var di=hi,gi=di;function ke(o,s,n,t,e){var i=pi.apply(this,arguments);return o.addEventListener(n,i,e),{destroy:function(){o.removeEventListener(n,i,e)}}}function vi(o,s,n,t,e){return typeof o.addEventListener=="function"?ke.apply(null,arguments):typeof n=="function"?ke.bind(null,document).apply(null,arguments):(typeof o=="string"&&(o=document.querySelectorAll(o)),Array.prototype.map.call(o,function(i){return ke(i,s,n,t,e)}))}function pi(o,s,n,t){return function(e){e.delegateTarget=gi(e.target,s),e.delegateTarget&&t.call(o,e)}}var mi=vi;const Ze=at(mi);var yi={CONTROLS:"controls",ROOT:"root"},U={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},Qe={ICON_DISABLE:"xg-icon-disable",ICON_HIDE:"xg-icon-hide"};function be(o){return o?o.indexOf&&/^(?:http|data:|\/)/.test(o):!1}function _i(o,s){return G(o)==="object"&&o.class&&typeof o.class=="string"?"".concat(s," ").concat(o.class):s}function Ei(o,s){return G(o)==="object"&&o.attr&&G(o.attr)==="object"&&Object.keys(o.attr).map(function(n){s[n]=o.attr[n]}),s}function Je(o,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},e=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",i=null;if(o instanceof window.Element)return c.addClass(o,n),Object.keys(t).map(function(r){o.setAttribute(r,t[r])}),o;if(be(o)||be(o.url))return t.src=be(o)?o:o.url||"",i=c.createDom(o.tag||"img","",t,"xg-img ".concat(n)),i;if(typeof o=="function")try{return i=o(),i instanceof window.Element?(c.addClass(i,n),Object.keys(t).map(function(r){i.setAttribute(r,t[r])}),i):(P.logWarn("warn>>icons.".concat(s," in config of plugin named [").concat(e,"] is a function mast return an Element Object")),null)}catch(r){return P.logError("Plugin named [".concat(e,"]:createIcon"),r),null}return typeof o=="string"?c.createDomFromHtml(o,t,n):(P.logWarn("warn>>icons.".concat(s," in config of plugin named [").concat(e,"] is invalid")),null)}function Ci(o,s){var n=s.config.icons||s.playerConfig.icons;Object.keys(o).map(function(t){var e=o[t],i=e&&e.class?e.class:"",r=e&&e.attr?e.attr:{},a=null;n&&n[t]&&(i=_i(n[t],i),r=Ei(n[t],r),a=Je(n[t],t,i,r,s.pluginName)),!a&&e&&(a=Je(e.icon?e.icon:e,r,i,{},s.pluginName)),s.icons[t]=a})}function Ti(o,s){Object.keys(o).map(function(n){Object.defineProperty(s.langText,n,{get:function(){var e=s.lang,i=s.i18n;return i[n]?i[n]:o[n]&&o[n][e]||""}})})}var q=function(o){F(n,o);var s=M(n);function n(){var t,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return O(this,n),t=s.call(this,e),t.__delegates=[],t}return x(n,[{key:"__init",value:function(e){if(w(S(n.prototype),"__init",this).call(this,e),!!e.root){var i=e.root,r=null;this.icons={},this.root=null,this.parent=null;var a=this.registerIcons()||{};Ci(a,this),this.langText={};var u=this.registerLanguageTexts()||{};Ti(u,this);var l="";try{l=this.render()}catch(d){throw P.logError("Plugin:".concat(this.pluginName,":render"),d),new Error("Plugin:".concat(this.pluginName,":render:").concat(d.message))}if(l)r=n.insert(l,i,e.index),r.setAttribute("data-index",e.index);else if(e.tag)r=c.createDom(e.tag,"",e.attr,e.name),r.setAttribute("data-index",e.index),i.appendChild(r);else return;this.root=r,this.parent=i;var f=this.config.attr||{},h=this.config.style||{};this.setAttr(f),this.setStyle(h),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var i=this.children();i&&G(i)==="object"&&Object.keys(i).length>0&&Object.keys(i).map(function(r){var a=r,u=i[a],l={root:e.root},f,h;typeof u=="function"?(f=e.config[a]||{},h=u):G(u)==="object"&&typeof u.plugin=="function"&&(f=u.options?c.deepCopy(e.config[a]||{},u.options):e.config[a]||{},h=u.plugin),l.config=f,f.index!==void 0&&(l.index=f.index),f.root&&(l.root=f.root),e.registerPlugin(h,l,a)})}}},{key:"updateLang",value:function(e){e||(e=this.lang);function i(l,f){for(var h=0;h<l.children.length;h++)l.children[h].children.length>0?i(l.children[h],f):f(l.children[h])}var r=this.root,a=this.i18n,u=this.langText;r&&i(r,function(l){var f=l.getAttribute&&l.getAttribute("lang-key");if(f){var h=a[f.toUpperCase()]||u[f];h&&(l.innerHTML=typeof h=="function"?h(e):h)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=this.i18n||{},a=this.langText;e.setAttribute&&e.setAttribute("lang-key",i);var u=r[i]||a[i]||"";u&&(e.innerHTML=u)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,c.addClass(this.find(".xgplayer-icon"),Qe.ICON_DISABLE)}},{key:"enable",value:function(){this.config.disable=!1,c.removeClass(this.find(".xgplayer-icon"),Qe.ICON_DISABLE)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";i.root=i.root||this.root;var a=w(S(n.prototype),"registerPlugin",this).call(this,e,i,r);return this._children.push(a),a}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,i,r){var a=this;if(arguments.length<3&&typeof i=="function")Array.isArray(e)?e.forEach(function(l){a.bindEL(l,i)}):this.bindEL(e,i);else{var u=n.delegate.call(this,this.root,e,i,r);this.__delegates=this.__delegates.concat(u)}}},{key:"unbind",value:function(e,i){var r=this;if(arguments.length<3&&typeof i=="function")Array.isArray(e)?e.forEach(function(l){r.unbindEL(l,i)}):this.unbindEL(e,i);else for(var a="".concat(e,"_").concat(i),u=0;u<this.__delegates.length;u++)if(this.__delegates[u].key===a){this.__delegates[u].destroy(),this.__delegates.splice(u,1);break}}},{key:"setStyle",value:function(e,i){var r=this;if(this.root){if(c.typeOf(e)==="String")return this.root.style[e]=i;c.typeOf(e)==="Object"&&Object.keys(e).map(function(a){r.root.style[a]=e[a]})}}},{key:"setAttr",value:function(e,i){var r=this;if(this.root){if(c.typeOf(e)==="String")return this.root.setAttribute(e,i);c.typeOf(e)==="Object"&&Object.keys(e).map(function(a){r.root.setAttribute(a,e[a])})}}},{key:"setHtml",value:function(e,i){this.root&&(this.root.innerHTML=e,typeof i=="function"&&i())}},{key:"bindEL",value:function(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof i=="function"&&this.root.addEventListener(e,i,r)}},{key:"unbindEL",value:function(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof i=="function"&&this.root.removeEventListener(e,i,r)}},{key:"show",value:function(e){if(this.root){this.root.style.display=e!==void 0?e:"block";var i=window.getComputedStyle(this.root,null),r=i.getPropertyValue("display");if(r==="none")return this.root.style.display="block"}}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,i){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!i||!(i instanceof window.Element))return null;try{return typeof e=="string"?this.find(e).appendChild(i):e.appendChild(i)}catch(r){return P.logError("Plugin:appendChild",r),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,i=this.player;this.__delegates.map(function(r){r.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(r){i.unRegisterPlugin(r.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),w(S(n.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(r){e[r]=null})}}],[{key:"insert",value:function(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=i.children.length,u=Number(r),l=e instanceof window.Node;if(a){for(var f=0,h=null,d="";f<a;f++){h=i.children[f];var g=Number(h.getAttribute("data-index"));if(g>=u){d="beforebegin";break}else g<u&&(d="afterend")}return l?d==="afterend"?i.appendChild(e):i.insertBefore(e,h):h.insertAdjacentHTML(d,e),d==="afterend"?i.children[i.children.length-1]:i.children[f]}else return l?i.appendChild(e):i.insertAdjacentHTML("beforeend",e),i.children[i.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,i,r,a){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=[];if(e instanceof window.Node&&typeof a=="function")if(Array.isArray(r))r.forEach(function(h){var d=Ze(e,i,h,a,u);d.key="".concat(i,"_").concat(h),l.push(d)});else{var f=Ze(e,i,r,a,u);f.key="".concat(i,"_").concat(r),l.push(f)}return l}},{key:"ROOT_TYPES",get:function(){return yi}},{key:"POSITIONS",get:function(){return U}}]),n}(me),ki=function(){function o(){var s=this;if(O(this,o),C(this,"__trigger",function(n){var t=new Date().getTime();s.timeStamp=t;for(var e=0;e<n.length;e++)s.__runHandler(n[e].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(Ut(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(n){console.error(n)}}return x(o,[{key:"addObserver",value:function(n,t){if(this.observer){this.observer&&this.observer.observe(n);for(var e=n.getAttribute(Q),i=this.__handlers,r=-1,a=0;a<i.length;a++)i[a]&&n===i[a].target&&(r=a);r>-1?this.__handlers[r].handler=t:this.__handlers.push({target:n,handler:t,playerId:e})}}},{key:"unObserver",value:function(n){var t=-1;this.__handlers.map(function(e,i){n===e.target&&(t=i)});try{this.observer&&this.observer.unobserve(n)}catch(e){}this.observer&&this.observer.unobserve(n),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(n){for(var t=this.__handlers,e=0;e<t.length;e++)if(t[e]&&n===t[e].target){try{t[e].handler(n)}catch(i){console.error(i)}return!0}return!1}}]),o}(),se=null;function bi(o,s){return se||(se=new ki),se.addObserver(o,s),se}function Si(o,s){se.unObserver(o,s)}var D={pluginGroup:{},init:function(s){var n=s._pluginInfoId;n||(n=new Date().getTime(),s._pluginInfoId=n),!s.config.closeResizeObserver&&bi(s.root,function(){s.resize()}),this.pluginGroup[n]={_originalOptions:s.config||{},_plugins:{}}},formatPluginInfo:function(s,n){var t=null,e=null;return s.plugin&&typeof s.plugin=="function"?(t=s.plugin,e=s.options):(t=s,e={}),n&&(e.config=n||{}),{PLUFGIN:t,options:e}},checkPluginIfExits:function(s,n){for(var t=0;t<n.length;t++)if(s.toLowerCase()===n[t].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(s,n){for(var t=Object.keys(n),e=null,i=0;i<t.length;i++)if(s.toLowerCase()===t[i].toLowerCase()){e=n[t[i]];break}return c.typeOf(e)==="Object"?{root:e.root,position:e.position}:{}},lazyRegister:function(s,n){var t=this,e=n.timeout||1500;return Promise.race([n.loader().then(function(i){var r;i&&i.__esModule?r=i.default:r=i,t.register(s,r,i.options)}),new Promise(function(i,r){setTimeout(function(){r(new Error("timeout"))},e)})])},register:function(s,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!s||!n||typeof n!="function"||n.prototype===void 0)){var e=s._pluginInfoId;if(!(!e||!this.pluginGroup[e])){this.pluginGroup[e]._plugins||(this.pluginGroup[e]._plugins={});var i=this.pluginGroup[e]._plugins,r=this.pluginGroup[e]._originalOptions;t.player=s;var a=t.pluginName||n.pluginName;if(!a)throw new Error("The property pluginName is necessary");if(n.isSupported&&!n.isSupported(s.config.mediaType,s.config.codecType)){console.warn("not supported plugin [".concat(a,"]"));return}t.config||(t.config={});for(var u=Object.keys(r),l=0;l<u.length;l++)if(a.toLowerCase()===u[l].toLowerCase()){var f=r[u[l]];c.typeOf(f)==="Object"?t.config=Object.assign({},t.config,r[u[l]]):c.typeOf(f)==="Boolean"&&(t.config.disable=!f);break}n.defaultConfig&&Object.keys(n.defaultConfig).forEach(function(d){typeof t.config[d]>"u"&&(t.config[d]=n.defaultConfig[d])}),t.root?typeof t.root=="string"&&(t.root=s[t.root]):t.root=s.root,t.index=t.config.index||0;try{i[a.toLowerCase()]&&(this.unRegister(e,a.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(a,"] exist, destroy the old instance")));var h=new n(t);return i[a.toLowerCase()]=h,i[a.toLowerCase()].func=n,h&&typeof h.afterCreate=="function"&&h.afterCreate(),h}catch(d){throw console.error(d),d}}}},unRegister:function(s,n){s._pluginInfoId&&(s=s._pluginInfoId),n=n.toLowerCase();try{var t=this.pluginGroup[s]._plugins[n];t&&(t.pluginName&&t.__destroy(),delete this.pluginGroup[s]._plugins[n])}catch(e){console.error("[unRegister:".concat(n,"] cgid:[").concat(s,"] error"),e)}},deletePlugin:function(s,n){var t=s._pluginInfoId;t&&this.pluginGroup[t]&&this.pluginGroup[t]._plugins&&delete this.pluginGroup[t]._plugins[n]},getPlugins:function(s){var n=s._pluginInfoId;return n&&this.pluginGroup[n]?this.pluginGroup[n]._plugins:{}},findPlugin:function(s,n){var t=s._pluginInfoId;if(!t||!this.pluginGroup[t])return null;var e=n.toLowerCase();return this.pluginGroup[t]._plugins[e]},beforeInit:function(s){var n=this;function t(e){return!e||!e.then?new Promise(function(i){i()}):e}return new Promise(function(e){if(n.pluginGroup){var i;return s._loadingPlugins&&s._loadingPlugins.length?i=Promise.all(s._loadingPlugins):i=Promise.resolve(),i.then(function(){var r=s._pluginInfoId;if(!n.pluginGroup[r]){e();return}var a=n.pluginGroup[r]._plugins,u=[];Object.keys(a).forEach(function(l){if(a[l]&&a[l].beforePlayerInit)try{var f=a[l].beforePlayerInit();u.push(t(f))}catch(h){throw u.push(t(null)),h}}),Promise.all([].concat(u)).then(function(){e()}).catch(function(l){console.error(l),e()})})}})},afterInit:function(s){var n=s._pluginInfoId;if(!(!n||!this.pluginGroup[n])){var t=this.pluginGroup[n]._plugins;Object.keys(t).forEach(function(e){t[e]&&t[e].afterPlayerInit&&t[e].afterPlayerInit()})}},setLang:function(s,n){var t=n._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=this.pluginGroup[t]._plugins;Object.keys(e).forEach(function(i){if(e[i].updateLang)e[i].updateLang(s);else try{e[i].lang=s}catch(r){console.warn("".concat(i," setLang"))}})}},reRender:function(s){var n=this,t=s._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=[],i=this.pluginGroup[t]._plugins;Object.keys(i).forEach(function(r){r!=="controls"&&i[r]&&(e.push({plugin:i[r].func,options:i[r].__args}),n.unRegister(t,r))}),e.forEach(function(r){n.register(s,r.plugin,r.options)})}},onPluginsReady:function(s){var n=s._pluginInfoId;if(!(!n||!this.pluginGroup[n])){var t=this.pluginGroup[n]._plugins||{};Object.keys(t).forEach(function(e){t[e].onPluginsReady&&typeof t[e].onPluginsReady=="function"&&t[e].onPluginsReady()})}},destroy:function(s){var n=s._pluginInfoId;if(this.pluginGroup[n]){Si(s.root);for(var t=this.pluginGroup[n]._plugins,e=0,i=Object.keys(t);e<i.length;e++){var r=i[e];this.unRegister(n,r)}delete this.pluginGroup[n],delete s._pluginInfoId}}},p={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function et(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:Gt(),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var Ai=function(s,n){var t,e,i;n.preset&&n.options?i=new n.preset(n.options,s.config):i=new n({},s.config);var r=i,a=r.plugins,u=a===void 0?[]:a,l=r.ignores,f=l===void 0?[]:l,h=r.icons,d=h===void 0?{}:h,g=r.i18n,v=g===void 0?[]:g;s.config.plugins||(s.config.plugins=[]),s.config.ignores||(s.config.ignores=[]),(t=s.config.plugins).push.apply(t,J(u)),(e=s.config.ignores).push.apply(e,J(f)),Object.keys(d).map(function(m){s.config.icons[m]||(s.config.icons[m]=d[m])});var y=s.config.i18n||[];v.push.apply(v,J(y)),s.config.i18n=v},Pi=function(o){F(n,o);var s=M(n);function n(){var t;O(this,n);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t=s.call.apply(s,[this].concat(i)),C(_(t),"onMouseEnter",function(a){var u=_(t),l=u.player,f=u.playerConfig;f.closeControlsBlur&&l.focus({autoHide:!1})}),C(_(t),"onMouseLeave",function(a){var u=_(t),l=u.player;l.focus()}),t}return x(n,[{key:"beforeCreate",value:function(e){!e.config.mode&&I.device==="mobile"&&(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,i=this.config,r=i.disable,a=i.height,u=i.mode;if(!r){u==="flex"&&this.player.addClass(p.FLEX_CONTROLS);var l={height:"".concat(a,"px")};Object.keys(l).map(function(h){e.root.style[h]=l[h]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(ii,function(h){h?c.addClass(e.root,"mini-controls"):c.removeClass(e.root,"mini-controls")});var f=this.playerConfig.isMobileSimulateMode;I.device!=="mobile"&&f!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&c.addClass(this.root,p.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){c.removeClass(this.root,p.CONTROLS_AUTOHIDE)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(this.root){var a=e.defaultConfig||{};if(!i.root){var u=i.position?i.position:i.config&&i.config.position?i.config.position:a.position;switch(u){case U.CONTROLS_LEFT:i.root=this.left;break;case U.CONTROLS_RIGHT:i.root=this.right;break;case U.CONTROLS_CENTER:i.root=this.center;break;case U.CONTROLS:i.root=this.root;break;default:i.root=this.left}return w(S(n.prototype),"registerPlugin",this).call(this,e,i,r)}}}},{key:"destroy",value:function(){I.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,i=e.mode,r=e.autoHide,a=e.initShow,u=e.disable;if(!u){var l=c.classNames({"xgplayer-controls":!0},{"flex-controls":i==="flex"},{"bottom-controls":i==="bottom"},C({},p.CONTROLS_AUTOHIDE,r),{"xgplayer-controls-initshow":a||!r});return'<xg-controls class="'.concat(l,'" unselectable="on">\n    <xg-inner-controls class="xg-inner-controls xg-pos">\n      <xg-left-grid class="xg-left-grid">\n      </xg-left-grid>\n      <xg-center-grid class="xg-center-grid"></xg-center-grid>\n      <xg-right-grid class="xg-right-grid">\n      </xg-right-grid>\n    </xg-inner-controls>\n    </xg-controls>')}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),n}(q),wi={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},B={lang:{},langKeys:[],textKeys:[]};function oe(o,s){return Object.keys(s).forEach(function(n){var t=c.typeOf(s[n]),e=c.typeOf(o[n]);if(t==="Array"){var i;e!=="Array"&&(o[n]=[]),(i=o[n]).push.apply(i,J(s[n]))}else t==="Object"?(e!=="Object"&&(o[n]={}),oe(o[n],s[n])):o[n]=s[n]}),o}function Ct(){Object.keys(B.lang.en).map(function(o){B.textKeys[o]=o})}function Ii(o,s){var n=[];if(s||(s=B),!!s.lang){c.typeOf(o)!=="Array"?n=Object.keys(o).map(function(i){var r=i==="zh"?"zh-cn":i;return{LANG:r,TEXT:o[i]}}):n=o;var t=s,e=t.lang;n.map(function(i){i.LANG==="zh"&&(i.LANG="zh-cn"),e[i.LANG]?oe(e[i.LANG]||{},i.TEXT||{}):Ne(i,s)}),Ct()}}function Ne(o,s){var n=o.LANG;if(s||(s=B),!!s.lang){var t=o.TEXT||{};n==="zh"&&(n="zh-cn"),s.lang[n]?oe(s.lang[n],t):(s.langKeys.push(n),s.lang[n]=t),Ct()}}function Oi(o){var s,n={lang:{},langKeys:[],textKeys:{},pId:o};return oe(n.lang,B.lang),(s=n.langKeys).push.apply(s,J(B.langKeys)),oe(n.textKeys,B.textKeys),n}Ne(wi);var ce={get textKeys(){return B.textKeys},get langKeys(){return B.langKeys},get lang(){var o={};return B.langKeys.map(function(s){o[s]=B.lang[s]}),B.lang["zh-cn"]&&(o.zh=B.lang["zh-cn"]||{}),o},extend:Ii,use:Ne,init:Oi},b={INITIAL:1,READY:2,ATTACHING:3,ATTACHED:4,NOTALLOW:5,RUNNING:6,ENDED:7,DESTROYED:8},tt=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],H={},Se=null,xi=function(o){F(n,o);var s=M(n);function n(){return O(this,n),s.apply(this,arguments)}return x(n,[{key:"add",value:function(e){e&&(H[e.playerId]=e,Object.keys(H).length===1&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete H[e.playerId])}},{key:"_iterate",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(var r in H)if(Object.prototype.hasOwnProperty.call(H,r)){var a=H[r];if(i){if(e(a))break}else e(a)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var i=null;return this._iterate(function(r){var a=e(r);return a&&(i=r),a},!0),i}},{key:"findAll",value:function(e){var i=[];return this._iterate(function(r){e(r)&&i.push(r)}),i}},{key:"setActive",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(H[e])return i?this.forEach(function(r){e===r.playerId?(r.isUserActive=!0,r.isInstNext=!1):r.isUserActive=!1}):H[e].isUserActive=i,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(H),i=0;i<e.length;i++){var r=H[e[i]];if(r&&r.isUserActive)return e[i]}return null}},{key:"setNext",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(H[e])return i?this.forEach(function(r){e===r.playerId?(r.isUserActive=!1,r.isInstNext=!0):r.isInstNext=!1}):H[e].isInstNext=i,e}}],[{key:"getInstance",value:function(){return Se||(Se=new n),Se}}]),n}(ft.EventEmitter);function Ri(o){for(var s=Object.keys(H),n=0;n<s.length;n++){var t=H[s[n]];if(t.root===o)return t}return null}var Li=["play","pause","replay","retry"],it=0,nt=0,X=null,Fe=function(o){F(n,o);var s=M(n);function n(t){var e;O(this,n);var i=c.deepMerge(et(),t);e=s.call(this,i),C(_(e),"canPlayFunc",function(){if(e.config){var v=e.config,y=v.autoplay,m=v.defaultPlaybackRate;P.logInfo("player","canPlayFunc, startTime",e.__startTime),e._seekToStartTime(),e.playbackRate=m,(y||e._useAutoplay)&&e.mediaPlay(),e.off(re,e.canPlayFunc),e.removeClass(p.ENTER)}}),C(_(e),"onFullscreenChange",function(v,y){var m=function(){c.setTimeout(_(e),function(){e.resize()},100)},T=c.getFullScreenEl();e._fullActionFrom?e._fullActionFrom="":e.emit(We,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:e.currentTime,duration:e.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var k=jt(T,e.playerId,Q);if(y||T&&(T===e._fullscreenEl||k))m(),!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!0,e.changeFullStyle(e.root,T,p.FULLSCREEN),e.emit(Z,!0,e._fullScreenOffset),e.cssfullscreen&&e.exitCssFullscreen();else if(e.fullscreen){m();var E=_(e),L=E._fullScreenOffset,R=E.config;if(R.needFullscreenScroll?(window.scrollTo(L.left,L.top),c.setTimeout(_(e),function(){e.fullscreen=!1,e._fullScreenOffset=null},100)):(!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!1,e._fullScreenOffset=null),e.cssfullscreen)e.removeClass(p.FULLSCREEN);else{var j=e._fullscreenEl;!j&&(e.root.contains(v.target)||v.target===e.root)&&(j=v.target),e.recoverFullStyle(e.root,j,p.FULLSCREEN)}e._fullscreenEl=null,e.emit(Z,!1)}}),C(_(e),"_onWebkitbeginfullscreen",function(v){e._fullscreenEl=e.media,e.onFullscreenChange(v,!0)}),C(_(e),"_onWebkitendfullscreen",function(v){e.onFullscreenChange(v,!1)}),_t(_(e),Li),e.config=i,e._pluginInfoId=c.generateSessionId(),Ft(_(e));var r=e.constructor.defaultPreset;if(e.config.presets.length){var a=e.config.presets.indexOf("default");a>=0&&r&&(e.config.presets[a]=r)}else r&&e.config.presets.push(r);e.userTimer=null,e.waitTimer=null,e.handleSource=!0,e._state=b.INITIAL,e.isError=!1,e._hasStart=!1,e.isSeeking=!1,e.isCanplay=!1,e._useAutoplay=!1,e.__startTime=-1,e.rotateDeg=0,e.isActive=!1,e.fullscreen=!1,e.cssfullscreen=!1,e.isRotateFullscreen=!1,e._fullscreenEl=null,e.timeSegments=[],e._cssfullscreenEl=null,e.curDefinition=null,e._orgCss="",e._fullScreenOffset=null,e._videoHeight=0,e._videoWidth=0,e.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},e.sizeInfo={width:0,height:0,left:0,top:0},e._accPlayed={t:0,acc:0,loopAcc:0},e._offsetInfo={currentTime:-1,duration:0},e.innerContainer=null,e.controls=null,e.topBar=null,e.root=null,e.__i18n=ce.init(e._pluginInfoId),I.os.isAndroid&&I.osVersion>0&&I.osVersion<6&&(e.config.autoplay=!1),e.database=new ci,e.isUserActive=!1,e._onceSeekCanplay=null,e._isPauseBeforeSeek=0,e.innerStates={isActiveLocked:!1},e.instManager=X;var u=e._initDOM();if(!u)return console.error(new Error("can't find the dom which id is ".concat(e.config.id," or this.config.el does not exist"))),ut(e);var l=e.config,f=l.definition,h=f===void 0?{}:f,d=l.url;if(!d&&h.list&&h.list.length>0){var g=h.list.find(function(v){return v.definition&&v.definition===h.defaultDefinition});g||(h.defaultDefinition=h.list[0].definition,g=h.list[0]),e.config.url=g.url,e.curDefinition=g}return e._bindEvents(),e._registerPresets(),e._registerPlugins(),D.onPluginsReady(_(e)),e.getInitDefinition(),e.setState(b.READY),c.setTimeout(_(e),function(){e.emit(vt)},0),e.onReady&&e.onReady(),(e.config.videoInit||e.config.autoplay)&&(!e.hasStart||e.state<b.ATTACHED)&&e.start(),e}return x(n,[{key:"_initDOM",value:function(){var e,i=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var r=this.config.el;if(r&&r.nodeType===1)this.root=r;else return this.emit(Le,new xe("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1}var a=Ri(this.root);a&&(P.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),a.destroy()),this.root.setAttribute(Q,this.playerId),(e=X)===null||e===void 0||e.add(this),D.init(this),this._initBaseDoms();var u=this.constructor.XgVideoProxy;if(u&&this.mediaConfig.mediaType===u.mediaType){var l=this.innerContainer||this.root;this.detachVideoEvents(this.media);var f=new u(l,this.config,this.mediaConfig);this.attachVideoEvents(f),this.media=f}if(this.media.setAttribute(Q,this.playerId),this.config.controls){var h=this.config.controls.root||null,d=D.register(this,Pi,{root:h});this.controls=d}var g=this.config.isMobileSimulateMode==="mobile"?"mobile":I.device;if(this.addClass("".concat(p.DEFAULT," ").concat(p.INACTIVE," xgplayer-").concat(g," ").concat(this.config.controls?"":p.NO_CONTROLS)),this.config.autoplay?this.addClass(p.ENTER):this.addClass(p.NO_START),this.config.fluid){var v=this.config,y=v.width,m=v.height;(typeof y!="number"||typeof m!="number")&&(y=600,m=337.5);var T={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(m*100/y,"%")};Object.keys(T).forEach(function(N){i.root.style[N]=T[N]})}else["width","height"].forEach(function(N){i.config[N]&&(typeof i.config[N]!="number"?i.root.style[N]=i.config[N]:i.root.style[N]="".concat(i.config[N],"px"))});var k=this.root.getBoundingClientRect(),E=k.width,L=k.height,R=k.left,j=k.top;return this.sizeInfo.width=E,this.sizeInfo.height=L,this.sizeInfo.left=R,this.sizeInfo.top=j,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=c.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(i){e.on(i,e["on"+i.charAt(0).toUpperCase()+i.slice(1)])}),Ye.forEach(function(i){document&&document.addEventListener(i,e.onFullscreenChange)}),I.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(je,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(de,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),Ye.forEach(function(i){document.removeEventListener(i,e.onFullscreenChange)}),this.playFunc&&this.off(de,this.playFunc),this.off(re,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_clearUserTimer",value:function(){this.userTimer&&(c.clearTimeout(this,this.userTimer),this.userTimer=null)}},{key:"_startInit",value:function(e){var i=this;if(this.media&&!((!e||e===""||c.typeOf(e)==="Array"&&e.length===0)&&(e="",this.emit(Kt),P.logWarn("config.url is null, please get url and run player._startInit(url)"),this.config.nullUrlStart))){this.handleSource&&(this._detachSourceEvents(this.media),c.typeOf(e)==="Array"&&e.length>0?this._attachSourceEvents(this.media,e):!this.media.src||this.media.src!==e?this.media.src=e:e||this.media.removeAttribute("src")),c.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var r=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!r.contains(this.media)&&r.insertBefore(this.media,r.firstChild);var a=this.media.readyState;P.logInfo("_startInit readyState",a),this.config.autoplay&&(!c.isMSE(this.media)&&this.load(),(I.os.isIpad||I.os.isPhone)&&this.mediaPlay());var u=this.config.startTime;this.__startTime=u>0?u:-1,this.config.startTime=0,a>=2&&this.duration>0?this.canPlayFunc():this.on(re,this.canPlayFunc),(!this.hasStart||this.state<b.ATTACHED)&&D.afterInit(this),this.hasStart=!0,this.setState(b.ATTACHED),c.setTimeout(this,function(){i.emit($t)},0)}}},{key:"_registerPlugins",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._loadingPlugins=[];var r=this.config.ignores||[],a=this.config.plugins||[],u=this.config.i18n||[];i&&ce.extend(u,this.__i18n);var l=r.join("||").toLowerCase().split("||"),f=this.plugins;a.forEach(function(h){try{var d=h.plugin?h.plugin.pluginName:h.pluginName;if(d&&l.indexOf(d.toLowerCase())>-1)return null;if(!i&&f[d.toLowerCase()])return;if(h.lazy&&h.loader){var g=D.lazyRegister(e,h);h.forceBeforeInit&&(g.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(g),1)}).catch(function(v){P.logError("_registerPlugins:loadingPlugin",v),e._loadingPlugins.splice(e._loadingPlugins.indexOf(g),1)}),e._loadingPlugins.push(g));return}return e.registerPlugin(h)}catch(v){P.logError("_registerPlugins:",v)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(i){Ai(e,i)})}},{key:"_getRootByPosition",value:function(e){var i=null;switch(e){case U.ROOT_RIGHT:this.rightBar||(this.rightBar=c.createPositionBar("xg-right-bar",this.root)),i=this.rightBar;break;case U.ROOT_LEFT:this.leftBar||(this.leftBar=c.createPositionBar("xg-left-bar",this.root)),i=this.leftBar;break;case U.ROOT_TOP:this.topBar||(this.topBar=c.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&c.addClass(this.topBar,p.TOP_BAR_AUTOHIDE)),i=this.topBar;break;default:i=this.innerContainer||this.root;break}return i}},{key:"registerPlugin",value:function(e,i){var r=D.formatPluginInfo(e,i),a=r.PLUFGIN,u=r.options,l=this.config.plugins,f=D.checkPluginIfExits(a.pluginName,l);!f&&l.push(a);var h=D.getRootByConfig(a.pluginName,this.config);h.root&&(u.root=h.root),h.position&&(u.position=h.position);var d=u.position?u.position:u.config&&u.config.position||a.defaultConfig&&a.defaultConfig.position;return!u.root&&typeof d=="string"&&d.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(a,u,a.pluginName):(u.root||(u.root=this._getRootByPosition(d)),D.register(this,a,u))}},{key:"deregister",value:function(e){typeof e=="string"?D.unRegister(this,e):e instanceof me&&D.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.deregister(e),i&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var i;if(typeof e=="string"?i=e:e instanceof me&&(i=e.pluginName),!!i)for(var r=this.config.plugins.length-1;r>-1;r--){var a=this.config.plugins[r];if(a.pluginName.toLowerCase()===i.toLowerCase()){this.config.plugins.splice(r,1);break}}}},{key:"plugins",get:function(){return D.getPlugins(this)}},{key:"getPlugin",value:function(e){var i=D.findPlugin(this,e);return i&&i.pluginName?i:null}},{key:"addClass",value:function(e){this.root&&(c.hasClass(this.root,e)||c.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&c.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return c.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,i){this.root&&this.root.setAttribute(e,i)}},{key:"removeAttribute",value:function(e,i){this.root&&this.root.removeAttribute(e,i)}},{key:"start",value:function(e){var i=this;if(!(this.state>b.ATTACHING))return!e&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this.setState(b.ATTACHING),this._registerPlugins(!1),D.beforeInit(this).then(function(){if(i.config){e||(e=i.url||i.config.url);var r=i._preProcessUrl(e),a=i._startInit(r.url);return a}}).catch(function(r){throw r.fileName="player",r.lineNumber="236",P.logError("start:beforeInit:",r),r})}},{key:"switchURL",value:function(e,i){var r=this,a=e;c.typeOf(e)==="Object"&&(a=e.url),a=this._preProcessUrl(a).url;var u=this.currentTime;this.__startTime=u;var l=this.paused&&!this.isError;return this.src=a,new Promise(function(f,h){var d=function(y){r.off("timeupdate",g),r.off("canplay",g),h(y)},g=function(){r._seekToStartTime(),l&&r.pause(),r.off("error",d),f(!0)};if(r.once("error",d),!a){r.errorHandler("error",{code:6,message:"empty_src"});return}I.os.isAndroid?r.once("timeupdate",g):r.once("canplay",g),r.play()})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<b.ATTACHED){this.removeClass(p.NO_START),this.addClass(p.ENTER),this.start(),this._useAutoplay=!0;return}this.state<b.RUNNING&&(this.removeClass(p.NO_START),!this.isCanplay&&this.addClass(p.ENTER));var i=w(S(n.prototype),"play",this).call(this);return i!==void 0&&i&&i.then?i.then(function(){e.removeClass(p.NOT_ALLOW_AUTOPLAY),e.addClass(p.PLAYING),e.state<b.RUNNING&&(P.logInfo(">>>>playPromise.then"),e.setState(b.RUNNING),e.emit(he))}).catch(function(r){if(P.logWarn(">>>>playPromise.catch",r.name),e.media&&e.media.error){e.onError(),e.removeClass(p.ENTER);return}r.name==="NotAllowedError"&&(e._errorTimer=c.setTimeout(e,function(){e._errorTimer=null,e.emit(pt),e.addClass(p.NOT_ALLOW_AUTOPLAY),e.removeClass(p.ENTER),e.pause(),e.setState(b.NOTALLOW)},0))}):(P.logWarn("video.play not return promise"),this.state<b.RUNNING&&(this.setState(b.RUNNING),this.removeClass(p.NOT_ALLOW_AUTOPLAY),this.removeClass(p.NO_START),this.removeClass(p.ENTER),this.addClass(p.PLAYING),this.emit(he))),i}},{key:"mediaPause",value:function(){w(S(n.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){w(S(n.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this.removeClass(p.PAUSED),W(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;W(this,"pause",function(){w(S(n.prototype),"pause",e).call(e)})}},{key:"seek",value:function(e,i){var r=this;if(!(!this.media||Number.isNaN(Number(e))||!this.hasStart)){var a=this.config,u=a.isSeekedPlay,l=a.seekedStatus,f=i||(u?"play":l);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(ee,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(r.removeClass(p.ENTER),r.isSeeking=!1,f){case"play":r.play();break;case"pause":r.pause();break;default:r._isPauseBeforeSeek>1||r.paused?r.pause():r.play()}r._isPauseBeforeSeek=0,r._onceSeekCanplay=null},this.once(ee,this._onceSeekCanplay),this.state<b.RUNNING?(this.removeClass(p.NO_START),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,i=this.config,r=i.definition,a=i.url;!a&&r&&r.list&&r.list.length>0&&r.defaultDefinition&&r.list.map(function(u){u.definition===r.defaultDefinition&&(e.config.url=u.url,e.curDefinition=u)})}},{key:"changeDefinition",value:function(e,i){var r=this,a=this.config.definition;if(Array.isArray(a==null?void 0:a.list)&&a.list.forEach(function(l){(e==null?void 0:e.definition)===l.definition&&(r.curDefinition=l)}),e!=null&&e.bitrate&&typeof e.bitrate!="number"&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit(ni,{from:i,to:e}),!this.hasStart){this.config.url=e.url;return}var u=this.switchURL(e.url,$({seamless:a.seamless!==!1&&typeof MediaSource<"u"&&typeof MediaSource.isTypeSupported=="function"},e));u&&u.then?u.then(function(){r.emit(ze,{from:i,to:e})}):this.emit(ze,{from:i,to:e})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(je,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,i=p.NOT_ALLOW_AUTOPLAY,r=p.PLAYING,a=p.NO_START,u=p.PAUSED,l=p.REPLAY,f=p.ENTER,h=p.ENDED,d=p.ERROR,g=p.LOADING,v=[i,r,a,u,l,f,h,d,g];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,v.forEach(function(y){e.removeClass(y)}),this.addClass(p.NO_START),this.emit(yt)}},{key:"reset",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;this.resetState();var a=this.plugins;if(a&&(i.map(function(l){e.deregister(l)}),r)){var u=et();Object.keys(this.config).keys(function(l){e.config[l]!=="undefined"&&(l==="plugins"||l==="presets"||l==="el"||l==="id")&&(e.config[l]=u[l])})}}},{key:"destroy",value:function(){var e,i=this,r=this.innerContainer,a=this.root,u=this.media;if(!(!a||!u)){if(this.hasStart=!1,this._useAutoplay=!1,a.removeAttribute(Q),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),c.clearAllTimers(this),this.emit(Zt),(e=X)===null||e===void 0||e.remove(this),D.destroy(this),Et(this),w(S(n.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),r)for(var l=r.children,f=0;f<l.length;f++)r.removeChild(l[f]);!r&&u instanceof window.Node&&a.contains(u)&&a.removeChild(u),["topBar","leftBar","rightBar","innerContainer"].map(function(d){i[d]&&a.removeChild(i[d]),i[d]=null});var h=a.className.split(" ");h.length>0?a.className=h.filter(function(d){return d.indexOf("xgplayer")<0}).join(" "):a.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(d){i[d]=!1})}}},{key:"replay",value:function(){var e=this;this.removeClass(p.ENDED),this.currentTime=0,this.isSeeking=!1,W(this,"replay",function(){e.once(ee,function(){var i=e.mediaPlay();i&&i.catch&&i.catch(function(r){console.log(r)})}),e.emit(qt),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass(p.ERROR),this.addClass(p.LOADING),W(this,"retry",function(){var i=e.currentTime,r=e.config.url,a=c.isMSE(e.media)?{url:r}:e._preProcessUrl(r);e.src=a.url,!e.config.isLive&&(e.currentTime=i),e.once(re,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,i,r,a){e&&(a||(a=p.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=c.filterStyleFromText(e)),c.addClass(e,r),i&&i!==e&&!this._orgPCss&&(this._orgPCss=c.filterStyleFromText(i),c.addClass(i,a),i.setAttribute(Q,this.playerId)))}},{key:"recoverFullStyle",value:function(e,i,r,a){a||(a=p.PARENT_FULLSCREEN),this._orgCss&&(c.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),c.removeClass(e,r),i&&i!==e&&this._orgPCss&&(c.setStyleFromCsstext(i,this._orgPCss),this._orgPCss="",c.removeClass(i,a),i.removeAttribute(Q))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,i=this.root,r=this.media;(e==="video"||e==="media")&&(e=this[e]),e||(e=i),this._fullScreenOffset={top:c.scrollTop(),left:c.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get";var a=c.getFullScreenEl();if(a===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var u=0;u<Xe.length;u++){var l=Xe[u];if(e[l]){var f=l==="webkitRequestFullscreen"?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[l]();return f&&f.then?f:Promise.resolve()}}return r.fullscreenEnabled||r.webkitSupportsFullscreen?(r.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch(h){return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),!(!this._fullscreenEl&&!c.getFullScreenEl())){this.root;var i=this.media;this._fullActionFrom="exit";try{for(var r=0;r<Ke.length;r++){var a=Ke[r];if(document[a]){var u=document[a]();return u&&u.then?u:Promise.resolve()}}return i&&i.webkitSupportsFullscreen?(i.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch(l){return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var i=e?"".concat(p.INNER_FULLSCREEN," ").concat(p.CSS_FULLSCREEN):p.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,i);var r=this.config.fullscreen,a=r===void 0?{}:r,u=a.useCssFullscreen===!0||typeof a.useCssFullscreen=="function"&&a.useCssFullscreen();u&&(this.fullscreen=!0,this.emit(Z,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(Ve,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(p.INNER_FULLSCREEN," ").concat(p.CSS_FULLSCREEN):p.CSS_FULLSCREEN;if(!this.fullscreen)this.recoverFullStyle(this.root,this._cssfullscreenEl,e);else{var i=this.config.fullscreen,r=i===void 0?{}:i,a=r.useCssFullscreen===!0||typeof r.useCssFullscreen=="function"&&r.useCssFullscreen();a?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(Z,!1)):this.removeClass(e)}this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(Ve,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var i=e?"".concat(p.INNER_FULLSCREEN," ").concat(p.ROTATE_FULLSCREEN):p.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,i,p.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style"),this.root.style.width="".concat(window.innerHeight,"px"),this.emit(Z,!0)}},{key:"exitRotateFullscreen",value:function(e){var i=this._fullscreenEl!==this.root?"".concat(p.INNER_FULLSCREEN," ").concat(p.ROTATE_FULLSCREEN):p.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,i,p.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(Z,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(e);return}this.emit(Yt,$({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(e);return}this._clearUserTimer(),this.emit(Xt,$({paused:this.paused,ended:this.ended},e))}},{key:"onFocus",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!0,delay:3e3},r=this.innerStates;if(this.isActive=!0,this.removeClass(p.INACTIVE),this._clearUserTimer(),i.isLock!==void 0&&(r.isActiveLocked=i.isLock),i.autoHide===!1||i.isLock===!0||r.isActiveLocked){this._clearUserTimer();return}var a=i&&i.delay?i.delay:this.config.inactive;this.userTimer=c.setTimeout(this,function(){e.userTimer=null,e.blur()},a)}},{key:"onBlur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=e.ignorePaused,r=i===void 0?!1:i;if(!this.innerStates.isActiveLocked){var a=this.config.closePauseVideoFocus;this.isActive=!1,(r||a||!this.paused&&!this.ended)&&this.addClass(p.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(p.ENTER),this.removeClass(p.ERROR),this.removeClass(p.LOADING),this.isCanplay=!0,this.waitTimer&&c.clearTimeout(this,this.waitTimer)}},{key:"onLoadeddata",value:function(){var e=this;this.isError=!1,this.isSeeking=!1,this.__startTime>0&&(this.duration>0?this._seekToStartTime():this.once(ye,function(){e._seekToStartTime()}))}},{key:"onLoadstart",value:function(){this.removeClass(p.ERROR),this.isCanplay=!1}},{key:"onPlay",value:function(){this.state===b.ENDED&&this.setState(b.RUNNING),this.removeClass(p.PAUSED),this.ended&&this.removeClass(p.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(p.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this._clearUserTimer(),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(p.ENDED),this.setState(b.ENDED)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(p.NOT_ALLOW_AUTOPLAY),this.removeClass(p.NO_START),this.removeClass(p.ENTER),this.removeClass(p.LOADING),this.addClass(p.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(p.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&c.clearTimeout(this,this.waitTimer),this.removeClass(p.LOADING),this.removeClass(p.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&c.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=c.setTimeout(this,function(){e.addClass(p.LOADING),e.emit(ti),c.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1;var i=p.NO_START,r=p.PAUSED,a=p.ENDED,u=p.ERROR,l=p.REPLAY,f=p.LOADING,h=[i,r,a,u,l,f];h.forEach(function(d){e.removeClass(d)}),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass(p.LOADING))&&this.media.readyState>2&&(this.removeClass(p.LOADING),c.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state===b.NOTALLOW&&this.duration&&(this.setState(b.RUNNING),this.emit(he)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){c.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,i,r){if(!(!this.media||!i||!e)){var a=c.typeOf(e)==="String"?e:e.type||"";r.props&&c.typeOf(r.props)!=="Array"&&(r.props=[r.props]),this.emit(We,$({eventType:a,action:i,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},r))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var i=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=i,this._accPlayed.t=0,(e==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{startDiff:0,endDiff:0},r=i||{},a=r.startDiff,u=a===void 0?0:a,l=r.endDiff,f=l===void 0?0:l,h=this.media.buffered;if(!h||h.length===0||!this.duration)return!0;for(var d=e||this.media.currentTime||.2,g=h.length,v=0;v<g;v++)if(h.start(v)+u<=d&&h.end(v)-f>d)return!0;return!1}},{key:"resizePosition",value:function(){var e=this.videoPos,i=e.vy,r=e.vx,a=e.h,u=e.w,l=this.videoPos.rotate;if(!(l<0&&a<0&&u<0)){var f=this.videoPos._pi;if(!f&&this.media.videoHeight&&(f=this.media.videoWidth/this.media.videoHeight*100),!!f){this.videoPos.pi=f,l=l<0?0:l;var h={rotate:l},d=0,g=0,v=1,y=Math.abs(l/90),m=this.root,T=this.innerContainer,k=m.offsetWidth,E=T?T.offsetHeight:m.offsetHeight,L=E,R=k;if(y%2===0)v=a>0?100/a:u>0?100/u:1,h.scale=v,d=i>0?(100-a)/2-i:0,h.y=y===2?0-d:d,g=r>0?(100-u)/2-r:0,h.x=y===2?0-g:g,this.media.style.width="".concat(R,"px"),this.media.style.height="".concat(L,"px");else if(y%2===1){R=E,L=k;var j=E-k;g=-j/2/R*100,h.x=y===3?g+i/2:g-i/2,d=j/2/L*100,h.y=y===3?d+r/2:d-r/2,h.scale=v,this.media.style.width="".concat(R,"px"),this.media.style.height="".concat(L,"px")}var N=c.getTransformStyle(h,this.media.style.transform||this.media.style.webkitTransform);this.media.style.transform=N,this.media.style.webkitTransform=N}}}},{key:"position",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(!(!this.media||!e||!e.h)){var i=this.videoPos;i.h=e.h*100||0,i.w=e.w*100||0,i.vx=e.x*100||0,i.vy=e.y*100||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var i=this;e&&Object.keys(e).map(function(r){if(r!=="plugins"){i.config[r]=e[r];var a=i.plugins[r.toLowerCase()];a&&c.typeOf(a.setConfig)==="Function"&&a.setConfig(e[r])}})}},{key:"playNext",value:function(e){var i=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,W(this,"playnext",function(){i.start(),i.emit(ri,e)})}},{key:"resize",value:function(){var e=this;if(this.media){var i=this.root.getBoundingClientRect();this.sizeInfo.width=i.width,this.sizeInfo.height=i.height,this.sizeInfo.left=i.left,this.sizeInfo.top=i.top;var r=this.media,a=r.videoWidth,u=r.videoHeight,l=this.config,f=l.fitVideoSize,h=l.videoFillMode;if((h==="fill"||h==="cover"||h==="contain")&&this.setAttribute("data-xgfill",h),!(!u||!a)){this._videoHeight=u,this._videoWidth=a;var d=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,g=i.width,v=i.height-d,y=parseInt(a/u*1e3,10),m=parseInt(g/v*1e3,10),T=g,k=v,E={};f==="auto"&&m>y||f==="fixWidth"?(k=g/y*1e3,this.config.fluid?E.paddingTop="".concat(k*100/T,"%"):E.height="".concat(k+d,"px")):(f==="auto"&&m<y||f==="fixHeight")&&(T=y*v/1e3,E.width="".concat(T,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(E).forEach(function(R){e.root.style[R]=E[R]}),(h==="fillHeight"&&m<y||h==="fillWidth"&&m>y)&&this.setAttribute("data-xgfill","cover");var L={videoScale:y,vWidth:T,vHeight:k,cWidth:T,cHeight:k+d};this.resizePosition(),this.emit(mt,L)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.media.updateObjectPosition){this.media.updateObjectPosition(e,i);return}this.media.style.objectPosition="".concat(e*100,"% ").concat(i*100,"%")}},{key:"setState",value:function(e){P.logInfo("setState","state from:".concat(tt[this.state]," to:").concat(tt[e])),this._state=e}},{key:"_preProcessUrl",value:function(e,i){var r=this.config,a=r.preProcessUrl,u=r.preProcessUrlOptions,l=Object.assign({},u,i);return!c.isBlob(e)&&typeof a=="function"?a(e,l):{url:e}}},{key:"_seekToStartTime",value:function(){this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime>this.duration?this.duration:this.__startTime,this.__startTime=-1)}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){typeof e=="boolean"&&(this._hasStart=e,e===!1&&this.setState(b.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===b.RUNNING||this._state===b.ENDED},set:function(e){e?this.setState(b.RUNNING):this._state>=b.RUNNING&&this.setState(b.ATTACHED)}},{key:"definitionList",get:function(){return!this.config||!this.config.definition?[]:this.config.definition.list||[]},set:function(e){var i=this,r=this.config.definition,a=null,u=null;r.list=e,this.emit("resourceReady",e),e.forEach(function(l){var f;((f=i.curDefinition)===null||f===void 0?void 0:f.definition)===l.definition&&(a=l),r.defaultDefinition===l.definition&&(u=l)}),!u&&e.length>0&&(u=e[0]),a?this.changeDefinition(a):u&&this.changeDefinition(u)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var i=this.media.getVideoPlaybackQuality();return e.dropped=i.droppedVideoFrames||0,e.total=i.totalVideoFrames||0,e.corrupted=i.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){var i=ce.langKeys.filter(function(r){return r===e});if(i.length===0&&e!=="zh"){console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(ce.langKeys.join(),"] "));return}this.config.lang=e,D.setLang(e,this)}},{key:"i18n",get:function(){var e=this.config.lang;return e==="zh"&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return Oe}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return w(S(n.prototype),"readyState",this)}},{key:"error",get:function(){var e=w(S(n.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){return w(S(n.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var e=this._accPlayed,i=e.acc,r=e.t;return r?new Date().getTime()-r+i:i}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){e=c.convertDeg(e),!(e%90!==0||e===this.videoPos.rotate)&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return nt},set:function(e){nt=e}},{key:"realTimeSpeed",get:function(){return it},set:function(e){it=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime||0},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration||0},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,i){return ge.call.apply(ge,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,i){return ve.call.apply(ve,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,i){return pe.call.apply(pe,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,i,r){for(var a=arguments.length,u=new Array(a>3?a-3:0),l=3;l<a;l++)u[l-3]=arguments[l];return $e.call.apply($e,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,i,r){for(var a=arguments.length,u=new Array(a>3?a-3:0),l=3;l<a;l++)u[l-3]=arguments[l];return qe.call.apply(qe,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,i){var r;typeof i=="boolean"&&i!==this.muted&&(this.addInnerOP("volumechange"),c.typeOf(i)===Boolean&&(this.muted=i)),(r=X)===null||r===void 0||r.setActive(this.playerId,e)}}],[{key:"debugger",get:function(){return P.config.debug},set:function(e){P.config.debug=e}},{key:"instManager",get:function(){return X},set:function(e){X=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return(e=X)===null||e===void 0?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,i){var r;(r=X)===null||r===void 0||r.setActive(e,i)}},{key:"isHevcSupported",value:function(){return I.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return I.probeConfigSupported(e)}},{key:"install",value:function(e,i){n.plugins||(n.plugins={}),n.plugins[e]||(n.plugins[e]=i)}},{key:"use",value:function(e,i){n.plugins||(n.plugins={}),n.plugins[e]=i}}]),n}(li);C(Fe,"defaultPreset",null);C(Fe,"XgVideoProxy",null);Fe.instManager=xi.getInstance();function Tt(){return new DOMParser().parseFromString('<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>\n</svg>\n',"image/svg+xml").firstChild}function kt(){return new DOMParser().parseFromString('<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>\n</svg>\n',"image/svg+xml").firstChild}var z={};function Di(o,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{start:null,end:null};return z[o]&&window.clearTimeout(z[o].id),z[o]={},n.start&&n.start(),z[o].id=window.setTimeout(function(){n.end&&n.end(),window.clearTimeout(z[o].id),delete z[o]},s),z[o].id}function rt(o){if(o){window.clearTimeout(o);return}Object.keys(z).map(function(s){window.clearTimeout(z[s].id),delete z[s]})}var Xi=function(o){F(n,o);var s=M(n);function n(t){var e;return O(this,n),e=s.call(this,t),C(_(e),"onPlayerReset",function(){e.autoPlayStart=!1;var i=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),c.removeClass(e.root,i),e.show()}),C(_(e),"onAutoplayStart",function(){if(!e.autoPlayStart){var i=e.config.mode==="auto"?"auto-hide":"hide";c.addClass(e.root,i),e.autoPlayStart=!0,e.onPlayPause("play")}}),e.autoPlayStart=!1,e}return x(n,[{key:"afterCreate",value:function(){var e=this,i=this.player,r=this.playerConfig;this.initIcons(),this.once(vt,function(){r&&(r.lang&&r.lang==="en"?c.addClass(i.root,"lang-is-en"):r.lang==="jp"&&c.addClass(i.root,"lang-is-jp"))}),this.on(he,this.onAutoplayStart),r.autoplay||this.show(),this.on(pt,function(){var a=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),c.removeClass(e.root,a),e.show()}),this.on(de,function(){e.onPlayPause("play")}),this.on(dt,function(){e.onPlayPause("pause")}),this.on(yt,function(){e.onPlayerReset()}),this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(u){u.cancelable&&u.preventDefault(),u.stopPropagation();var l=e.player.paused;e.emitUserAction(u,"switch_play_pause",{props:"paused",from:l,to:!l})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:Tt,class:"xg-icon-play"},startPause:{icon:kt,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild("xg-start-inner",e.startPlay),this.appendChild("xg-start-inner",e.startPause)}},{key:"hide",value:function(){c.addClass(this.root,"hide")}},{key:"show",value:function(e){c.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){c.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){c.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(e){e?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(e){var i=this;this._animateId=Di("pauseplay",400,{start:function(){c.addClass(i.root,"interact"),i.show(),i.switchStatus(!0)},end:function(){c.removeClass(i.root,"interact"),!e&&i.hide(),i._animateId=null}})}},{key:"endAnimate",value:function(){c.removeClass(this.root,"interact"),rt(this._animateId),this._animateId=null}},{key:"switchPausePlay",value:function(e){var i=this.player;if(e.cancelable&&e.preventDefault(),e.stopPropagation(),!(i.state<b.READY)){var r=this.player.paused;!r&&i.state===b.RUNNING?i.pause():i.play()}}},{key:"onPlayPause",value:function(e){var i=this.config,r=this.player;if(!(!r||r.state<b.RUNNING||!this.autoPlayStart)){if(i.mode==="show"){this.switchStatus(),this.show();return}if(i.mode==="auto"){this.switchStatus();return}if(i.isShowPause&&r.paused&&!r.ended||i.isShowEnd&&r.ended){this.switchStatus(),this.show(),this.endAnimate();return}if(i.disableAnimate){this.switchStatus(),this.hide();return}if(e==="play")this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||r.ended)return;this.animate()}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),rt(this._animateId)}},{key:"render",value:function(){var e=this.playerConfig.autoplay?this.config.mode==="auto"?"auto-hide":"hide":"";return'\n    <xg-start class="xgplayer-start '.concat(e,'">\n    <xg-start-inner></xg-start-inner>\n    </xg-start>')}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),n}(q);function bt(o,s,n){try{return' <div class="xg-tips '.concat(n?"hide":" ",'" lang-key="').concat(o.i18nKeys[s],'">\n    ').concat(o.i18n[s],"\n    </div>")}catch(t){return'<div class="xg-tips hide"></div>'}}var fe={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},Ae=["videoClick","videoDbClick"],Ki=function(o){F(n,o);var s=M(n);function n(){var t;O(this,n);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t=s.call.apply(s,[this].concat(i)),C(_(t),"onMouseMove",function(a){var u=_(t),l=u.player,f=u.playerConfig;l.isActive||(l.focus({autoHide:!f.closeDelayBlur}),!f.closeFocusVideoFocus&&l.media.focus())}),C(_(t),"onMouseEnter",function(a){var u=_(t),l=u.playerConfig,f=u.player;!l.closeFocusVideoFocus&&f.media.focus(),l.closeDelayBlur?f.focus({autoHide:!1}):f.focus(),t.emit(ei)}),C(_(t),"onMouseLeave",function(a){var u=t.playerConfig,l=u.closePlayerBlur,f=u.leavePlayerTime,h=u.closeDelayBlur;!l&&!h&&(f?t.player.focus({autoHide:!0,delay:f}):t.player.blur({ignorePaused:!0})),t.emit(Jt)}),C(_(t),"onVideoClick",function(a){var u=_(t),l=u.player,f=u.playerConfig;a.target&&f.closeVideoClick||(a.target===l.root||a.target===l.media||a.target===l.innerContainer||a.target===l.media.__canvas)&&(a.preventDefault(),f.closeVideoStopPropagation||a.stopPropagation(),t._clickCount++,t.clickTimer&&(clearTimeout(t.clickTimer),t.clickTimer=null),t.clickTimer=setTimeout(function(){t._clickCount&&(t._clickCount--,W(_(t),Ae[0],function(h,d){t.switchPlayPause(d.e)},{e:a,paused:l.paused}),clearTimeout(t.clickTimer),t.clickTimer=null)},300))}),C(_(t),"onVideoDblClick",function(a){var u=_(t),l=u.player,f=u.playerConfig;if(!(f.closeVideoDblclick||!a.target||a.target!==l.media&&a.target!==l.media.__canvas)){if(!f.closeVideoClick&&t._clickCount<2){t._clickCount=0;return}t._clickCount=0,t.clickTimer&&(clearTimeout(t.clickTimer),t.clickTimer=null),a.preventDefault(),a.stopPropagation(),W(_(t),Ae[1],function(h,d){t.emitUserAction(d.e,"switch_fullscreen",{props:"fullscreen",from:l.fullscreen,to:!l.fullscreen}),l.fullscreen?l.exitFullscreen():l.getFullscreen()},{e:a,fullscreen:l.fullscreen})}}),t}return x(n,[{key:"afterCreate",value:function(){var e=this;this._clickCount=0,Ae.map(function(r){e.__hooks[r]=null});var i=this.playerConfig.isMobileSimulateMode;i==="mobile"||I.device==="mobile"&&!I.os.isIpad||this.initEvents()}},{key:"initEvents",value:function(){var e=this,i=this.player,r=i.media,a=i.root,u=this.playerConfig.enableContextmenu;a&&a.addEventListener("click",this.onVideoClick,!1),a&&a.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(fe).map(function(l){a.addEventListener(l,e[fe[l]],!1)}),!u&&r&&r.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(e){var i=this.player;this.emitUserAction(e,"switch_play_pause",{props:"paused",from:i.paused,to:!i.paused}),i.ended?i.duration!==1/0&&i.duration>0&&i.replay():i.paused?i.play():i.pause()}},{key:"onContextmenu",value:function(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.stopPropagation?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)}},{key:"destroy",value:function(){var e=this,i=this.player,r=i.video,a=i.root;this.clickTimer&&clearTimeout(this.clickTimer),a.removeEventListener("click",this.onVideoClick,!1),a.removeEventListener("dblclick",this.onVideoDblClick,!1),r.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(fe).map(function(u){a.removeEventListener(u,e[fe[u]],!1)})}}],[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{}}}]),n}(me),K={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},Ni={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},Fi={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function st(o){return o&&o.length>0?o[o.length-1]:null}function Mi(){return{pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0}}var Hi=function(){function o(s){var n=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{eventType:"touch"};O(this,o),C(this,"onTouchStart",function(e){var i=n._pos,r=n.root,a=st(e.touches);i.x=a?parseInt(a.pageX,10):e.pageX,i.y=a?parseInt(a.pageX,10):e.pageX,i.start=!0,n.__setPress(e),r.addEventListener(n.events.end,n.onTouchEnd),r.addEventListener(n.events.cancel,n.onTouchCancel),r.addEventListener(n.events.move,n.onTouchMove),n.trigger(K.TOUCH_START,e)}),C(this,"onTouchCancel",function(e){n.onTouchEnd(e)}),C(this,"onTouchEnd",function(e){var i=n._pos,r=n.root;n.__clearPress(),r.removeEventListener(n.events.cancel,n.onTouchCancel),r.removeEventListener(n.events.end,n.onTouchEnd),r.removeEventListener(n.events.move,n.onTouchMove),e.moving=i.moving,e.press=i.press,i.press&&n.trigger(K.PRESS_END,e),n.trigger(K.TOUCH_END,e),!i.press&&!i.moving&&n.__setDb(e),i.press=!1,i.start=!1,i.moving=!1}),C(this,"onTouchMove",function(e){var i=n._pos,r=n.config,a=st(e.touches),u=a?parseInt(a.pageX,10):e.pageX,l=a?parseInt(a.pageY,10):e.pageX,f=u-i.x,h=l-i.y;Math.abs(h)<r.miniStep&&Math.abs(f)<r.miniStep||(n.__clearPress(),i.press&&n.trigger(K.PRESS_END,e),i.press=!1,i.moving=!0,n.trigger(K.TOUCH_MOVE,e))}),this._pos={moving:!1,start:!1,x:0,y:0},this.config=Mi(),Object.keys(t).map(function(e){n.config[e]=t[e]}),this.root=s,this.events=t.eventType==="mouse"?Fi:Ni,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return x(o,[{key:"_initEvent",value:function(){this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(n){var t=this,e=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){t.trigger(K.PRESS,n),t._pos.press=!0,t.__clearPress()},e.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(n){var t=this,e=this.config;if(this.dbIntrvalId){this.__clearDb(),this.trigger(K.DOUBlE_CLICK,n);return}this.dbIntrvalId=setTimeout(function(){t.__clearDb(),!t._pos.start&&!t._pos.press&&!t._pos.moving&&t.trigger(K.CLICK,n)},e.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(n,t){this.__handlers[n]||(this.__handlers[n]=[]),this.__handlers[n].push(t)}},{key:"off",value:function(n,t){if(this.__handlers[n]){for(var e=this.__handlers[n],i=-1,r=0;r<e.length;r++)if(e[r]===t){i=r;break}i>=0&&this.__handlers[n].splice(i,1)}}},{key:"trigger",value:function(n,t){this.__handlers[n]&&this.__handlers[n].map(function(e){try{e(t)}catch(i){console.error("trigger>>:".concat(n),i)}})}},{key:"destroy",value:function(){var n=this,t={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(t).forEach(function(e){n.root.removeEventListener(e,n[t[e]])})}}]),o}();function Bi(){return new DOMParser().parseFromString('<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"\n  xmlns:xlink="http://www.w3.org/1999/xlink">\n  <path opacity="0.54"\n    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"\n    fill="white" />\n  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>\n</svg>',"image/svg+xml").firstChild}var ie={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate",LIGHT:""},Pe=["videoClick","videoDbClick"],$i=function(o){F(n,o);var s=M(n);function n(t){var e;return O(this,n),e=s.call(this,t),C(_(e),"onTouchStart",function(i){var r=_(e),a=r.player,u=r.config,l=r.pos,f=r.playerConfig,h=e.getTouche(i);if(h&&!u.disableGesture&&e.duration>0&&!a.ended){l.isStart=!0,e.timer&&clearTimeout(e.timer),c.checkIsFunction(f.disableSwipeHandler)&&f.disableSwipeHandler(),e.find(".xg-dur").innerHTML=c.format(e.duration);var d=e.root.getBoundingClientRect();a.rotateDeg===90?(l.top=d.left,l.left=d.top,l.width=d.height,l.height=d.width):(l.top=d.top,l.left=d.left,l.width=d.width,l.height=d.height);var g=parseInt(h.pageX-l.left,10),v=parseInt(h.pageY-l.top,10);l.x=a.rotateDeg===90?v:g,l.y=a.rotateDeg===90?g:v,l.scopeL=u.scopeL*l.width,l.scopeR=(1-u.scopeR)*l.width,l.scopeM1=l.width*(1-u.scopeM)/2,l.scopeM2=l.width-l.scopeM1}}),C(_(e),"onTouchMove",function(i){var r=e.getTouche(i),a=_(e),u=a.pos,l=a.config,f=a.player;if(!(!r||l.disableGesture||!e.duration||!u.isStart)){var h=l.miniMoveStep,d=l.hideControlsActive,g=parseInt(r.pageX-u.left,10),v=parseInt(r.pageY-u.top,10),y=f.rotateDeg===90?v:g,m=f.rotateDeg===90?g:v;if(Math.abs(y-u.x)>h||Math.abs(m-u.y)>h){var T=y-u.x,k=m-u.y,E=u.scope;if(E===-1&&(E=e.checkScope(y,m,T,k,u),E===0&&(d?f.blur():f.focus({autoHide:!1}),!u.time&&(u.time=parseInt(f.currentTime*1e3,10)+e.timeOffset*1e3)),u.scope=E),E===-1||E>0&&!l.gestureY||E===0&&!l.gestureX)return;e.executeMove(T,k,E,u.width,u.height),u.x=y,u.y=m}}}),C(_(e),"onTouchEnd",function(i){var r=_(e),a=r.player,u=r.pos,l=r.playerConfig;if(setTimeout(function(){a.getPlugin("progress")&&a.getPlugin("progress").resetSeekState()},10),!!u.isStart){u.scope>-1&&i.cancelable&&i.preventDefault();var f=e.config,h=f.disableGesture,d=f.gestureX;!h&&d?e.endLastMove(u.scope):u.time=0,u.scope=-1,e.resetPos(),c.checkIsFunction(l.enableSwipeHandler)&&l.enableSwipeHandler(),e.changeAction(ie.AUTO)}}),C(_(e),"onRootTouchMove",function(i){e.config.disableGesture||!e.config.gestureX||e.checkIsRootTarget(i)&&(i.stopPropagation(),e.pos.isStart?e.onTouchMove(i):e.onTouchStart(i))}),C(_(e),"onRootTouchEnd",function(i){e.pos.scope>-1&&e.onTouchEnd(i)}),e.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},e.timer=null,e}return x(n,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:Bi,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var e=this;Pe.map(function(d){e.__hooks[d]=null});var i=this.playerConfig,r=this.config,a=this.player;i.closeVideoDblclick===!0&&(r.closedbClick=!0),this.resetPos(),c.isUndefined(i.disableGesture)||(r.disableGesture=!!i.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=c.createDom("xg-mask","",{},"xgmask"),a.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var u=this.domEventType==="mouse"?"mouse":"touch";this.touch=new Hi(this.root,{eventType:u,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(d){d.preventDefault()}),a.root.addEventListener("touchmove",this.onRootTouchMove,!0),a.root.addEventListener("touchend",this.onRootTouchEnd,!0),a.root.addEventListener("touchcancel",this.onRootTouchEnd,!0);var l=this.player.controls;l&&l.center&&(l.center.addEventListener("touchmove",this.onRootTouchMove,!0),l.center.addEventListener("touchend",this.onRootTouchEnd,!0),l.center.addEventListener("touchcancel",this.onRootTouchEnd,!0)),this.on(ye,function(){var d=e.player,g=e.config;d.duration*1e3<g.moveDuration&&(g.moveDuration=d.duration*1e3)}),this.on([re,Re],function(){var d=e.pos,g=d.time,v=d.isStart;!v&&g>0&&(e.pos.time=0)});var f={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(f).map(function(d){e.touch.on(d,function(g){e[f[d]](g)})}),!r.disableActive){var h=a.plugins.progress;h&&(h.addCallBack("dragmove",function(d){e.activeSeekNote(d.currentTime,d.forward)}),["dragend","click"].forEach(function(d){h.addCallBack(d,function(){e.changeAction(ie.AUTO)})}))}}},{key:"registerThumbnail",value:function(){var e=this.player,i=e.plugins.thumbnail;if(i&&i.usable){this.thumbnail=i.createThumbnail(null,"mobile-thumbnail");var r=this.find(".time-preview");r.insertBefore(this.thumbnail,r.children[0])}}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},i=e.commonStyle,r=i.playedColor,a=i.progressColor,u=i.timePreviewStyle,l=i.curTimeColor,f=i.durationColor;if(r&&(this.find(".xg-curbar").style.backgroundColor=r),a&&(this.find(".xg-bar").style.backgroundColor=a),u){var h=this.find(".time-preview");Object.keys(u).forEach(function(v){h.style[v]=u[v]})}var d=l||r,g=f;d&&(this.find(".xg-cur").style.color=d),g&&(this.find(".xg-dur").style.color=g),this.config.disableTimeProgress&&c.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var e=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(i){e.pos[i]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(e){var i=this.player,r=this.root;r.setAttribute("data-xg-action",e);var a=i.plugins.start;a&&a.recover()}},{key:"getTouche",value:function(e){var i=this.player.rotateDeg,r=e.touches&&e.touches.length>0?e.touches[e.touches.length-1]:e;return i===0?{pageX:r.pageX,pageY:r.pageY}:{pageX:r.pageX,pageY:r.pageY}}},{key:"checkScope",value:function(e,i,r,a,u){var l=u.width,f=-1;if(e<0||e>l)return f;var h=Math.abs(a===0?r:r/a);return Math.abs(r)>0&&h>=1.73&&e>u.scopeM1&&e<u.scopeM2?f=0:(Math.abs(r)===0||h<=.57)&&(f=e<u.scopeL?1:e>u.scopeR?2:3),f}},{key:"executeMove",value:function(e,i,r,a,u){switch(r){case 0:this.updateTime(e/a*this.config.scopeM);break;case 1:this.updateBrightness(i/u);break;case 2:I.os.isIos||this.updateVolume(i/u);break}}},{key:"endLastMove",value:function(e){var i=this,r=this.pos,a=this.player,u=this.config,l=(r.time-this.timeOffset)/1e3;switch(e){case 0:a.seek(Number(l).toFixed(1)),u.hideControlsEnd?a.blur():a.focus(),this.timer=setTimeout(function(){i.pos.time=0},500);break}this.changeAction(ie.AUTO)}},{key:"checkIsRootTarget",value:function(e){var i=this.player.plugins||{};return i.progress&&i.progress.root.contains(e.target)?!1:i.start&&i.start.root.contains(e.target)||i.controls&&i.controls.root.contains(e.target)}},{key:"sendUseAction",value:function(e){var i=this.player.paused;this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:i,to:!i})}},{key:"clickHandler",value:function(e){var i=this.player,r=this.config,a=this.playerConfig;if(i.state<b.RUNNING){a.closeVideoClick||(this.sendUseAction(c.createEvent("click")),i.play());return}!r.closedbClick||a.closeVideoClick?i.isActive?i.blur():i.focus():a.closeVideoClick||((i.isActive||r.focusVideoClick)&&(this.sendUseAction(c.createEvent("click")),this.switchPlayPause()),i.focus())}},{key:"dbClickHandler",value:function(e){var i=this.config,r=this.player;!i.closedbClick&&r.state>=b.RUNNING&&(this.sendUseAction(c.createEvent("dblclick")),this.switchPlayPause())}},{key:"onClick",value:function(e){var i=this,r=this.player;W(this,Pe[0],function(a,u){i.clickHandler(u.e)},{e,paused:r.paused})}},{key:"onDbClick",value:function(e){var i=this,r=this.player;W(this,Pe[1],function(a,u){i.dbClickHandler(u.e)},{e,paused:r.paused})}},{key:"onPress",value:function(e){var i=this.pos,r=this.config,a=this.player;r.disablePress||(i.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:a.playbackRate,to:r.pressRate}),a.playbackRate=r.pressRate,this.changeAction(ie.PLAYBACK))}},{key:"onPressEnd",value:function(e){var i=this.pos,r=this.config,a=this.player;r.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:a.playbackRate,to:i.rate}),a.playbackRate=i.rate,i.rate=1,this.changeAction(ie.AUTO))}},{key:"updateTime",value:function(e){var i=this.player,r=this.config,a=this.player.duration;e=Number(e.toFixed(4));var u=parseInt(e*r.moveDuration,10)+this.timeOffset;u+=this.pos.time,u=u<0?0:u>a*1e3?a*1e3-200:u,i.getPlugin("time")&&i.getPlugin("time").updateTime(u/1e3),i.getPlugin("progress")&&i.getPlugin("progress").updatePercent(u/1e3/this.duration,!0),this.activeSeekNote(u/1e3,e>0),r.isTouchingSeek&&i.seek(Number((u-this.timeOffset)/1e3).toFixed(1)),this.pos.time=u}},{key:"updateVolume",value:function(e){this.player.rotateDeg&&(e=-e);var i=this.player,r=this.pos;if(e=parseInt(e*100,10),r.volume+=e,!(Math.abs(r.volume)<10)){var a=parseInt(i.volume*10,10)-parseInt(r.volume/10,10);a=a>10?10:a<1?0:a,i.volume=a/10,r.volume=0}}},{key:"updateBrightness",value:function(e){var i=this.pos,r=this.config,a=this.xgMask;if(r.darkness){this.player.rotateDeg&&(e=-e);var u=i.light+.8*e;u=u>r.maxDarkness?r.maxDarkness:u<0?0:u,a&&(a.style.backgroundColor="rgba(0,0,0,".concat(u,")")),i.light=u}}},{key:"activeSeekNote",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this.player,a=this.config,u=!(this.duration!==1/0&&this.duration>0);if(!(!e||typeof e!="number"||u||a.disableActive)){e<0?e=0:e>r.duration&&(e=r.duration-.2),this.changeAction(ie.SEEKING);var l=r.plugins.start;l&&l.focusHide(),this.find(".xg-dur").innerHTML=c.format(this.duration),this.find(".xg-cur").innerHTML=c.format(e),this.find(".xg-curbar").style.width="".concat(e/this.duration*100,"%"),i?c.removeClass(this.find(".xg-seek-show"),"xg-back"):c.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(e)}}},{key:"updateThumbnails",value:function(e){var i=this.player,r=i.plugins.thumbnail;r&&r.usable&&this.thumbnail&&r.update(this.thumbnail,e,160,90)}},{key:"switchPlayPause",value:function(){var e=this.player;if(e.state<b.ATTACHED)return!1;e.ended||(e.paused?e.play():e.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var e=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,e.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,e.root.removeEventListener("touchmove",this.onRootTouchMove,!0),e.root.removeEventListener("touchend",this.onRootTouchEnd,!0),e.root.removeEventListener("touchcancel",this.onRootTouchEnd,!0);var i=this.player.controls;i&&i.center&&(i.center.removeEventListener("touchmove",this.onRootTouchMove,!0),i.center.removeEventListener("touchend",this.onRootTouchEnd,!0),i.center.removeEventListener("touchcancel",this.onRootTouchEnd,!0))}},{key:"render",value:function(){var e=this.config.gradient!=="normal"?"gradient ".concat(this.config.gradient):"gradient";return'\n     <xg-trigger class="trigger">\n     <div class="'.concat(e,'"></div>\n        <div class="time-preview">\n            <div class="xg-seek-show ').concat(this.config.disableSeekIcon?" hide-seek-icon":"",'">\n              <i class="xg-seek-icon"></i>\n              <span class="xg-cur">00:00</span>\n              <span class="xg-separator">/</span>\n              <span class="xg-dur">00:00</span>\n            </div>\n              <div class="xg-bar xg-timebar">\n                <div class="xg-curbar"></div>\n              </div>\n        </div>\n        <div class="xg-playbackrate xg-top-note">\n            <span><i>').concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,"</span>\n        </div>\n     </xg-trigger>\n    ")}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:60*6*1e3,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),n}(q),Ui=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],Gi=function(){function o(s){O(this,o),this.fragments=s.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=s.actionCallback,this.fragConfig={fragFocusClass:s.fragFocusClass||"inner-focus-point",fragAutoFocus:!!s.fragAutoFocus,fragClass:s.fragClass||""},this.style=s.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return x(o,[{key:"updateDuration",value:function(n){var t=this;this.duration=n;var e=0,i=this.fragments;this.fragments=i.map(function(r){return r.start=parseInt(e,10),r.end=parseInt(e+r.percent*t.duration,10),r.duration=parseInt(r.percent*t.duration,10),e+=r.percent*t.duration,r})}},{key:"updateProgress",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},e=this.progressList,i=this.fragments;if(!(e.length<1)){var r=t.newIndex,a=t.curIndex,u=t.millisecond;r!==a&&e.map(function(h,d){d<r?h[n].style.width="100%":d>r&&(h[n].style.width=0)});var l=i[r],f=u===0?0:(u-l.start)/l.duration;e[r][n].style.width=f<0?0:"".concat(f*100,"%")}}},{key:"updateFocus",value:function(n){if(!(!this.fragConfig.fragAutoFocus||this.fragments.length<2)){if(!n){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var t={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(t),this.focusIndex=-1}return}var e=this.findIndex(n.currentTime*1e3,this.focusIndex);if(e>=0&&e!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(e);var i={index:e,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=e,this._callBack&&this._callBack(i)}}}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(t*1e3,10)!==this.duration){if(!t&&t!==0)return;this.updateDuration(parseInt(t*1e3,10))}var e=this.playedIndex,i=this.cachedIndex;if(c.typeOf(n.played)!=="Undefined"){var r=this.findIndex(n.played*1e3,e);if(r<0)return;this.updateProgress("played",{newIndex:r,curIndex:e,millisecond:parseInt(n.played*1e3,10)}),this.playedIndex=r}if(c.typeOf(n.cached)!=="Undefined"){var a=this.findIndex(n.cached*1e3,i);if(a<0)return;this.updateProgress("cached",{newIndex:a,curIndex:i,millisecond:parseInt(n.cached*1e3,10)}),this.cachedIndex=a}}},{key:"findIndex",value:function(n,t){var e=this.fragments;if(!e||e.length===0)return-1;if(e.length===1)return 0;if(t>-1&&t<e.length&&n>e[t].start&&n<e[t].end)return t;if(n>e[e.length-1].start)return e.length-1;for(var i=0;i<e.length;i++)if(n>e[i].start&&n<=e[i].end){t=i;break}return t}},{key:"findHightLight",value:function(){for(var n=this.root.children,t=0;t<n.length;t++)if(c.hasClass(n[t],this.fragConfig.fragFocusClass))return{dom:n[t],pos:n[t].getBoundingClientRect()}}},{key:"findFragment",value:function(n){var t=this.root.children;return n<0||n>=t.length?null:{dom:t[n],pos:t[n].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var n=this.root.children,t=0;t<n.length;t++)c.removeClass(n[t],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(n){var t=this.root.children;if(n<t.length)return c.addClass(t[n],this.fragConfig.fragFocusClass),{dom:t[n],pos:t[n].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(n){var t=this;if(Object.keys(this.fragConfig).forEach(function(i){n[i]!==void 0&&(t.fragConfig[i]=n[i])}),n.fragments){if(this.fragments=n.fragments.length===0?[{percent:1}]:n.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var e=this.root.children;e.length>0;)this.root.removeChild(e[0]);this.render()}}},{key:"render",value:function(){var n=this,t=this.style.progressColor;if(this.root||(this.root=c.createDom("xg-inners","",{},"progress-list")),this.fragments){var e=this.fragConfig,i=e.fragClass,r=e.fragFocusClass;this.progressList=this.fragments.map(function(a){var u=c.createDom("xg-inner","",{style:t?"background:".concat(t,"; flex: ").concat(a.percent):"flex: ".concat(a.percent)},"".concat(a.isFocus?r:""," xgplayer-progress-inner ").concat(i));return n.root.appendChild(u),Ui.forEach(function(l){u.appendChild(c.createDom(l.tag,"",{style:l.styleKey?"background: ".concat(n.style[l.styleKey],"; width:0;"):"width:0;"},l.className))}),{cached:u.children[0],played:u.children[1]}})}return this.root}}]),o}(),ot={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},qi=function(o){F(n,o);var s=M(n);function n(t){var e;return O(this,n),e=s.call(this,t),C(_(e),"onMoveOnly",function(i,r){var a=_(e),u=a.pos,l=a.config,f=a.player,h=r;if(i){c.event(i);var d=c.getEventPos(i,f.zoom),g=f.rotateDeg===90?d.clientY:d.clientX;if(u.moving&&Math.abs(u.x-g)<l.miniMoveStep)return;u.moving=!0,u.x=g,h=e.computeTime(i,g)}e.triggerCallbacks("dragmove",h,i),e._updateInnerFocus(h)}),C(_(e),"onBodyClick",function(i){e.pos.isLocked&&(e.pos.isLocked=!1,i.preventDefault(),i.stopPropagation())}),C(_(e),"_mouseDownHandler",function(i,r){e._state.time=r.currentTime,e.updateWidth(r.currentTime,r.seekTime,r.percent,0),e._updateInnerFocus(r)}),C(_(e),"_mouseUpHandler",function(i,r){var a=_(e),u=a.pos;u.moving&&e.updateWidth(r.currentTime,r.seekTime,r.percent,2)}),C(_(e),"_mouseMoveHandler",function(i,r){var a=_(e),u=a._state,l=a.pos,f=a.config,h=a.player;u.time<r.currentTime?r.forward=!0:r.forward=!1,u.time=r.currentTime,l.isDown&&!l.moving&&(l.moving=!0,f.isPauseMoving&&h.pause(),e.triggerCallbacks("dragstart",r,i),e.emitUserAction("drag","dragstart",r)),e.updateWidth(r.currentTime,r.seekTime,r.percent,1),e.triggerCallbacks("dragmove",r,i),e._updateInnerFocus(r)}),C(_(e),"onMouseDown",function(i){var r=_(e),a=r._state,u=r.player,l=r.pos,f=r.config,h=r.playerConfig,d=c.getEventPos(i,u.zoom),g=u.rotateDeg===90?d.clientY:d.clientX;if(!(u.isMini||f.closeMoveSeek||!h.allowSeekAfterEnded&&u.ended)){if(!u.duration&&!u.isPlaying){u.play();return}i.stopPropagation(),e.focus(),c.checkIsFunction(h.disableSwipeHandler)&&h.disableSwipeHandler(),c.checkIsFunction(f.onMoveStart)&&f.onMoveStart(),c.event(i),l.x=g,l.isDown=!0,l.moving=!1,a.prePlayTime=u.currentTime,u.focus({autoHide:!1}),e.isProgressMoving=!0,c.addClass(e.progressBtn,"active");var v=e.computeTime(i,g);v.prePlayTime=a.prePlayTime,e._mouseDownHandlerHook(i,v);var y=i.type;return y==="touchstart"?(e.root.addEventListener("touchmove",e.onMouseMove),e.root.addEventListener("touchend",e.onMouseUp),e.root.addEventListener("touchcancel",e.onMouseUp)):(e.unbind("mousemove",e.onMoveOnly),document.addEventListener("mousemove",e.onMouseMove,!1),document.addEventListener("mouseup",e.onMouseUp,!1)),!0}}),C(_(e),"onMouseUp",function(i){var r=_(e),a=r.player,u=r.config,l=r.pos,f=r.playerConfig,h=r._state;i.stopPropagation(),i.preventDefault(),c.checkIsFunction(f.enableSwipeHandler)&&f.enableSwipeHandler(),c.checkIsFunction(u.onMoveEnd)&&u.onMoveEnd(),c.event(i),c.removeClass(e.progressBtn,"active");var d=e.computeTime(i,l.x);d.prePlayTime=h.prePlayTime,l.moving?(e.triggerCallbacks("dragend",d,i),e.emitUserAction("drag","dragend",d)):(e.triggerCallbacks("click",d,i),e.emitUserAction("click","click",d)),e._mouseUpHandlerHook(i,d),l.moving=!1,l.isDown=!1,l.x=0,l.y=0,l.isLocked=!0,h.prePlayTime=0,h.time=0;var g=i.type;g==="touchend"||g==="touchcancel"?(e.root.removeEventListener("touchmove",e.onMouseMove),e.root.removeEventListener("touchend",e.onMouseUp),e.root.removeEventListener("touchcancel",e.onMouseUp),e.blur()):(document.removeEventListener("mousemove",e.onMouseMove,!1),document.removeEventListener("mouseup",e.onMouseUp,!1),l.isEnter?f.isMobileSimulateMode!=="mobile"&&e.bind("mousemove",e.onMoveOnly):e.onMouseLeave(i)),c.setTimeout(_(e),function(){e.resetSeekState()},1),a.focus()}),C(_(e),"onMouseMove",function(i){var r=_(e),a=r._state,u=r.pos,l=r.player,f=r.config;c.checkTouchSupport()&&i.preventDefault(),c.event(i);var h=c.getEventPos(i,l.zoom),d=l.rotateDeg===90?h.clientY:h.clientX,g=Math.abs(u.x-d);if(!(u.moving&&g<f.miniMoveStep||!u.moving&&g<f.miniStartStep)){u.x=d;var v=e.computeTime(i,d);v.prePlayTime=a.prePlayTime,e._mouseMoveHandlerHook(i,v)}}),C(_(e),"onMouseOut",function(i){e.triggerCallbacks("mouseout",null,i)}),C(_(e),"onMouseOver",function(i){e.triggerCallbacks("mouseover",null,i)}),C(_(e),"onMouseEnter",function(i){var r=_(e),a=r.player,u=r.pos;if(!(u.isDown||u.isEnter||a.isMini||!a.config.allowSeekAfterEnded&&a.ended)){u.isEnter=!0,e.bind("mousemove",e.onMoveOnly),e.bind("mouseleave",e.onMouseLeave),c.event(i);var l=c.getEventPos(i,a.zoom),f=a.rotateDeg===90?l.clientY:l.clientX,h=e.computeTime(i,f);e.triggerCallbacks("mouseenter",h,i),e.focus()}}),C(_(e),"onMouseLeave",function(i){e.triggerCallbacks("mouseleave",null,i),e.unlock(),e._updateInnerFocus(null)}),C(_(e),"onVideoResize",function(){var i=e.pos,r=i.x,a=i.isDown,u=i.isEnter;if(u&&!a){var l=e.computeTime(null,r);e.onMoveOnly(null,l)}}),e.useable=!1,e.isProgressMoving=!1,e.__dragCallBacks=[],e._state={now:-1,direc:0,time:0,prePlayTime:-1},e._disableBlur=!1,e}return x(n,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"currentTime",get:function(){var e=this.player,i=e.offsetCurrentTime,r=e.currentTime;return i>=0?i:r+this.timeOffset}},{key:"changeState",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.useable=e}},{key:"show",value:function(e){this.root&&(this.root.style.display="flex")}},{key:"_initInner",value:function(){var e=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(!i||i.length===0)&&(i=[{percent:1}]);var a=$($({fragments:i},r),{},{actionCallback:function(l){e.emitUserAction("fragment_focus","fragment_focus",l)}});this.innerList?this.innerList.reset(a):(this.innerList=new Gi(a),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(u){e[u]=e.innerList[u].bind(e.innerList)}))}},{key:"_updateInnerFocus",value:function(e){this.innerList&&this.innerList.updateFocus(e)}},{key:"afterCreate",value:function(){var e=this;if(!(this.config.disable||this.playerConfig.isLive)){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var i=this.config,r=i.fragFocusClass,a=i.fragAutoFocus,u=i.fragClass;this._initInner(this.config.fragments,{fragFocusClass:r,fragAutoFocus:a,fragClass:u,style:this.playerConfig.commonStyle||{}}),I.device==="mobile"&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(ye,function(){e.onMouseLeave()}),this.on(gt,function(){e.onTimeupdate()}),this.on(ee,function(){e.onTimeupdate(),e.onCacheUpdate()}),this.on(Wt,function(){e.onCacheUpdate()}),this.on(Re,function(){e.onCacheUpdate(!0),e.onTimeupdate(!0),e._state.now=0}),this.on(De,function(){e.onReset()}),this.on(mt,function(){e.onVideoResize()}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(e){var i=this,r=null;Object.keys(e).forEach(function(a){i.config[a]=e[a],a==="fragments"&&(r=e[a])}),r&&this._initInner(r,e)}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},i=e.commonStyle,r=i.sliderBtnStyle,a=this.progressBtn;r&&(typeof r=="string"?a.style.boxShadow=r:G(r)==="object"&&Object.keys(r).map(function(u){a.style[u]=r[u]}))}},{key:"triggerCallbacks",value:function(e,i,r){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(a){if(a&&a.handler&&a.type===e)try{a.handler(i,r)}catch(u){console.error("[XGPLAYER][triggerCallbacks] ".concat(a," error"),u)}})}},{key:"addCallBack",value:function(e,i){i&&typeof i=="function"&&this.__dragCallBacks.push({type:e,handler:i})}},{key:"removeCallBack",value:function(e,i){var r=this.__dragCallBacks,a=-1;r.map(function(u,l){u&&u.type===e&&u.handler===i&&(a=l)}),a>-1&&r.splice(a,1)}},{key:"unlock",value:function(){var e=this.player,i=this.pos;if(i.isEnter=!1,i.isLocked=!1,!e.isMini){if(this.unbind("mousemove",this.onMoveOnly),i.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var e=this.player.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),(this.domEventType==="touch"||this.domEventType==="compatible")&&this.root.addEventListener("touchstart",this.onMouseDown),(this.domEventType==="mouse"||this.domEventType==="compatible")&&(this.bind("mousedown",this.onMouseDown),e.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),c.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),c.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,i,r,a){var u=this.config,l=this.player;if(!(u.isCloseClickSeek&&a===0)){var f=i=i>=l.duration?l.duration-u.endedDiff:Number(i).toFixed(1);this.updatePercent(r),this.updateTime(e),!(a===1&&(!u.isDragingSeek||l.config.mediaType==="audio"))&&(this._state.now=f,this._state.direc=f>l.currentTime?0:1,l.seek(f))}}},{key:"computeTime",value:function(e,i){var r=this.player,a=this.root.getBoundingClientRect(),u=a.width,l=a.height,f=a.top,h=a.left,d,g,v=i;r.rotateDeg===90?(d=l,g=f):(d=u,g=h);var y=v-g;y=y>d?d:y<0?0:y;var m=y/d;m=m<0?0:m>1?1:m;var T=parseInt(m*this.offsetDuration*1e3,10)/1e3,k=c.getCurrentTimeByOffset(T,r.timeSegments);return{percent:m,currentTime:T,seekTime:k,offset:y,width:d,left:g,e}}},{key:"updateTime",value:function(e){var i=this.player,r=this.duration;e>r?e=r:e<0&&(e=0);var a=i.plugins.time;a&&a.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,i){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(e*100,"%"),this.innerList.update({played:e*this.offsetDuration},this.offsetDuration);var r=this.player.plugins.miniprogress;r&&r.update({played:e*this.offsetDuration},this.offsetDuration)}}},{key:"onTimeupdate",value:function(e){var i=this.player,r=this._state,a=this.offsetDuration;if(!(i.isSeeking&&i.media.seeking||this.isProgressMoving||!i.hasStart)){if(r.now>-1){var u=parseInt(r.now*1e3,10)-parseInt(i.currentTime*1e3,10);if(r.direc===0&&u>300||r.direc===1&&u>-300){r.now=-1;return}else r.now=-1}var l=this.currentTime;l=c.adjustTimeByDuration(l,a,e),this.innerList.update({played:l},a),this.progressBtn.style.left="".concat(l/a*100,"%")}}},{key:"onCacheUpdate",value:function(e){var i=this.player,r=this.duration;if(i){var a=i.bufferedPoint.end;a=c.adjustTimeByDuration(a,r,e),this.innerList.update({cached:a},r)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0),this.progressBtn.style.left="0%"}},{key:"destroy",value:function(){var e=this.player;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var i=this.domEventType;(i==="touch"||i==="compatible")&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),this.root.removeEventListener("touchcancel",this.onMouseUp)),(i==="mouse"||i==="compatible")&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){var e=this.player.controls?this.player.controls.config.mode:"",i=e==="bottom"?"xgplayer-progress-bottom":"";return'\n    <xg-progress class="xgplayer-progress '.concat(i,'">\n      <xg-outer class="xgplayer-progress-outer">\n        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>\n      </xg-outer>\n    </xg-progress>\n    ')}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:U.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:ot.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return ot}}]),n}(q),St=function(o){F(n,o);var s=M(n);function n(){var t;O(this,n);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t=s.call.apply(s,[this].concat(i)),C(_(t),"_onMouseenter",function(a){t.emit("icon_mouseenter",{pluginName:t.pluginName})}),C(_(t),"_onMouseLeave",function(a){t.emit("icon_mouseleave",{pluginName:t.pluginName})}),t}return x(n,[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave),this.config.disable&&this.disable()}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}]),n}(q),Zi=function(o){F(n,o);var s=M(n);function n(){return O(this,n),s.apply(this,arguments)}return x(n,[{key:"afterCreate",value:function(){var e=this;w(S(n.prototype),"afterCreate",this).call(this);var i=this.player,r=this.config;r.disable||(this.initIcons(),this.btnClick=this.btnClick.bind(this),this.bind(["touchend","click"],this.btnClick),this.on([dt,Le,De],function(){e.animate(i.paused)}),this.on(de,function(){e.animate(i.paused)}),this.animate(!0))}},{key:"registerIcons",value:function(){return{play:{icon:Tt,class:"xg-icon-play"},pause:{icon:kt,class:"xg-icon-pause"}}}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var i=this.player;return this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:i.paused,to:!i.paused}),i.ended?i.replay():i.paused?(i.play(),this.animate(!1)):(i.pause(),this.animate(!0)),!1}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.play),this.appendChild(".xgplayer-icon",e.pause)}},{key:"animate",value:function(e){if(this.player){var i=this.i18nKeys,r=this.find(".xg-tips");e?(this.setAttr("data-state","pause"),r&&this.changeLangTextKey(r,i.PLAY_TIPS)):(this.setAttr("data-state","play"),r&&this.changeLangTextKey(r,i.PAUSE_TIPS))}}},{key:"destroy",value:function(){w(S(n.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-play">\n    <div class="xgplayer-icon">\n    </div>\n    '.concat(bt(this,"PLAY_TIPS",this.playerConfig.isHideTips),"\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:U.CONTROLS_LEFT,index:0,disable:!1}}}]),n}(St);function ji(){return new DOMParser().parseFromString('<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>\n    </g>\n</svg>',"image/svg+xml").firstChild}var Vi=function(o){F(n,o);var s=M(n);function n(){return O(this,n),s.apply(this,arguments)}return x(n,[{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.onClick=function(i){i.preventDefault(),i.stopPropagation(),e.config.onClick(i)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:ji,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(this.root,e.screenBack)}},{key:"show",value:function(){c.addClass(this.root,"show")}},{key:"hide",value:function(){c.removeClass(this.root,"show")}},{key:"render",value:function(){return'<xg-icon class="xgplayer-back">\n    </xg-icon>'}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:U.ROOT_TOP,index:0}}}]),n}(q);function zi(){return new DOMParser().parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>\n</svg>\n',"image/svg+xml").firstChild}function Wi(){return new DOMParser().parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">\n  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>\n</svg>\n',"image/svg+xml").firstChild}var Qi=function(o){F(n,o);var s=M(n);function n(){var t;O(this,n);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t=s.call.apply(s,[this].concat(i)),C(_(t),"_onOrientationChange",function(a){t.player.fullscreen&&t.config.rotateFullscreen&&(window.orientation===90||window.orientation===-90?t.player.setRotateDeg(0):t.player.setRotateDeg(90))}),t}return x(n,[{key:"afterCreate",value:function(){var e=this;w(S(n.prototype),"afterCreate",this).call(this);var i=this.config,r=this.playerConfig;if(!i.disable){i.target&&(this.playerConfig.fullscreenTarget=this.config.target);var a=c.getFullScreenEl();r.fullscreenTarget===a&&this.player.getFullscreen().catch(function(u){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(l){var f=e.player.fullscreen;e.emitUserAction(l,"switch_fullscreen",{prop:"fullscreen",from:f,to:!f})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(Z,function(u){var l=e.find(".xg-tips");l&&e.changeLangTextKey(l,u?e.i18nKeys.EXITFULLSCREEN_TIPS:e.i18nKeys.FULLSCREEN_TIPS),e.animate(u)}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:Vi,options:{config:{onClick:function(l){e.handleFullscreen(l)}}}})),I.device==="mobile"&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:zi,class:"xg-get-fullscreen"},exitFullscreen:{icon:Wi,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){w(S(n.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",I.device==="mobile"?"touchend":"click",this.handleFullscreen),I.device==="mobile"&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.fullscreen),this.appendChild(".xgplayer-icon",e.exitFullscreen)}},{key:"toggleFullScreen",value:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=this.player,r=this.config,a=r.useCssFullscreen===!0||typeof r.useCssFullscreen=="function"&&r.useCssFullscreen();a?(i.fullscreen?i.exitCssFullscreen():i.getCssFullscreen(),this.animate(i.fullscreen)):r.rotateFullscreen?(i.fullscreen?i.exitRotateFullscreen():i.getRotateFullscreen(),this.animate(i.fullscreen)):r.switchCallback&&typeof r.switchCallback=="function"?r.switchCallback(i.fullscreen):i.fullscreen?(i.exitFullscreen(),r.useScreenOrientation&&this.unlockScreen()):(i.getFullscreen().catch(function(u){}),r.useScreenOrientation&&i.aspectRatio>1&&this.lockScreen(r.lockOrientationType))}},{key:"animate",value:function(e){e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(e?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"render",value:function(){if(!this.config.disable){var e="FULLSCREEN_TIPS";return'<xg-icon class="xgplayer-fullscreen">\n    <div class="xgplayer-icon">\n    </div>\n    '.concat(bt(this,e,this.playerConfig.isHideTips),"\n    </xg-icon>")}}},{key:"lockScreen",value:function(e){try{screen.orientation.lock(e).catch(function(i){})}catch(i){}}},{key:"unlockScreen",value:function(){try{screen.orientation.unlock().catch(function(e){})}catch(e){}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:U.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,useScreenOrientation:!1,lockOrientationType:"landscape",switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),n}(St),Ji=function(o){F(n,o);var s=M(n);function n(t){var e;return O(this,n),e=s.call(this,t),e.isActiving=!1,e}return x(n,[{key:"duration",get:function(){var e=this.player,i=e.offsetDuration,r=e.duration;return this.playerConfig.customDuration||i||r}},{key:"currentTime",get:function(){var e=this.player,i=e.offsetCurrentTime,r=e.currentTime;return i>=0?i:r}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var e=this,i=this.player.controls.config.mode;this.mode=i==="flex"?"flex":"normal",!this.config.disable&&(this.mode==="flex"&&(this.createCenterTime(),this.root.style.display="none"),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on([ye,ee,gt],function(r){r.eventName==="durationchange"&&(e.isActiving=!1),e.onTimeUpdate()}),this.on(Re,function(){e.onTimeUpdate(!0)}),this.on(De,function(){e.onReset()}))}},{key:"show",value:function(e){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="block"),this.centerDurDom&&(this.centerDurDom.style.display="block");return}this.root.style.display="block"}},{key:"hide",value:function(){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="none"),this.centerDurDom&&(this.centerDurDom.style.display="none");return}this.root.style.display="none"}},{key:"onTimeUpdate",value:function(e){var i=this.player,r=this.config,a=this.duration;if(!(r.disable||this.isActiving||!i.hasStart)){var u=this.currentTime+this.timeOffset;u=c.adjustTimeByDuration(u,a,e),this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(c.format(u)),a!==1/0&&a>0&&(this.centerDurDom.innerHTML=c.format(a))):(this.timeDom.innerHTML=this.minWidthTime(c.format(u)),a!==1/0&&a>0&&(this.durationDom.innerHTML=c.format(a)))}}},{key:"onReset",value:function(){this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(c.format(0)),this.centerDurDom.innerHTML=c.format(0)):(this.timeDom.innerHTML=this.minWidthTime(c.format(0)),this.durationDom.innerHTML=c.format(0))}},{key:"createCenterTime",value:function(){var e=this.player;if(!(!e.controls||!e.controls.center)){var i=e.controls.center;this.centerCurDom=c.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-left"),this.centerDurDom=c.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-right"),i.children.length>0?i.insertBefore(this.centerCurDom,i.children[0]):i.appendChild(this.centerCurDom),i.appendChild(this.centerDurDom)}}},{key:"afterPlayerInit",value:function(){var e=this.config;if(this.duration===1/0||this.playerConfig.isLive?(c.hide(this.durationDom),c.hide(this.timeDom),c.hide(this.find(".time-separator")),c.show(this.find(".time-live-tag"))):c.hide(this.find(".time-live-tag")),e.hide){this.hide();return}this.show()}},{key:"changeLiveState",value:function(e){e?(c.hide(this.durationDom),c.hide(this.timeDom),c.hide(this.find(".time-separator")),c.show(this.find(".time-live-tag"))):(c.hide(this.find(".time-live-tag")),c.show(this.find(".time-separator")),c.show(this.durationDom),c.show(this.timeDom))}},{key:"updateTime",value:function(e){if(this.isActiving=!0,!(!e&&e!==0||e>this.duration)){if(this.mode==="flex"){this.centerCurDom.innerHTML=this.minWidthTime(c.format(e));return}this.timeDom.innerHTML=this.minWidthTime(c.format(e))}}},{key:"minWidthTime",value:function(e){return e.split(":").map(function(i){return'<span class="time-min-width">'.concat(i,"</span>")}).join(":")}},{key:"resetActive",value:function(){var e=this,i=this.player,r=function(){e.isActiving=!1};this.off(ee,r),i.isSeeking&&i.media.seeking?this.once(ee,r):this.isActiving=!1}},{key:"destroy",value:function(){var e=this.player.controls.center;this.centerCurDom&&e.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&e.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-time">\n    <span class="time-current">00:00</span>\n    <span class="time-separator">/</span>\n    <span class="time-duration">00:00</span>\n    <span class="time-live-tag">'.concat(this.i18n.LIVE_TIP,"</span>\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:U.CONTROLS_LEFT,index:2,disable:!1}}}]),n}(q),en=function(o){F(n,o);var s=M(n);function n(){return O(this,n),s.apply(this,arguments)}return x(n,[{key:"afterCreate",value:function(){var e=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(r){r.preventDefault(),r.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(Le,function(i){e.onError(i)})}},{key:"errorRetry",value:function(e){this.emitUserAction(e,"error_retry",{}),this.player.retry()}},{key:"handleError",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=this.player,r=e.errorType,a=i.errorNote?this.i18n[i.errorNote]:"";if(!a)switch(r){case"decoder":a=this.i18n.MEDIA_ERR_DECODE;break;case"network":a=this.i18n.MEDIA_ERR_NETWORK;break;default:a=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=a,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return'<xg-error class="xgplayer-error">\n      <div class="xgplayer-errornote">\n       <span class="xgplayer-error-text"></span>\n       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>\n      </div>\n    </xg-error>'}}],[{key:"pluginName",get:function(){return"error"}}]),n}(q),tn={LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:"视频下载错误"},mse:{code:2,msg:"流追加错误"},parse:{code:3,msg:"解析错误"},format:{code:4,msg:"格式错误"},decoder:{code:5,msg:"解码错误"},runtime:{code:6,msg:"语法错误"},timeout:{code:7,msg:"播放超时"},other:{code:8,msg:"其他错误"}},HAVE_NOTHING:"没有关于音频/视频是否就绪的信息",HAVE_METADATA:"音频/视频的元数据已就绪",HAVE_CURRENT_DATA:"关于当前播放位置的数据是可用的，但没有足够的数据来播放下一帧/毫秒",HAVE_FUTURE_DATA:"当前及至少下一帧的数据是可用的",HAVE_ENOUGH_DATA:"可用数据足以开始播放",NETWORK_EMPTY:"音频/视频尚未初始化",NETWORK_IDLE:"音频/视频是活动的且已选取资源，但并未使用网络",NETWORK_LOADING:"浏览器正在下载数据",NETWORK_NO_SOURCE:"未找到音频/视频来源",MEDIA_ERR_ABORTED:"取回过程被用户中止",MEDIA_ERR_NETWORK:"网络错误",MEDIA_ERR_DECODE:"解码错误",MEDIA_ERR_SRC_NOT_SUPPORTED:"不支持的音频/视频格式",REPLAY:"重播",ERROR:"网络连接似乎出现了问题",PLAY_TIPS:"播放",PAUSE_TIPS:"暂停",PLAYNEXT_TIPS:"下一集",DOWNLOAD_TIPS:"下载",ROTATE_TIPS:"旋转",RELOAD_TIPS:"重新载入",FULLSCREEN_TIPS:"进入全屏",EXITFULLSCREEN_TIPS:"退出全屏",CSSFULLSCREEN_TIPS:"进入样式全屏",EXITCSSFULLSCREEN_TIPS:"退出样式全屏",TEXTTRACK:"字幕",PIP:"画中画",SCREENSHOT:"截图",LIVE:"正在直播",OFF:"关闭",OPEN:"开启",MINI_DRAG:"点击按住可拖动视频",MINISCREEN:"小屏幕",REFRESH_TIPS:"请试试",REFRESH:"刷新",FORWARD:"快进中",LIVE_TIP:"直播"}};export{en as E,Qi as F,ce as I,$i as M,Fe as P,Xi as S,Ji as T,tn as Z,Ki as a,qi as b,Zi as c,wi as d};
