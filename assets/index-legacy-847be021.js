System.register(["./index-legacy-1ff42a16.js","./i18next-legacy-3b10ec50.js","./react-legacy-86f3d07e.js","./@openim-legacy-c6a9c335.js","./md5-legacy-77167c53.js","./react-router-legacy-b23f07b4.js","./clsx-legacy-f780535d.js","./react-use-legacy-58b93c1a.js","./dayjs-legacy-0cdf6c14.js","./@babel-legacy-17757daa.js","./localforage-legacy-d5f31818.js","./react-i18next-legacy-4ed410cf.js","./electron-log-legacy-d589aeaf.js","./react-dom-legacy-4a2fe51b.js","./scheduler-legacy-8a7a76e6.js","./react-query-legacy-1e35dd33.js","./react-router-dom-legacy-53ecb489.js","./@remix-run-legacy-3e5dabd9.js","./classnames-legacy-3b4b4abd.js","./@emotion-legacy-2a329498.js","./stylis-legacy-0e2bd853.js","./@ctrl-legacy-866ef914.js","./ahooks-legacy-34a38106.js","./tslib-legacy-0b575964.js","./lodash-legacy-1c2339a6.js","./intersection-observer-legacy-79bb0a26.js","./react-fast-compare-legacy-be4d0a00.js","./resize-observer-polyfill-legacy-a1ef0246.js","./zustand-legacy-c0d069f8.js","./use-sync-external-store-legacy-b7dea100.js","./twemoji-legacy-f58f5dc8.js","./axios-legacy-315cf952.js","./uuid-legacy-87edcc09.js","./mitt-legacy-b7d2faf6.js","./date-fns-legacy-84c044d6.js","./react-image-file-resizer-legacy-7db86fd9.js","./scroll-into-view-if-needed-legacy-e5e19dca.js","./compute-scroll-into-view-legacy-4fd1a9b8.js","./throttle-debounce-legacy-367d0359.js","./react-virtuoso-legacy-75acb805.js","./react-draggable-legacy-46c7c9f7.js","./prop-types-legacy-0d444847.js","./react-resizable-panels-legacy-b4bb5bb0.js","./xgplayer-legacy-e7bcb49c.js","./lodash-es-legacy-177cea53.js","./@ckeditor-legacy-3b8f019a.js","./color-convert-legacy-801bfb8a.js","./color-name-legacy-1aaf58fb.js","./emoji-picker-element-legacy-b4928ae9.js","./crypt-legacy-789e7ecd.js","./charenc-legacy-eee7b446.js","./is-buffer-legacy-ed3778ad.js","./copy-to-clipboard-legacy-5160011e.js","./toggle-selection-legacy-a46f82ed.js"],(function(e,l){"use strict";var a,r,s,t,o,n,c,i,d,m,u,p,h,g,y,f,b,w,C,v,x,N,j,I,S,k,F,P,U,T,L,M,V,_,q,E,A,W,D,$;return{setters:[e=>{a=e.j,r=e.q,s=e.M,t=e.T,o=e.a,n=e.r,c=e.s,i=e.t,d=e.v,m=e.w,u=e.x,p=e.y,h=e.z,g=e.A,y=e.F,f=e.C,b=e.D,w=e.E,C=e.G,v=e.H,x=e.J,N=e.K,j=e.N,I=e.Q,S=e.R,k=e.U,F=e.V,P=e.W,U=e.X,T=e.Y,L=e.Z,M=e._,V=e.f},e=>{_=e.t},e=>{q=e.r},e=>{E=e.L},e=>{A=e.m},e=>{W=e.b},e=>{D=e.c},e=>{$=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var B=document.createElement("style");B.textContent="._login_1hixf_1 .ant-form-item-label{padding:0}._login-method-tab_1hixf_5 .ant-tabs-nav{margin:24px 0 12px}._login-method-tab_1hixf_5 .ant-tabs-tab{padding:6px 0}\n",document.head.appendChild(B);const R=""+new URL("login_bg-629967c2.png",l.meta.url).href,z=e=>e.replace("https://","").replace("http://","").replace("ws://","").replace("wss://",""),K=(e,l)=>l+e,Z=[{value:E.Verbose,label:a("span",{children:"Verbose"})},{value:E.Debug,label:a("span",{children:"Debug"})},{value:E.Info,label:a("span",{children:"Info"})},{value:E.Warn,label:a("span",{children:"Warn"})},{value:E.Error,label:a("span",{children:"Error"})},{value:E.Fatal,label:a("span",{children:"Fatal"})},{value:E.Panic,label:a("span",{children:"Panic"})}],G=q.memo((({visible:e,close:l})=>{const h=e=>r().includes(e)?{IMWsUrl:z(u()),IMApiUrl:z(r()),ChatUrl:z(p()),LogLevel:m()}:{IMWsUrl:"",IMApiUrl:"",ChatUrl:"",LogLevel:m()},g=(e,l)=>{localStorage.setItem("wsUrl",K(e.IMWsUrl,l?"wss://":"ws://")),localStorage.setItem("apiUrl",K(e.IMApiUrl,l?"https://":"http://")),localStorage.setItem("chatUrl",K(e.ChatUrl,l?"https://":"http://")),localStorage.setItem("logLevel",e.LogLevel.toString()),window.location.reload()},y=r().includes("http://")?"http":"https";return a(s,{width:600,footer:null,title:"Config",open:e,onCancel:l,centered:!0,children:a(t,{defaultActiveKey:y,items:[{key:"http",label:"ip+port",children:o(n,{name:"http",labelCol:{span:8},wrapperCol:{span:16},initialValues:h("http://"),onFinish:e=>g(e,!1),autoComplete:"off",children:[a(n.Item,{label:"IMWsUrl",name:"IMWsUrl",rules:[{required:!0,message:"Please input your IMWsUrl!"}],children:a(c,{addonBefore:"ws://",placeholder:"Such as：121.5.182.23:10001"})}),a(n.Item,{label:"IMApiUrl",name:"IMApiUrl",rules:[{required:!0,message:"Please input your IMApiUrl!"}],children:a(c,{addonBefore:"http://",placeholder:"Such as：121.5.182.23:10002"})}),a(n.Item,{label:"ChatUrl",name:"ChatUrl",rules:[{required:!0,message:"Please input your ChatUrl!"}],children:a(c,{addonBefore:"http://",placeholder:"Such as：121.5.182.23:10008"})}),a(n.Item,{label:"LogLevel",name:"LogLevel",rules:[{required:!0,message:"Please input your LogLevel!"}],children:a(i,{options:Z})}),a(n.Item,{className:"mb-3 mt-10",wrapperCol:{offset:10,span:14},children:a(d,{type:"primary",htmlType:"submit",children:"Save"})})]})},{key:"https",label:"https+domain",children:o(n,{name:"https",labelCol:{span:8},wrapperCol:{span:16},initialValues:h("https://"),onFinish:e=>g(e,!0),autoComplete:"off",children:[a(n.Item,{label:"IMWsUrl",name:"IMWsUrl",rules:[{required:!0,message:"Please input your IMWsUrl!"}],children:a(c,{addonBefore:"wss://",placeholder:"Such as：web.rentsoft.cn/msg_gateway"})}),a(n.Item,{label:"IMApiUrl",name:"IMApiUrl",rules:[{required:!0,message:"Please input your IMApiUrl!"}],children:a(c,{addonBefore:"https://",placeholder:"Such as：web.rentsoft.cn/api"})}),a(n.Item,{label:"ChatUrl",name:"ChatUrl",rules:[{required:!0,message:"Please input your ChatUrl!"}],children:a(c,{addonBefore:"https://",placeholder:"Such as：web.rentsoft.cn/chat"})}),a(n.Item,{label:"LogLevel",name:"LogLevel",rules:[{required:!0,message:"Please input your LogLevel!"}],children:a(i,{options:Z})}),a(n.Item,{wrapperCol:{offset:10,span:14},children:a(d,{type:"primary",htmlType:"submit",children:"Save"})})]})}]})})})),H="_login_1hixf_1",J="_login-method-tab_1hixf_5",Q=[{value:"+86",label:"+86"}],O=({loginMethod:e,setFormType:l,updateLoginMethod:r})=>{const s=W(),[m]=n.useForm(),[u,p]=q.useState(0),{mutate:j,isLoading:I}=h(),{mutate:S}=g(),[k,F]=q.useState(0);return q.useEffect((()=>{if(k>0){const e=setTimeout((()=>{F((e=>e-1)),1===k&&(clearTimeout(e),F(0))}),1e3);return()=>clearTimeout(e)}}),[k]),o(y,{children:[a("div",{className:"flex flex-row items-center justify-between",children:a("div",{className:"text-xl font-medium",children:_("placeholder.welcome")})}),a(t,{className:J,activeKey:e,items:[{key:"phone",label:"手机号"},{key:"email",label:"邮箱"}],onChange:e=>{r(e)}}),o(n,{form:m,layout:"vertical",onFinish:e=>{0===u&&(e.password=A(e.password??"")),e.phoneNumber&&(C(e.areaCode),v(e.phoneNumber)),e.email&&x(e.email),j(e,{onSuccess:e=>{const{chatToken:l,imToken:a,userID:r}=e.data;N({chatToken:l,imToken:a,userID:r}),s("/chat")}})},autoComplete:"off",labelCol:{prefixCls:"custom-form-item"},initialValues:{areaCode:"+86",phoneNumber:f()??"",email:b()??""},children:[a(n.Item,"phone"===e?{label:_("placeholder.phoneNumber"),children:o(w.Compact,{className:"w-full",children:[a(n.Item,{name:"areaCode",noStyle:!0,children:a(i,{options:Q,className:"!w-28"})}),a(n.Item,{name:"phoneNumber",noStyle:!0,children:a(c,{allowClear:!0,placeholder:_("toast.inputPhoneNumber")})})]})}:{label:_("placeholder.email"),name:"email",rules:[{type:"email",message:_("toast.inputCorrectEmail")}],children:a(c,{allowClear:!0,placeholder:_("toast.inputEmail")})}),a(n.Item,1===u?{label:_("placeholder.verifyCode"),name:"verifyCode",children:o(w.Compact,{className:"w-full",children:[a(c,{allowClear:!0,placeholder:_("toast.inputVerifyCode"),className:"w-full"}),a(d,{type:"primary",onClick:()=>{const l={phoneNumber:m.getFieldValue("phoneNumber"),email:m.getFieldValue("email"),areaCode:m.getFieldValue("areaCode"),usedFor:3};"phone"===e&&delete l.email,"email"===e&&(delete l.phoneNumber,delete l.areaCode),S(l,{onSuccess(){F(60)}})},loading:k>0,children:k>0?_("date.second",{num:k}):_("placeholder.sendVerifyCode")})]})}:{label:_("placeholder.password"),name:"password",children:a(c.Password,{allowClear:!0,placeholder:_("toast.inputPassword")})}),o("div",{className:"mb-10 flex flex-row justify-between",children:[a("span",{className:"cursor-pointer text-sm text-gray-400",onClick:()=>l(1),children:_("placeholder.forgetPassword")}),a("span",{className:"cursor-pointer text-sm text-[var(--primary)]",onClick:()=>p(0===u?1:0),children:`${_(0===u?"placeholder.verifyCode":"placeholder.password")}${_("placeholder.login")}`})]}),a(n.Item,{className:"mb-4",children:a(d,{type:"primary",htmlType:"submit",block:!0,loading:I,children:_("placeholder.login")})}),o("div",{className:"flex flex-row items-center justify-center",children:[a("span",{className:"text-sm text-gray-400",children:_("placeholder.registerToast")}),a("span",{className:"cursor-pointer text-sm text-blue-500",onClick:()=>l(2),children:_("placeholder.toRegister")})]})]})]})},X=({loginMethod:e,setFormType:l})=>{const{message:r}=j.useApp(),[s]=n.useForm(),[t,m]=q.useState(0),[u,p]=q.useState(!1),{mutate:h}=g(),{mutate:f}=I(),{mutate:b}=S();return q.useEffect((()=>{if(t>0){const e=setTimeout((()=>{m((e=>e-1)),1===t&&(clearTimeout(e),m(0))}),1e3);return()=>clearTimeout(e)}}),[t]),o("div",{className:"flex flex-col justify-between",children:[o("div",{className:"cursor-pointer text-sm text-gray-400",onClick:()=>{l(0),s.resetFields()},children:[a(k,{rev:void 0}),a("span",{className:"ml-1",children:_("placeholder.getBack")})]}),a("div",{className:"mt-6 text-2xl font-medium",children:_("placeholder.forgetPassword")}),o(n,{form:s,layout:"vertical",labelCol:{prefixCls:"custom-form-item"},onFinish:e=>{e.verifyCode&&(u?f({...e,password:A(e.password)},{onSuccess(){r.success(_("toast.updatePasswordSuccess")),l(0)}}):b({...e,usedFor:2},{onSuccess(){p(!0)}}))},autoComplete:"off",className:"mt-6",initialValues:{areaCode:"+86"},children:[u&&o(y,{children:[a(n.Item,{label:_("placeholder.password"),name:"password",help:a("span",{className:" text-xs text-gray-400",children:_("toast.passwordRules")}),rules:[{required:!0,pattern:/^(?=.*[0-9])(?=.*[a-zA-Z]).{6,20}$/,message:_("toast.passwordRules")}],hidden:!u,children:a(c.Password,{allowClear:!0,placeholder:_("toast.inputPassword")})}),a(n.Item,{label:_("placeholder.confirmPassword"),name:"password2",rules:[{required:!0,message:"Please confirm your password"},({getFieldValue:e})=>({validator:(l,a)=>a&&e("password")!==a?Promise.reject(new Error(_("toast.passwordsDifferent"))):Promise.resolve()})],children:a(c.Password,{allowClear:!0,placeholder:_("toast.reconfirmPassword")})})]}),a(n.Item,"phone"===e?{label:_("placeholder.phoneNumber"),required:!0,hidden:u,children:o(w.Compact,{className:"w-full",children:[a(n.Item,{name:"areaCode",noStyle:!0,children:a(i,{options:Q,className:"!w-28"})}),a(n.Item,{name:"phoneNumber",noStyle:!0,children:a(c,{allowClear:!0,placeholder:_("toast.inputPhoneNumber")})})]})}:{required:!0,hidden:u,label:_("placeholder.email"),name:"email",rules:[{type:"email",message:_("toast.inputCorrectEmail")}],children:a(c,{allowClear:!0,placeholder:_("toast.inputEmail")})}),a(n.Item,{label:_("placeholder.verifyCode"),name:"verifyCode",hidden:u,required:!0,children:o(w.Compact,{className:"w-full",children:[a(c,{allowClear:!0,placeholder:_("toast.inputVerifyCode"),className:"w-full"}),a(d,{type:"primary",onClick:()=>{h({phoneNumber:s.getFieldValue("phoneNumber"),email:s.getFieldValue("email"),areaCode:s.getFieldValue("areaCode"),usedFor:3},{onSuccess(){m(60)}})},loading:t>0,children:t>0?_("date.second",{num:t}):_("placeholder.sendVerifyCode")})]})}),a(n.Item,{className:"mt-20",children:a(d,{type:"primary",htmlType:"submit",block:!0,children:_(u?"confirm":"placeholder.nextStep")})})]})]})},Y=({loginMethod:e,setFormType:l})=>{const{message:r}=j.useApp(),[s]=n.useForm(),t=W(),{mutate:m}=g(),{mutate:u}=S(),{mutate:p}=F(),[h,f]=q.useState(0),[b,I]=q.useState(["","","","","",""]),P=q.useRef([]),[U,T]=q.useState(0);q.useEffect((()=>{if(U>0){const e=setTimeout((()=>{T((e=>e-1)),1===U&&(clearTimeout(e),T(0))}),1e3);return()=>clearTimeout(e)}}),[U]);const L="email"===e,M=L?"placeholder.verifyEmail":"placeholder.verifyPhoneNumber",V=L?s.getFieldValue("email"):`${s.getFieldValue("areaCode")} ${s.getFieldValue("phoneNumber")}`;return o("div",{className:"flex flex-col justify-between",children:[o("div",{className:"cursor-pointer text-sm text-gray-400",onClick:()=>{l(0),s.resetFields()},children:[a(k,{rev:void 0}),a("span",{className:"ml-1",children:_("placeholder.getBack")})]}),o("div",{className:D("mt-4 text-2xl font-medium"),children:[0===h&&a("span",{children:_("placeholder.register")}),1===h&&a("span",{children:_(M)}),2===h&&a("span",{children:_("placeholder.setInfo")})]}),o("div",{className:"mt-4 tracking-wider text-gray-400",hidden:1!==h,children:[a("span",{children:_("placeholder.pleaseEnterSendTo")}),a("span",{className:" text-blue-600",children:V}),a("span",{children:_("placeholder.verifyValidity")})]}),o(n,{form:s,layout:"vertical",labelCol:{prefixCls:"custom-form-item"},onFinish:e=>{if(0===h){const l=/^1\d{10}$/;if(e.phoneNumber&&!l.test(e.phoneNumber))return r.error(_("toast.inputCorrectPhoneNumber"));m({usedFor:1,...e},{onSuccess(){T(60),f(1),setTimeout((()=>P.current[0].focus()))}})}const l=b.join("");if(1===h){if(!l)return;u({...e,verifyCode:l,usedFor:1},{onSuccess(){f(2)}})}2===h&&(C(e.areaCode),e.phoneNumber&&v(e.phoneNumber),e.email&&x(e.email),p({verifyCode:l,autoLogin:!0,user:{nickname:e.nickname,faceURL:"",areaCode:e.areaCode,phoneNumber:e.phoneNumber,password:A(e.password),email:e.email}},{onSuccess(e){r.success(_("toast.registerSuccess"));const{chatToken:l,imToken:a,userID:s}=e.data;N({chatToken:l,imToken:a,userID:s}),t("/chat")}}))},autoComplete:"off",className:"mt-4",initialValues:{areaCode:"+86"},children:[a(n.Item,"phone"===e?{label:_("placeholder.phoneNumber"),hidden:0!==h,children:o(w.Compact,{className:"w-full",children:[a(n.Item,{name:"areaCode",noStyle:!0,children:a(i,{options:Q,className:"!w-28"})}),a(n.Item,{name:"phoneNumber",noStyle:!0,children:a(c,{allowClear:!0,placeholder:_("toast.inputPhoneNumber")})})]})}:{label:_("placeholder.email"),name:"email",rules:[{type:"email",message:_("toast.inputCorrectEmail")}],hidden:0!==h,children:a(c,{allowClear:!0,placeholder:_("toast.inputEmail")})}),o(n.Item,{label:"",hidden:1!==h,className:"mb-14 mt-8",children:[a("div",{className:"flex flex-row items-center justify-center",children:b.map(((e,l)=>a(c,{ref:e=>P.current[l]=e,type:"text",maxLength:1,value:e,onChange:e=>((e,l)=>{const a=l.target.value,r=[...b];if(1===a.length)r[e]=a,I(r),e<b.length-1&&P.current[e+1].focus();else if(0===a.length){const l=[...b];l[e]="",I(l)}r.every((e=>e.length>0))&&s.submit()})(l,e),onKeyUp:e=>((e,l)=>{const a=l.keyCode||l.which;if(8===a&&e>0){const l=[...b];l[e-1]="",I(l),P.current[e-1].focus()}if(8===a||46===a){const l=[...b];l[e]="",I(l)}})(l,e),className:"mr-1 h-11 w-11 text-center text-2xl"},l)))}),a("div",{className:"mt-4 text-gray-400",children:o(y,U>0?{children:[o("span",{className:" text-blue-500",children:[U,"s "]}),a("span",{children:_("placeholder.regain")+_("placeholder.verifyCode")})]}:{children:[a("span",{onClick:()=>{m({email:s.getFieldValue("email"),phoneNumber:s.getFieldValue("phoneNumber"),areaCode:s.getFieldValue("areaCode"),usedFor:1},{onSuccess(){T(60)}})},className:"cursor-pointer text-blue-500",children:_("placeholder.regain")}),a("span",{children:_("placeholder.verifyCode")})]})})]}),2===h&&o(y,{children:[a(n.Item,{label:_("placeholder.nickName"),name:"nickname",hidden:2!==h,rules:[{required:!0}],children:a(c,{allowClear:!0,spellCheck:!1,placeholder:_("toast.inputNickName")})}),a(n.Item,{label:_("placeholder.password"),name:"password",rules:[{required:!0,pattern:/^(?=.*[0-9])(?=.*[a-zA-Z]).{6,20}$/,message:_("toast.passwordRules")}],children:a(c.Password,{allowClear:!0,placeholder:_("toast.inputPassword")})}),a(n.Item,{label:_("placeholder.confirmPassword"),name:"password2",dependencies:["password"],rules:[{required:!0,message:_("toast.reconfirmPassword")},({getFieldValue:e})=>({validator:(l,a)=>a&&e("password")!==a?Promise.reject(new Error(_("toast.passwordsDifferent"))):Promise.resolve()})],className:"mb-8",children:a(c.Password,{allowClear:!0,placeholder:_("toast.reconfirmPassword")})})]}),a(n.Item,{children:a(d,{type:"primary",htmlType:"submit",block:!0,children:_(2===h?"confirm":"placeholder.nextStep")})})]})]})},ee=(e("Login",(()=>{const[e,l]=q.useState(0),[r,s]=q.useState(P()),[t,n]=$(),c=q.useCallback((e=>{s(e),U(e)}),[]);return o("div",{className:"relative flex h-full flex-col",children:[a("div",{className:"app-drag relative h-10 bg-[var(--top-search-bar)]",children:a(T,{})}),o("div",{className:"flex flex-1 items-center justify-center",children:[a(ee,{}),o("div",{className:`${H} mr-14 h-[450px] w-[350px] rounded-md p-11`,style:{boxShadow:"0 0 30px rgba(0,0,0,.1)"},children:[0===e&&a(O,{setFormType:l,loginMethod:r,updateLoginMethod:c}),1===e&&a(X,{setFormType:l,loginMethod:r}),2===e&&a(Y,{loginMethod:r,setFormType:l})]})]}),o("div",{className:"absolute bottom-3 right-3 flex cursor-pointer flex-col items-center text-xs",onClick:()=>{n(`${L}/${M}`),V({msg:_("toast.copySuccess")})},children:[a("div",{className:"text-[var(--sub-text)]",children:L}),a("div",{className:"text-[var(--sub-text)]",children:M})]})]})})),()=>{const[e,l]=q.useState(!1),r=q.useCallback((()=>l(!1)),[]);return o("div",{className:"flex min-h-[420]",children:[o("div",{className:"mr-14 text-center",children:[a("div",{className:"text-2xl",onDoubleClick:()=>l(!0),children:_("placeholder.title")}),a("span",{className:"text-sm  text-gray-400",children:_("placeholder.subTitle")}),a("img",{src:R,alt:"login_bg"})]}),a(G,{visible:e,close:r})]})})}}}));
